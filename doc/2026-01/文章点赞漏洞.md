#  文章点赞漏洞  
原创 破阵攻防实验室
                    破阵攻防实验室  破阵攻防实验室   2026-01-29 01:40  
  
**免责声明**  
  
    由于传播、利用此文所提供的信息而造成的任何直接或间接的后果和损失，均由使用者本人承担，  
破阵攻防实验室  
及文章作者不承担任何责任。如有侵权烦请告知，我们将立即删除相关内容并致歉。请遵守《中华人民共和国个人信息保护法》、《中华人民共和国网络安全法》等相关法律法规。  
  
  
0x01 漏洞简介  
  
      文章点赞漏洞是指由于身份校验、业务逻辑或接口设计不当，攻击者可以非正常地增加或操纵文章点赞数，从而影响业务指标、舆论导向或排行榜结果。  
  
      文章点赞漏洞本质上属于业务逻辑漏洞。  
  
常见漏洞成因分类：  
  
1. 未授权点赞（身份校验缺失）  
```
未登录用户可直接调用点赞接口
仅前端限制，后端未校验登录态
```  
  
2. 重复点赞漏洞（幂等性缺失）  
```
同一用户可对同一文章多次点赞
未做唯一性约束
```  
  
3. 点赞/取消点赞逻辑漏洞（状态机错误）  
```
点赞直接+1
取消点赞直接-1
不校验当前状态
```  
  
4. 参数篡改/水平越权  
```
接口从请求参数中读取 user_id 类信息
```  
  
5. 高频请求刷赞（缺乏频控）  
```
无 Rate Limit
无 IP/用户频率限制
```  
  
6. 并发竞争漏洞  
```
校验和写入分离
并发请求绕过校验
```  
  
  
0x02 漏洞复现  
  
在某博客系统中存在点赞功能  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOM18R0cAT7J2vTcfAFrLtXliaM7UEibuNup7icaa2yNc1j7ic3At6xwNBPXg/640?wx_fmt=png&from=appmsg "")  
  
点击“点赞”，HTTP请求包中带有XFF信息  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOMxWiboDCChKHDT30ib4mrt4iaJfDEvlaTPvRRPnyreW7gPCly0HC2wnZXA/640?wx_fmt=png&from=appmsg "")  
  
响应包返回“点赞成功”  
  
当再次提交这个请求包时会响应已赞过，说明后端存在重复点赞校验  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOMMAH2SWrhibKxBf9lyLuTu6jgzuiaVzcNLkMUFmbnPXGpzRWVc9x0YPNA/640?wx_fmt=png&from=appmsg "")  
  
修改XFF字段的值为：127.0.0.3，尝试Bypass  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOMGGKAzTjTg2YpGmkn6vEFoODrON5vszFO4FnpEoic3c1Db5MLAq1VT3Q/640?wx_fmt=png&from=appmsg "")  
  
响应结果“点赞成功”，说明后端是通过XFF字段进行校验的！  
  
利用这个漏洞进行刷赞操作  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOMZZFbMaQ5uP96dP9icOaiatOicdiatBEw2IajtmyYUWvSI1C9YvjYCulk4A/640?wx_fmt=png&from=appmsg "")  
  
刷新前台页面，点赞数更新了，说明刷赞成功！  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOMpZriaCuMpiaMZbj7XIyGbCvWCHdKAzBeMu1bib3S0q3dnoNicicaQq0fFgA/640?wx_fmt=png&from=appmsg "")  
  
  
0x03 漏洞分析  
  
漏洞相关代码在/blog/api/love处  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOMZZvic1WYVRSRLvMa8L1wfNucIA8LI6I8zQ3KMuQJfy07FOnjsQr854Q/640?wx_fmt=png&from=appmsg "")  
  
调用getIpAddr方法通过XFF等字段获取IP  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOMnuNPhgmvpibVNuy4kfVAOUz2wia1RKlLoWEwnTWM3OiadiarWWstq2BEYw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOM8m5kL1NqBdZLe3uqQuaht7giclU4qPB2Wt4h6lJUWGW3sFzKPWAaU4g/640?wx_fmt=png&from=appmsg "")  
  
调用checkLove方法通过查询保存在数据库中的XFF记录进行校验。如果已存在XFF记录，则响应“您已赞过了哦~”；如果不存在XFF记录，则执行正常的点赞处理逻辑。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOMG5kFnZLrgv8uicVM17ZCoyuV3OG1Ohds9lNvGfzZIu1ozBdb36VL4CA/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOMPeuNsPpSTicNKH6IoZOwYyH6lLicQBYnONz4yXia8b43TA8ZLWmiao82mg/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOMYxq7c1BqTypC5CnRJVP44qrBfKqEZLWuB1nTs7wJbtnNClgBoMjzzQ/640?wx_fmt=png&from=appmsg "")  
  
数据库查询  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/fo3OZEF1OKraxVKF8k8ugiaF1pYuEficOM9ROibubCEZtTibP0Alnf3pvLVWZiahMQbJn8kUqT1HJmDjdlBicSQbP3Yg/640?wx_fmt=png&from=appmsg "")  
  
由于防护策略存在缺陷，这里只需要修改XFF字段的值即可实现刷赞！  
  
  
0x03 防御策略  
  
针对点赞漏洞，可采取以下防御措施：  
  
1.   
服务端强制身份认证，仅允许合法登录用户操作；  
  
2.   
基于用户唯一标识与业务对象建立点赞唯一约束，防止重复点赞；  
  
3.   
用户身份从登录态获取，避免参数篡改导致水平越权；  
  
4.   
引入接口频率限制，防止自动化刷赞；  
  
5.   
基于点赞状态机进行合法性校验，避免逻辑刷赞；  
  
  
如果想要及时了解更多内容，请关注   
破阵攻防实验室  
   
微信公众号！  
  
  
  
  
