#  【复现】n8n表达式注入可导致远程代码执行漏洞（CVE-2025-68613）  
启明星辰  ADLab   2026-01-13 10:07  
  
更多安全资讯和分析文章请关注启明星辰ADLab微信公众号及官方网站（adlab.venustech.com.cn）  
  
  
n8n  
  
是一个开源的工作流程自动化平台，旨在可视化连接应用程序和服务，实现任务自动化，并集成安全工具和  
SaaS  
平台  
。其基于Node.js  
构建，使用  
JavaScript  
作为平台内部结构和用户工作流程逻辑。  
  
2025  
年  
12  
月  
20  
日  
n8n  
发布更新，修复了  
n8n  
中通过表达式注入导致远程代码执行漏洞（  
CVE-2025-68613  
）  
,CVSS  
评分  
9.9  
分（严重）。问题出在工作流程中的表达式评估系统。  
在某些情况下，经过身份验证的用户输入的表达式可以在与底层运行时隔离不足的上下文中执行，这允许使用  
n8n  
进程的权限执行任意代码。  
实际上，成功利用可能导致：  
- 完全控制实例  
  
- 访问秘密（令牌、凭据、  
API   
密钥）  
  
- 持久修改工作流程  
  
- 在系统级别执行命令  
  
- 将  
 n8n   
用作网络中的枢纽点  
  
根据攻击面管理平台  
Censys  
的数据，截至  
2025  
年  
12  
月  
22  
日，互联网上存在  
103,476  
个潜在的易受攻击  
n8n  
实例。由于概念验证漏洞利用程序已经发布，并且该漏洞已在互联网上广泛传播，  
影响范围较大，提醒相关用户做好升级防护工作  
。  
- 漏洞描述  
  
在  
n8n  
的工作流表达式评估系统中，该系统在工作流配置中由认证用户提供的表达式在不安全的执行环境中被评估。核心安全漏洞是一个表达式注入漏洞，使经过认证的攻击者能够以  
n8n  
进程的权限执行任意  
JavaScript  
代码。具体来说：  
- n8n  
处理用双大括号{{ }}包裹的用户输入，作为  
JavaScript  
代码，且没有足够的沙盒或输入验证。  
  
- 表达式求值器缺乏适当的上下文隔离，使攻击者能够逃离预期的评估沙盒。  
  
- 认证对该漏洞没有实质性的保护，任何经过认证的用户都可以利用它。  
  
n8n  
官方描述为：  
n8n contains a critical Remote Code Execution (RCE) vulnerability in its workflow expression evaluation system. Under certain conditions, expressions supplied by authenticated users during workflow configuration may be evaluated in an execution context that is not sufficiently isolated from the underlying runtime.An authenticated attacker could abuse this behavior to execute arbitrary code with the privileges of the n8n process. Successful exploitation may lead to full compromise of the affected instance, including unauthorized access to sensitive data, modification of workflows, and execution of system-level operations.  
- ## 影响范围  
  
- 0.211.0 <= n8n < 1.120.4  
  
- n8n  
    
1.121.0  
  
- ## 漏洞原理  
  
该版本代码中存在多处安全问题：  
  
（1）  
  
漏洞根源  
expression.ts  
文件中的  
resolveSimpleParameterValue  
  
函数中存在的安全问题如下：  
- 代码将  
process  
  
对象暴露给了表达式求值的  
data  
  
上下文。  
  
- 虽然只暴露了部分属性，但这个  
data.process  
  
引用的是实际的  
 Node.js process   
对象。  
  
- 攻击者可以通过  
this.process.mainModule.require()  
  
绕过沙箱限制访问完整的  
 process   
对象。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/VuRGkncX57NDvlnk7Dkusiba09l2MLVwiaOtUyWyWcMiaCvnQrYCkSlMD0GWHAOOTJIPvA6eDPTFZicyHqbWA8R2yA/640?wx_fmt=png&from=appmsg "")  
  
（2）  
  
表达式求值入口  
expression-evaluator-proxy.ts  
文件中存在的安全问题如下：  
- 使用  
Tournament  
库作为沙箱环境。  
  
- 只有  
after  
  
阶段的  
PrototypeSanitizer  
  
和  
DollarSignValidator  
  
过滤器。  
  
- 没有有效阻止通过  
this  
  
关键字访问执行上下文。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/VuRGkncX57NDvlnk7Dkusiba09l2MLVwiaxhX6VxGMlTFnwZKqTgicibRJPqCqgSlkGY2s73RAFnonibT7ystH8jRxw/640?wx_fmt=png&from=appmsg "")  
  
  
（3）沙箱初始化的  
expression.ts  
文件  
中的  
initializeGlobalContext  
  
函数中存在的安全问题如下：  
- 只阻止了直接调用  
eval  
、  
Function  
  
等。  
  
- 没有阻止通过  
process.mainModule.require()  
  
访问  
Node.js  
模块。  
  
- 沙箱隔离不足，无法防止深层对象访问。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/VuRGkncX57NDvlnk7Dkusiba09l2MLVwiaXgHeOMCuqlricNLXUpwxPBgSkBibTLfYKrTllTq8LcEpaEzV7jqyJDzw/640?wx_fmt=png&from=appmsg "")  
- ## 漏洞复现  
  
![](https://mmbiz.qpic.cn/mmbiz_png/VuRGkncX57NDvlnk7Dkusiba09l2MLVwiavGaD0Q68iamWIcqBBQkEOBHsSuN1GUcxVXaSQS0X8LvCYTAnH9nEeYw/640?wx_fmt=png&from=appmsg "")  
  
可以看见命令执行的结果在右边。漏洞触发后，执行了系统命令，获取到了  
id  
的值。  
- ## 安全建议  
  
立即升级  
：  
- n8n  
官方已发布修复版本n8n v1.122.0，  
强烈建议用户升级到  
1.122.0  
或更高版本  
。  
  
临时缓解措施：  
- 限制工作流创建和编辑权限仅限于完全信任的用户。  
  
- 将n8n部署在具有受限操作系统权限和网络访问权限的强化环境中，以减少潜在漏洞利用的影响。  
  
**参考链接：**  
  
[1]https://github.com/n8n-io/n8n/security/advisories/GHSA-v98v-ff95-f3cp  
  
  
  
  
  
启明星辰积极防御实验室（ADLab）  
  
  
  
  
  
ADLab成立于1999年，是中国安全行业最早成立的攻防技术研究实验室之一，微软MAPP计划核心成员，  
“黑雀攻击”概  
念首推者。截至目前，ADLab已通过 CNVD/CNNVD/NVDB/CVE累计发布安全漏洞7000余个，持续保持国际网络安全领域一流水准。实验室研究方向涵盖基础安全研究、  
运营商基础网络设施安全研究  
、  
移动终端安全研究、云安全研究、  
信创安全研究、  
物联网安全研究、  
车联网安全研究、工控安全研究、  
无线安全研究、数据安全研究、  
AI安全研究、  
低空安全研究  
、高级威胁研究、攻防体系建设。研究成果应用于产品核心技术研究、国家重点科技项目攻关、专业安全服务等。  
  
  
  
  
![图片](https://mmbiz.qpic.cn/mmbiz_png/VuRGkncX57ONOtW3DSPMEXiaLPqrs8a20KxsFg78IaJzyEf51AIjLGNkDG5tsCH76Qo7PoVz74JGQqKJbCh5PdQ/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp#imgIndex=2 "")  
  
