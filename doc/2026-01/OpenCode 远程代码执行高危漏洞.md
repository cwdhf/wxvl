#  OpenCode 远程代码执行高危漏洞  
安融技术
                    安融技术  安融技术   2026-01-17 01:26  
  
OpenCode  
是一个开源的  
 AI   
编码代理工具，支持在终端、  
IDE   
或桌面应用中使用。它兼容  
 75   
多家大模型提供商，也内置免费模型，并强调不会存储用户的代码或上下文数据，支持多会话并行、自动加载语言服务器协议、会话链接分享等功能。  
  
近期，  
OpenCode  
开源  
AI  
编码代理工具中存在的高危远程代码执行漏洞，该漏洞源于在  
 1.0.216   
版本之前，  
OpenCode   
会默认启动一个未经身份验证的  
 HTTP   
服务器，允许未经授权的远程攻击者通过本地进程或宽松的  
 CORS   
策略的网站以用户的权限执行任意  
 shell   
命令。目前该漏洞PoC和技术细节已公开。鉴于该漏洞影响范围较大，建议客户尽快做好自查及防护。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/f0KlQiaibhCCCe4MeWyoHnMgicNVEWmLmPlkp4ms99h7Lbrj00TjlCBVGXAe5dgR7MR9qZgW6Q3jYNN224mHwwicxQ/640?wx_fmt=jpeg&from=appmsg "")  
  
  
影响范围  
  
影响版本：  
OpenCode < 1.0.216  
  
公开时间：  
2026-01-12  
  
影响量级：万级用户  
  
CVSS v3.1  
评分为  
8.8  
分（高危）  
  
利用可能性：高  
  
技术原理分析  
  
核心漏洞点  
  
该漏洞源于  
CWE-306  
（关键功能缺失身份验证）和  
CWE-942  
（宽松跨域白名单）设计缺陷：  
  
1.   
未授权  
HTTP  
服务器：在  
1.0.216  
版本前，  
OpenCode  
启动时会自动创建一个未经身份验证的  
HTTP  
服务器（默认端口  
4096+  
）。  
  
2.   
关键接口暴露：该  
HTTP  
服务器暴露了执行  
Shell  
命令、创建终端会话及文件读取等关键功能接口。  
  
3.   
宽松  
CORS  
策略：采用过于宽松的跨域资源共享策略，允许任何网站通过浏览器访问这些接口。  
  
攻击向量  
  
本地攻击：任何本地进程可直接访问该  
HTTP  
服务器。  
  
远程攻击：恶意网站利用宽松  
CORS  
策略，通过受害者浏览器作为代理发起跨域请求。  
  
权限：以运行  
OpenCode  
的用户权限执行任意  
shell  
命令。  
  
漏洞危害  
  
攻击者可利用此漏洞：  
  
以用户权限执行任意  
shell  
命令。  
  
获取系统控制权。  
  
窃取代码、密钥等敏感数据。  
  
植入后门或恶意软件。  
  
影响系统可用性。  
  
解决方案  
  
紧急处置  
  
1.   
升级修复  
  
立即升级至  
OpenCode   
≥  
 1.0.216  
  
2.   
缓解措施（在升级前）  
  
限制  
HTTP  
服务器网络访问：通过防火墙阻止未授权访问。  
  
强化  
CORS  
策略：仅允许可信来源。  
  
避免访问不可信网站。  
  
监控异常  
HTTP  
服务器活动和  
shell  
命令执行。  
  
3.   
安全监测  
  
部署  
EDR  
工具检测异常进程行为。  
  
检查系统日志中的可疑命令执行记录。  
  
