#  1.9-监控POC根据指纹自动创建任务  
原创 Autumn52
                        Autumn52  SecSentry   2026-01-27 00:30  
  
#                          
# ScopeSentry-V1.9  
  
• 官网：https://www.scope-sentry.top  
  
•Github:https://github.com/Autumn-27/ScopeSentry  
  
• 插件市场：https://plugin.scope-sentry.top  
# 更新内容  
```
1. 服务端插件，支持定时任务、任务结束时运行2. 监控nuclei poc更新，根据poc的指纹自动创建扫描任务3. 指纹扫描支持主动扫描识别4. 资产3d图5. 支持在线安装插件
```  
## 监控POC自动创建任务  
  
安装：在插件管理处的插件市场选择服务端插件Nuclei Monitor进行安装  
  
监控nuclei官方的api接口，发现新的poc时，根据poc的指纹在资产库中进行搜索获取影响资产数量，同时自动将这些受影响的资产创建扫描任务。可以参考这个插件监控其他的漏洞源。  
  
**注意：有些poc会有恶意操作，比如删除操作，所以默认自动创建任务是关闭的（插件源码处进行修改，建议关闭），可以在收到通知时手动复制搜索语句进行创建任务，防止测试影响业务**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/0a6elNzWYayjIHTdknFhLGa66kM9GGzypTNacOofic43YnCD53loCwohXJtZiauUb9T9BoZquL826tqBNsQLmUOw/640?wx_fmt=png&from=appmsg "null")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/0a6elNzWYayjIHTdknFhLGa66kM9GGzyh2LdfUBaia2Ts5uBtfx9M3zjibg0AvXD8wKCjuEEK238x1C320gPCygQ/640?wx_fmt=png&from=appmsg "null")  
  
  
支持在线安装插件  
  
![](https://mmbiz.qpic.cn/mmbiz_png/0a6elNzWYayjIHTdknFhLGa66kM9GGzy3iapb55wpYDDiaWVMTWWM1RlNUPD5kcWPqo2SJdLxHHmOlJkRibosWsSQ/640?wx_fmt=png&from=appmsg "null")  
  
## 主动指纹探测  
  
可以在这里使用表单快速创建指纹  
  
https://plugin.scope-sentry.top/fingers  
  
![](https://mmbiz.qpic.cn/mmbiz_png/0a6elNzWYayjIHTdknFhLGa66kM9GGzyu1gSzuMibfZF6Xb6MqXBYfic5iaFpJcPHR1z4nZWbSXCQZGHRR9YKD8oA/640?wx_fmt=png&from=appmsg "null")  
  
  
注册用户之后添加之后，后台会有审核，审核发布之后大家都可以用（欢迎大家提交，后边会收集一些其他指纹库做个转换），在指纹管理处可以在线更新新增指纹。  
  
**支持提取字符，主动请求。**  
  
例如：第一步提取js路径appxxx.js，接着访问提取到的路径，对新路径的响应体进行判断  
  
![](https://mmbiz.qpic.cn/mmbiz_png/0a6elNzWYayjIHTdknFhLGa66kM9GGzycgozt7ibHco2DFm2n14DjiaJm9v8aeyjfL1D9Xorj8ypaXkALhwXzQNA/640?wx_fmt=png&from=appmsg "null")  
  
  
因为之后可能指纹数量会比较多，所以在指纹匹配这里做了性能优化（这里测试样例比较少，后续看情况再修改）。  
  
**原有问题**  
  
之前的实现中，指纹匹配采用逐条扫描的方式：  
  
每个指纹都会分别去扫描一次响应体和响应头  
  
大多数指纹本质上只是简单字符串匹配  
  
当指纹数量较少时问题不明显，但随着指纹规模增长，这种“指纹数 × 响应内容长度”的匹配方式会带来明显的性能下降。  
  
**优化思路**  
  
为降低匹配复杂度，引入 AC 自动机（Aho-Corasick） 作为统一的初筛工具，整体思路是：  
  
为每个指纹提取一个较长、具有区分度的特征字符串  
  
将这些特征字符串统一构建成 AC 自动机  
  
对响应体只扫描一次，即可快速找出可能命中的指纹集合  
  
仅对这些命中的指纹，再执行原本的精确匹配逻辑（响应头 + 响应体）  
## 3d资产  
  
这里是想测试一下Antigravity编写代码能力，最终是用Antigravity+cursor完成的。可能没什么用，但是 写都写了。  
  
  
  
****  
![](https://mmbiz.qpic.cn/mmbiz_jpg/0a6elNzWYayjIHTdknFhLGa66kM9GGzyUVmLo5EXy7YohdbuBuFWb4ePTJ0cRCoCjTMeXVYDTjDiaYMZqMxicruw/640?wx_fmt=jpeg "")  
  
****  
  
  
  
