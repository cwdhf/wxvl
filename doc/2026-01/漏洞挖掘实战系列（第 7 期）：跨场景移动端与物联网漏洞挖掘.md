#  漏洞挖掘实战系列（第 7 期）：跨场景移动端与物联网漏洞挖掘  
原创 点击关注👉  网络安全学习室   2026-01-11 02:38  
  
前面6期我们覆盖了Web和Pwn两大核心模块，但CTF赛事中还有两类“低竞争、高性价比”的漏洞——**移动端漏洞**  
和**物联网固件漏洞**  
。这类题型选手覆盖率低（很多人觉得“门槛高”），但套路固定、工具成熟，掌握后能轻松拉开分差。本期聚焦Android/iOS移动端、物联网固件的高频漏洞，用2025真题案例拆解“逆向→挖洞→利用”全流程，新手也能快速上手！  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralYCOWe0tQO4wnKRkJ5lynztELh3VeicL1ToMwpPHk3d9sRcCflTfhFohTyJm8iba1DbpjH8OazHfWSA/640?wx_fmt=png&from=appmsg "")  
## 一、移动端漏洞：Android为主，iOS为辅（CTF高频）  
  
CTF移动端漏洞90%集中在Android（开源易逆向），核心是“组件暴露、数据泄露、WebView漏洞”，iOS因闭源仅偶尔出现基础题，重点掌握Android即可。  
### 1. 必备工具链（0成本搭建）  
<table><thead><tr><th style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">工具</span></section></th><th style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">作用</span></section></th><th style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">安装方式</span></section></th></tr></thead><tbody><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">Jadx</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">APK反编译（看源码）</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">官网下载绿色版，无需安装</span></section></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">Android Studio</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">模拟器运行+调试</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">官网下载，安装后创建Android 9/10模拟器（兼容性最好）</span></section></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">Frida</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">动态插桩（Hook函数）</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">Python环境执行</span><code><span leaf="">pip install frida-tools</span></code><span leaf="">，手机/模拟器安装Frida-server</span></section></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">Apktool</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">APK解包/重打包</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">官网下载jar文件，执行</span><code><span leaf="">java -jar apktool.jar d 目标.apk</span></code><span leaf="">解包</span></section></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">蚁剑/菜刀</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">连接一句话木马</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">官网下载，适配移动端WebView漏洞</span></section></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">新手简化版：先装Jadx+Android Studio+Frida，能应对80%的Android漏洞题。</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf=""><br/></span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf=""><br/></span></section></td></tr></tbody></table>### 2. 高频漏洞1：组件暴露（最容易拿分）  
#### 漏洞本质：  
  
Android的Activity、Service、BroadcastReceiver等组件，在AndroidManifest.xml  
中配置了android:exported="true"  
（允许外部调用），且未做权限校验，导致低权限APP或攻击者可直接调用敏感功能。  
#### 识别方法：  
1. 用Jadx打开APK，查看AndroidManifest.xml  
；  
  
1. 找android:exported="true"  
的组件，且包含敏感关键词（如admin  
、login  
、user  
）。  
  
#### 真题实战：2025强网杯「android_export」  
  
**场景**  
：APK的AdminActivity  
组件暴露，未授权可调用getFlag()  
方法获取flag。  
1. **逆向分析**  
：  
  
1. 用Jadx打开APK，找到AdminActivity  
，发现onCreate  
方法中调用getFlag()  
，返回flag字符串；  
  
1. 查看AndroidManifest.xml  
，AdminActivity  
配置android:exported="true"  
，无权限校验。  
  
1. **利用步骤**  
：  
  
1. 用Android Studio创建空APP，在代码中调用AdminActivity  
：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralYwBsrZGLoKLCfUW1Pia7HboobwzHlwe9xnMRJ6qKfQPYfBpMc3Qvuf1Wa1bzvfwSrJoCcQMmibz43A/640?wx_fmt=png&from=appmsg "")  
  
1. 安装空APP并运行，直接跳转至AdminActivity  
，页面显示flag：flag{android_export_bypass_2025}  
。  
  
1. **Frida Hook简化利用**  
（无需写APP）：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralYwBsrZGLoKLCfUW1Pia7Hboj3MY6bIoyQOveDK2BZKEqlELYgNJib4Dgc1eVfwRiaZPh7cvgH8iay8hQ/640?wx_fmt=png&from=appmsg "")  
  
1. 运行脚本后，打开目标APP，控制台直接输出flag。  
  
### 3. 高频漏洞2：WebView漏洞（可RCE）  
#### 漏洞本质：  
  
WebView启用setJavaScriptEnabled(true)  
（允许JS执行），且暴露了addJavascriptInterface  
（JS可调用Java方法），导致攻击者通过注入恶意JS调用敏感Java方法，实现文件读取或RCE。  
#### 识别方法：  
  
用Jadx搜索关键词：setJavaScriptEnabled(true)  
、addJavascriptInterface  
。  
#### 真题实战：WebView RCE读取flag  
  
**场景**  
：APK的WebView启用JS，且暴露了getFileContent(String path)  
方法（读取文件内容）。  
1. **构造恶意HTML**  
：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralYwBsrZGLoKLCfUW1Pia7HboqB8FialtElfSZWYYNAC2fHtQlxia707njvFMWgfwZeEAWib91buwicFBEw/640?wx_fmt=png&from=appmsg "")  
  
1. **利用步骤**  
：  
  
1. 把HTML文件放在本地服务器（如Python开启python -m http.server 8080  
）；  
  
1. 让目标APP的WebView加载该HTML（可通过组件暴露或手动输入URL）；  
  
1. 恶意JS调用getFileContent("/flag")  
，读取flag并显示在页面上。  
  
### 4. 移动端避坑清单：  
1. 模拟器版本匹配：尽量用Android 9/10模拟器，高版本（Android 11+）权限限制更严；  
  
1. Frida-server版本：需与Frida-tools版本一致，否则无法附加进程；  
  
1. 签名问题：重打包APK后需重新签名（用keytool  
+jarsigner  
），否则无法安装；  
  
1. 敏感文件路径：Android中flag常存放在/data/data/包名/files/flag  
或/sdcard/flag  
。  
  
## 二、物联网固件漏洞：固件提取+逆向，拿下新兴题型  
  
物联网（IoT）漏洞是2025 CTF的新兴热点，主要考察“固件提取、文件系统分析、二进制逆向”，核心是“找到硬编码密码、栈溢出漏洞或未授权访问”。  
### 1. 必备工具链（Linux/WSL环境）  
<table><thead><tr><th style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">工具</span></section></th><th style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">作用</span></section></th><th style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">安装方式</span></section></th></tr></thead><tbody><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">Binwalk</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">固件提取（拆包文件系统）</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><code><span leaf="">apt install binwalk</span></code></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">Foremost</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">辅助提取文件</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><code><span leaf="">apt install foremost</span></code></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">QEMU</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">模拟固件运行（ARM/MIPS架构）</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><code><span leaf="">apt install qemu-system-arm qemu-user-static</span></code></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">Ghidra</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">固件二进制逆向</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">官网下载绿色版</span></section></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">Hashcat</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">密码爆破（硬编码密码哈希）</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><code><span leaf="">apt install hashcat</span></code></td></tr></tbody></table>### 2. 核心流程：固件提取→分析→利用（三步法）  
#### 步骤1：固件提取（拆包文件系统）  
  
拿到固件文件（如firmware.bin  
），用Binwalk提取：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralYwBsrZGLoKLCfUW1Pia7HboTKJHoICJ4TlHJkticMsoIFDlFwpSZhDeF6ufPrhq4sYWib79WnGZeSPw/640?wx_fmt=png&from=appmsg "")  
  
提取后会生成_firmware.bin.extracted  
目录，其中rootfs  
是固件的文件系统（类似Linux根目录）。  
#### 步骤2：文件系统分析（找敏感信息）  
  
优先找以下文件，80%的基础题flag藏在这里：  
1. /etc/passwd  
、/etc/shadow  
：用户密码哈希（用Hashcat爆破）；  
  
1. /etc/ssh/sshd_config  
：SSH配置，看是否允许root登录；  
  
1. /var/www/html  
：Web后台文件，找硬编码密码或SQL注入漏洞；  
  
1. /bin  
目录：二进制程序，用Ghidra逆向找栈溢出漏洞。  
  
#### 真题实战1：硬编码密码（2025西湖论剑「iot_crack」）  
  
**场景**  
：提取固件后，在/bin/httpd  
程序中找到硬编码的SSH密码。  
1. 用Binwalk提取固件，得到rootfs/bin/httpd  
；  
  
1. 用Ghidra打开httpd  
，搜索字符串password  
、root  
；  
  
1. 找到硬编码密码root:iot2025ctf  
；  
  
1. 用QEMU模拟固件运行，SSH登录root  
用户，读取/flag  
。  
  
#### 真题实战2：栈溢出漏洞（物联网Pwn）  
  
**场景**  
：固件/bin/iot_server  
程序存在栈溢出（gets  
函数未限制输入长度）。  
1. 逆向分析：用Ghidra打开iot_server  
，找到main  
函数中的gets(buf)  
，buf大小0x20；  
  
1. 计算偏移：用QEMU运行程序，gdb调试算偏移（参考Pwn篇的pattern方法）；  
  
1. 构造Payload：生成栈溢出Payload，用QEMU模拟执行，getshell后读取flag。  
  
### 3. QEMU模拟固件运行（关键步骤）  
  
物联网固件多为ARM架构，用QEMU模拟：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralYwBsrZGLoKLCfUW1Pia7HbobOneiaO6sBjYC7nuDczeibicTNhfoXVboPicw4324KwwkStNlNRN8YaiayA/640?wx_fmt=png&from=appmsg "")  
  
模拟成功后，即可像操作Linux一样执行ls  
、ssh  
等命令。  
### 4. 物联网避坑清单：  
1. 架构匹配：固件多为ARM/MIPS架构，QEMU需安装对应架构的模拟包；  
  
1. 文件系统权限：提取后可能需要chmod -R 777 rootfs  
，否则无法访问；  
  
1. 动态库依赖：模拟二进制程序时，需拷贝对应的动态库（如libc.so  
）到rootfs/lib  
；  
  
1. 网络配置：部分固件需要配置网络才能访问Web后台，用ifconfig  
设置IP。  
  
## 三、跨场景漏洞核心技巧总结  
1. 移动端：优先找“组件暴露”和“WebView漏洞”，工具用Jadx+Frida，无需深入Android底层；  
  
1. 物联网：基础题先找“硬编码密码”，进阶题再看“二进制漏洞”，QEMU是模拟运行的核心；  
  
1. 通用思路：CTF跨场景漏洞不考“实战0day”，多是“经典漏洞+场景适配”，复用Web/Pwn的挖掘思路即可。  
  
## 四、福利+互动  
  
跨场景漏洞看似门槛高，实则是“工具+套路”的组合，跟着实操练3道题就能入门！  
  
**200节攻防教程，限时领！**  
  
想要的兄弟，**关注我+在后台发“学习”**  
，直接免费分享！  
  
![图片](https://mmbiz.qpic.cn/sz_mmbiz_jpg/iaLzURuoralYwBsrZGLoKLCfUW1Pia7HboUUL7vLubRE4gibIvFve5zuVJ7pp7mXmGam6pmKLkLSiawUnDOGNlvjqw/640?wx_fmt=jpeg&from=appmsg&watermark=1&wxfrom=5&wx_lazy=1&tp=webp#imgIndex=17 "")  
  
咱学漏洞挖掘和CTF，光看文章不够，这套教程里全是**实战演示**  
——从工具配置到漏洞利用，每一步都手把手教，跟着练就能上手！  
  
（注：资源领取入口在公众号后台，关注后发“学习”自动弹链接）  
  
  
****### 下期预告  
  
第8期将带来「CTF赛事实战策略篇」，拆解8小时赛事的“漏洞挖掘优先级、团队协作分工、应急避坑技巧”，帮你把学到的技术转化为实际得分，冲击CTF奖项！  
  
