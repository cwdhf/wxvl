#  【代码审计】CVE-2025-46836  
原创 韭菜
                    韭菜  隐雾安全   2026-01-18 01:01  
  
**漏洞通告**  
  
net-tools 是一组程序，构成了 Linux 操作系统 NET-3 网络发行版的基础组件。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ELQKhUzr34xnnh9TdL0T9VWQ5wUc6MbicKvzdznyjrzuNsHicpA2DYv4szwDY8uZSSmFGwb0ey9pKNMbdFQobT5w/640?wx_fmt=png&from=appmsg "")  
  
查看漏洞补丁  
  
知道了删除了**lib/interface.c**  
下的**while**  
...  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ELQKhUzr34xnnh9TdL0T9VWQ5wUc6MbicLcAicbcF5x4rwUsSwn0vrdJ9eXSJkkDLz0Ebiae5VFCyIsFINcrIeBCQ/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ELQKhUzr34xnnh9TdL0T9VWQ5wUc6MbictibYwWUr49NibPyXJYeFMcCcFF5nQEmciaQed1ugrVPJgmYWr0iamQ99Ug/640?wx_fmt=png&from=appmsg "")  
  
**漏洞分析**  
  
关于这里能修改的参数只有一个指针  
*name  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ELQKhUzr34xnnh9TdL0T9VWQ5wUc6MbiccfOHef4bQlLITLSHZxPDs3qOT9D39AZtUYtYqseJLsYqBcPic04OVCg/640?wx_fmt=png&from=appmsg "")  
  
逆向追踪调用函数**if_readlist_proc**  
  
知道了  
**name**  
的长度  
**char name[IFNAMSIZ];**  
**IFNAMSIZ**  
的长度是16  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ELQKhUzr34xnnh9TdL0T9VWQ5wUc6MbicCqnXYYTwWYq38PjiaKgCiajW8ENVDNLSbqFhzZzxzzbDShrZMtdIu7nA/640?wx_fmt=png&from=appmsg "")  
  
回到  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ELQKhUzr34xnnh9TdL0T9VWQ5wUc6MbicCqnXYYTwWYq38PjiaKgCiajW8ENVDNLSbqFhzZzxzzbDShrZMtdIu7nA/640?wx_fmt=png&from=appmsg "")  
  
函数，重点关注  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ELQKhUzr34xnnh9TdL0T9VWQ5wUc6MbicCqnXYYTwWYq38PjiaKgCiajW8ENVDNLSbqFhzZzxzzbDShrZMtdIu7nA/640?wx_fmt=png&from=appmsg "")  
  
是否可能超过16  
  
到这里大概知道如果*p 的长度大于16那么就会造成溢出  
  
漏洞点：  
```
*name++ = *p++;
```  
  
从237行开始逆向关注*p，看看是否进行了什么处理  
  
整体看来并没有对*p做什么处理，两个判断218行和220行  
  
if (isspace(*p))判断*p是否为空  
  
if (*p == ':') {判断*p是否是:  
  
大概知道*name 读取的是 *p 空格之后:之前的数据  
  
接下来关注*p是哪里来的  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ELQKhUzr34xnnh9TdL0T9VWQ5wUc6MbicIr3ia5BtwchqxwySXPHRtxAibd7VLVp0YNkd0gHmTm9Sj4rkPeicOaKlg/640?wx_fmt=png&from=appmsg "")  
  
*p=buf而buf是通过文件读取的fgets(buf, sizeof buf, fh)，buf读取的是fh读取的是buf大小的数据  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ELQKhUzr34xnnh9TdL0T9VWQ5wUc6MbicBx4ByxILIM2TaNibadOzhXibf3FUrXMXtuxLoibGPlyknxCOjeZjIwcCw/640?wx_fmt=png&from=appmsg "")  
  
buf[512]buf大小是512很明显超过了16,那么fh文件超过了16那么就存在溢出  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ELQKhUzr34xnnh9TdL0T9VWQ5wUc6MbicZDDZDWibMc9FJMrPKO6f4IVMrDpQnsjdZzm5d7Iz6nfImEqy2sEcXtg/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ELQKhUzr34xnnh9TdL0T9VWQ5wUc6MbictibYwWUr49NibPyXJYeFMcCcFF5nQEmciaQed1ugrVPJgmYWr0iamQ99Ug/640?wx_fmt=png&from=appmsg "")  
  
**JOIN US～**  
  
代码审计其实并不神秘，核心就在于对 “数据流向” 的把控。  
  
扫码添加微信，备注【审计】，获取更多审计资料。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/ELQKhUzr34xnnh9TdL0T9VWQ5wUc6MbicezjXhdfDnUPJSVjXPQoQ17hlibqmhyY2HOJpfsIzTrcrNp7jDPMaIrw/640?wx_fmt=jpeg&from=appmsg "")  
  
**往期内容：**  
  
  
**课程推荐：**  
  
  
  
