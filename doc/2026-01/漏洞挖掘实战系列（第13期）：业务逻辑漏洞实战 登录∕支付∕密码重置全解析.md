#  漏洞挖掘实战系列（第13期）：业务逻辑漏洞实战 登录/支付/密码重置全解析  
原创 点击关注👉
                    点击关注👉  网络安全学习室   2026-01-17 02:45  
  
在上一期，我们讲了业务逻辑漏洞的核心定义、挖掘方法和典型特征，知道了这类漏洞是“靠思维取胜”的高价值漏洞——不依赖复杂技术，却能在CTF和真实渗透中稳定拿分、挖掘高危害漏洞。  
  
这一期，我们聚焦三大高频场景——**登录、支付、密码重置**  
，拆解5个真实可复现的实战案例，每个案例都包含“场景还原+漏洞分析+挖掘步骤+Payload构造+绕过技巧”，让你看完就能直接复现、落地使用，快速搞定这类漏洞。  
  
无论是CTF选手应对业务逻辑题型，还是渗透测试工程师挖掘真实环境漏洞，这篇内容都能直接复用！  
  
![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralagtWOApyfnA4Ph5ibXEFeXEz1rG4l9hJd1P5bSP5Rj7pyyeYB001587Z9Cb0APJbDZ2PWCNxzCxrA/640?wx_fmt=png&from=appmsg&watermark=1&wxfrom=5&wx_lazy=1&tp=webp#imgIndex=0 "")  
## 一、登录场景：3个高频业务逻辑漏洞实战  
  
登录是所有系统的入口，也是业务逻辑漏洞的“重灾区”。开发者往往专注于账号密码校验，却忽略了流程逻辑的严谨性，导致多种可绕过漏洞。  
### 案例1：验证码时效性缺失（可重复使用）  
#### 1. 场景还原  
  
某管理系统登录页支持“账号+密码+手机验证码”登录，用户获取验证码后，输入正确信息即可登录。测试发现，获取一次验证码后，多次提交登录请求均能通过，无需重新获取。  
#### 2. 漏洞分析  
  
核心问题：后端仅校验验证码是否正确，**未在验证通过后销毁验证码、未设置时效性**  
，导致验证码成为“永久有效凭证”。攻击者若获取到一次验证码（如嗅探、社工），可无限次登录目标账号。  
#### 3. 挖掘步骤（Burp实操）  
1. 打开登录页，输入账号密码，点击“获取验证码”，用Burp抓包记录验证码请求（如手机号138XXXX1234，获取验证码1234）；  
  
1. 提交登录请求，抓包查看POST数据，包含参数phone=138XXXX1234&password=xxx&code=1234  
，验证通过登录成功；  
  
1. 退出登录，再次提交相同POST数据（code仍为1234），发现仍能登录成功，漏洞确认；  
  
1. 延伸测试：间隔1小时、更换设备后提交，仍能通过，确认无时效性限制。  
  
#### 4. 利用Payload与绕过  
  
无需复杂Payload，直接复用首次获取的验证码即可。若存在验证码长度限制、字符类型限制，按实际获取的验证码提交即可。  
  
绕过小技巧：若后端对同一手机号获取验证码频率有限制，可复用已获取的验证码绕过频率限制，无需多次请求验证码。  
#### 5. 修复建议  
- 验证码设置有效期（如5分钟），过期自动失效；  
  
- 验证码验证通过后立即销毁，同一验证码仅能使用一次；  
  
- 记录验证码使用状态，已使用的验证码禁止再次校验。  
  
### 案例2：登录状态逻辑绕过（跳过密码校验）  
#### 1. 场景还原  
  
某Web系统登录流程为：输入账号→校验账号存在性→输入密码→校验密码→登录成功。测试发现，可通过篡改请求参数，跳过密码校验步骤直接登录。  
#### 2. 漏洞分析  
  
核心问题：后端采用“分步校验”逻辑，且仅在前端判断步骤顺序，**后端未对步骤合法性进行校验**  
。攻击者可直接构造“密码校验通过”的请求，跳过密码输入环节。  
#### 3. 挖掘步骤（Burp实操）  
1. 打开登录页，输入账号admin，点击“下一步”，抓包查看请求：POST /api/login/step1 HTTP/1.1  
，参数username=admin  
，后端返回{"status":1,"msg":"账号存在","step":1}  
；  
  
1. 正常输入密码，点击“登录”，抓包查看请求：POST /api/login/step2 HTTP/1.1  
，参数username=admin&password=xxx&step=2  
，后端返回登录成功；  
  
1. 退出登录，直接构造step2请求，删除password参数或填写任意密码（如123456），发送请求：POST /api/login/step2 HTTP/1.1  
，参数username=admin&password=123456&step=2  
；  
  
1. 后端返回登录成功并生成session，漏洞确认，成功跳过密码校验。  
  
#### 4. 利用Payload与绕过  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralbO2ibJtf2tmhFx7IAcV73qN1govKZvJfTiaTXzzRa7Dno7ZmYVXXthhnwLibvmnrqqMzcFrpMFT1D4Q/640?wx_fmt=png&from=appmsg "")  
  
绕过小技巧：若后端校验step参数与前一步状态的关联性，可先发送step1请求获取合法状态，再构造step2请求，仍可绕过密码校验。  
#### 5. 修复建议  
- 后端记录用户登录步骤状态（如存入session），仅允许按顺序执行步骤，禁止直接跳转至后续步骤；  
  
- 每一步校验均需关联前一步的合法状态，无前置状态则拒绝请求；  
  
- 密码校验逻辑必须在后端执行，前端仅做输入提示，不参与逻辑判断。  
  
### 案例3：账号枚举与弱口令碰撞（逻辑设计缺陷）  
#### 1. 场景还原  
  
某系统登录页，输入错误账号时提示“账号不存在”，输入正确账号+错误密码时提示“密码错误”。攻击者可利用该提示差异，枚举合法账号后暴力破解弱口令。  
#### 2. 漏洞分析  
  
核心问题：登录失败提示信息“差异化”，**泄露账号是否存在的敏感信息**  
，为攻击者枚举账号提供便利，结合弱口令字典可快速破解账号。  
#### 3. 挖掘步骤与利用  
1. 枚举账号：用Burp Intruder加载账号字典（如admin、user、test等），提交登录请求，根据返回提示筛选出合法账号（返回“密码错误”的为合法账号）；  
  
1. 弱口令碰撞：针对枚举到的合法账号（如admin），加载弱口令字典（如123456、admin@123等），再次用Intruder爆破，返回“登录成功”即为正确密码；  
  
1. 延伸测试：若存在验证码，可结合“验证码可重复使用”漏洞，绕过验证码限制批量爆破。  
  
#### 4. 绕过技巧  
  
若后端有登录失败次数限制（如5次后锁定账号），可采用“多账号轮换爆破”“降低爆破频率”的方式绕过，避免账号被锁定。  
#### 5. 修复建议  
- 登录失败统一提示“账号或密码错误”，不区分账号不存在和密码错误；  
  
- 设置登录失败次数限制，超过次数锁定账号（如5次后锁定1小时）；  
  
- 添加动态验证码（如图形验证码、短信验证码），防止批量爆破。  
  
## 二、支付场景：高频逻辑漏洞实战（高价值）  
  
支付场景的业务逻辑漏洞直接关联财产安全，是真实渗透中“高评分、高奖励”的漏洞类型，CTF中也常以“电商支付”“充值”场景出题。  
### 案例4：支付金额篡改（后端无校验）  
#### 1. 场景还原  
  
某电商平台购买商品流程：选择商品→提交订单（生成订单金额100元）→支付页面→提交支付请求。测试发现，可篡改支付金额参数，以1元购买100元商品。  
#### 2. 漏洞分析  
  
核心问题：后端仅信任客户端提交的支付金额，**未与订单原始金额进行二次校验**  
，导致攻击者可任意篡改支付金额，造成经济损失。  
#### 3. 挖掘步骤（Burp实操）  
1. 选择商品提交订单，生成订单号ORDER12345，订单金额100元，进入支付页面；  
  
1. 点击“支付”，用Burp抓包查看支付请求，参数包含orderNo=ORDER12345&amount=100&payType=alipay  
；  
  
1. 在Burp中修改amount参数为1，发送请求：orderNo=ORDER12345&amount=1&payType=alipay  
；  
  
1. 跳转至支付宝支付页面，显示支付金额1元，支付成功后，平台确认订单完成，漏洞确认。  
  
#### 4. 利用Payload与绕过  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralbO2ibJtf2tmhFx7IAcV73qNgHKXtL0UFIZ0BG9UicVLt8oI0YPnwKeBdLuJZuicv7MUHKuwdJxSN1kw/640?wx_fmt=png&from=appmsg "")  
  
绕过小技巧：若存在签名参数（sign），可尝试分析签名算法（如MD5加密），若签名仅包含订单号，不包含金额，可篡改金额后重新生成签名；若签名算法复杂，可尝试删除sign参数，部分系统会忽略签名校验。  
#### 5. 修复建议  
- 支付金额以订单生成时的原始金额为准，后端从数据库查询订单金额，不接收客户端提交的金额参数；  
  
- 添加签名校验，签名需包含订单号、金额、时间戳等关键参数，防止参数篡改；  
  
- 支付成功后，再次校验支付金额与订单金额是否一致，不一致则标记订单异常。  
  
## 三、密码重置场景：逻辑漏洞实战（越权重置）  
### 案例5：密码重置Token可预测（越权重置他人密码）  
#### 1. 场景还原  
  
某系统密码重置流程：输入手机号→获取验证码→验证通过→生成重置链接（含Token）→点击链接重置密码。测试发现，可预测他人的重置Token，越权重置他人账号密码。  
#### 2. 漏洞分析  
  
核心问题：Token生成逻辑简单，采用“手机号+固定字符串+时间戳”的MD5加密，无随机因子，**攻击者可通过规律预测目标用户的Token**  
，构造合法重置链接。  
#### 3. 挖掘步骤（实操）  
1. 用自己的手机号（138XXXX1234）发起密码重置，获取验证码并验证通过，得到重置链接：http://target.com/reset?token=e10adc3949ba59abbe56e057f20f883e&phone=138XXXX1234  
；  
  
1. 分析Token规律：通过多次测试发现，Token为MD5(手机号+固定密钥+时间戳)  
，固定密钥为“abc123”，时间戳精确到分钟（如1690000000）；  
  
1. 预测目标手机号（139XXXX5678）的Token：获取当前时间戳（精确到分钟），计算MD5("139XXXX5678abc1231690000000")  
，得到目标Token；  
  
1. 构造目标用户的重置链接：http://target.com/reset?token=预测的Token&amp;phone=139XXXX5678  
，访问链接可直接重置该账号密码，漏洞确认。  
  
#### 4. 利用Payload与绕过  
  
Token生成脚本（Python）：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralbO2ibJtf2tmhFx7IAcV73qNL7zXUDNfj5vLibiar3NXB13tdaVyic0qxh57FzrLw9m36l9jMWp9ibwqMQ/640?wx_fmt=png&from=appmsg "")  
  
绕过小技巧：若时间戳精确到秒，可通过批量生成近10秒的Token，逐一尝试访问，大概率能命中有效Token。  
#### 5. 修复建议  
- Token生成加入随机因子（如UUID），避免可预测性，示例：MD5(手机号+UUID+时间戳+随机数)  
；  
  
- 设置Token有效期（如10分钟），过期自动失效，且仅能使用一次；  
  
- 重置密码时，再次验证手机号验证码，双重确认身份。  
  
## 四、业务逻辑漏洞挖掘通用技巧（实战总结）  
1. **流程拆解要细致**  
：把每个功能拆成最小步骤，逐一测试步骤间的逻辑关联性，重点关注“分步校验”场景，尝试跳过步骤、打乱顺序；  
  
1. **参数篡改无死角**  
：不仅篡改数值型参数（金额、ID），还要测试字符串参数（Token、状态值）、布尔值参数（isLogin、isValid），甚至尝试删除参数；  
  
1. **前后端逻辑要区分**  
：前端的限制（如按钮禁用、输入校验）均可绕过，必须测试后端是否有对应的校验逻辑；  
  
1. **异常场景多尝试**  
：重复提交请求、并发请求、跨账号操作、空值提交，这些异常场景往往能暴露逻辑缺陷；  
  
1. **关联漏洞多组合**  
：业务逻辑漏洞常与其他漏洞组合利用（如验证码可重复+账号枚举、Token可预测+越权），组合后危害更大。  
  
## 五、福利+互动  
  
支付、登录、密码重置这三大场景，覆盖了80%的业务逻辑漏洞实战场景，掌握这些案例，无论是CTF答题还是真实渗透，都能快速找到突破口。  
  
**200节攻防教程，限时领！**  
  
想要的兄弟，**关注我+在后台发“学习”**  
，直接免费分享！  
  
![图片](https://mmbiz.qpic.cn/sz_mmbiz_jpg/iaLzURuoralagtWOApyfnA4Ph5ibXEFeXELPDDtGelXCL7AJNXllkwVHN58qibvIvOf6v1G2W0vduoibnFEqTibbsFQ/640?wx_fmt=jpeg&from=appmsg&watermark=1&wxfrom=5&wx_lazy=1&tp=webp#imgIndex=17 "")  
  
咱学漏洞挖掘和CTF，光看文章不够，这套教程里全是**实战演示**  
——从工具配置到漏洞利用，每一步都手把手教，跟着练就能上手！  
  
（注：资源领取入口在公众号后台，关注后发“学习”自动弹链接）  
  
### 下期预告  
  
第14期将带来《高级SQL注入技巧：WAF绕过+盲注优化+实战案例》，拆解多种复杂WAF的绕过方法，以及高效盲注技巧，帮你搞定CTF和真实场景中的SQL注入难题！  
  
