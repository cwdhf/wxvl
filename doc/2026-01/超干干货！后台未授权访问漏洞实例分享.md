#  超干干货！后台未授权访问漏洞实例分享  
原创 洞悉安全攻防团队
                    洞悉安全攻防团队  洞悉安全团队   2026-01-30 10:30  
  
点击上方  
蓝字  
关注我们！  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Wp79QbImyk9yJMJQ3LTgqaJ6hsnXF6qNHsWt10W9qbHr4mdaXlt8ibEABjq22VtiawCCrSUicBJsO6icyiaFtxjesMQ/640?from=appmsg "")  
  
最近在测试某招聘平台时，无意间发现了一个容易被忽视的未授权漏洞。过程并不复杂，但恰恰是这种“看似没问题”的设计，容易成为系统的软肋。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Wp79QbImyk9yJMJQ3LTgqaJ6hsnXF6qNTMcib9b7O9IARXdlQOjUkC05cLBAqibE68ia98koyt5vsdU7iabf3y4zmw/640?from=appmsg "")  
  
  
  
一.某招聘后台未授权访问漏洞  
  
  
场景还原  
  
  
  
平台有两个主要系统：  
  
1.招聘系统  
：  
  
    面向求职者和企业用户；  
  
    base_api以   
/hire  
开头。  
  
2.后台管理系统  
：  
  
    供内部管理人员使用；  
  
    base_api以   
/hradmin  
开头。  
  
求职者接口  
/hire  
下的接口属于普通用户功能，而内部管理员接口  
/hramin  
下的接口则需要管理员权限。  
  
  
测试思路  
  
  
  
    正常情况下，如果登录不进去，我们会先尝试弱口令，再收集接口，将获取到的接口，尝试使用不同的访问方式去测试，并且尝试fuzz出对应参数等。  
1. 这里使用正常的访问测试未授权时，全部返回302，并且直接跳转到的登录页面。  
  
1. 尝试用普通用户的token去访问，也全部返回302，这里可能校验了是否有管理平台的权限。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/dOYiaqzHIghbDbvibRQEJ9YP1QgOYCcA4MtQDlgoSrnxCvCeh2KOt9Rrk1yxS9icjORqlCfsjd2n2JoSD2sq0J3Zw/640?from=appmsg "")  
  
    使用管理平台  
/hradmin  
api访问会返回302，但是  
使用招聘平台的  
/hire  
api  
去访问，直接  
返回了全部数据。  
  
1、访问  
/hradmin/FileAttach/getSysFileAttachPage  
  
    => 响应码302，跳转回登录页面  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/dOYiaqzHIghbDbvibRQEJ9YP1QgOYCcA4M8mIibbicfHBOLv9fUEibOVY5ib8l78DibKEncaw1GZVqRiasMtb4zh8gNIAg/640?from=appmsg "")  
  
2、访问  
/hire/FileAttach/getSysFileAttachPage  
  
    =>   
响应码  
200，直接获取到了全部数据  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/dOYiaqzHIghbDbvibRQEJ9YP1QgOYCcA4MibrWpOViblGO9LrblT7tGD7XuOOnWNEpeBniap9blYkjqoW1x0YicicZFiaQ/640?from=appmsg "")  
  
  
    通过对数据解密，获取到所用用户的身份证，毕业证，银行卡图片等信息：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/dOYiaqzHIghbDbvibRQEJ9YP1QgOYCcA4MjMlH781zsQs8UmrKpJA73TfMVcMct6v3qI3K23cbd9LbmzIP4Ga5Gw/640?from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/ibibcV5C2Fxt8KF2nvUB4ibibbBvwBdymVkQKw5xG6xAoAFellPY0mz4BREtkJ1M3Mib3uSxwXrpSDicAia7jCEKemWsw/640?from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/5HAz5Dg8SOkjmyVTZjk9tbp3SiaRXaRbWz9K95rrjzicHcdPgfMN3MumibokNDcCrXM8HSkXyeJfY6wJPxd52uJFw/640?from=appmsg "")  
  
从“一个漏洞”到“一类漏洞”的思考  
  
  
通过该漏洞可以举一反三，遇到后台不仅要使用常规的思路去测试未授权访问漏洞，在我们遇到同域名或相似的站点， 或者同时存在前台后台的站点，我们可以将收集到的接口结合起来，同时进行测试  
```
例：(1)a.xxx.com 我们有权限去访问 (2)b.xxx.com 我们没有权限去访问我们可以将a系统的token，去访问b系统的接口，也可能会出现意料之外的情况下面的案例就是这种情况导致的信息泄露
```  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/ibibcV5C2Fxt8KF2nvUB4ibibbBvwBdymVkQKw5xG6xAoAFellPY0mz4BREtkJ1M3Mib3uSxwXrpSDicAia7jCEKemWsw/640?from=appmsg "")  
  
  
  
  
  
二.某小程序后台未授权访问漏洞  
  
  
测试思路  
  
  
  
    在测试完小程序后，尝试将小程序的域名放到web上去访问，直接获取到了小程序的管理后台。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/dOYiaqzHIghbDbvibRQEJ9YP1QgOYCcA4MKNzpdFgHHMGiadCS2SiczAWQBqCgTt34ELOiaQn1V6vwI8M5jEXUeZAZw/640?from=appmsg "")  
  
  
    在收集的管理后台的接口中，发现了  
/refund/list/new  
 的接口，可以列出后台的退款信息，但是使用管理平台直接访问会显示没有权限，这里尝试  
使用小程序的token，访问管理平台的接口，直接  
获取了上千条数据，包含三要素。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/dOYiaqzHIghbDbvibRQEJ9YP1QgOYCcA4MEPAmp5y0ia4ROuZ166o1mhaCrcfCE5ViaYNYMJ2icIy530jAsmlZ2CruA/640?from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/dOYiaqzHIghbDbvibRQEJ9YP1QgOYCcA4Mbic283KtzeaVdnibX5icAic9IGaRmtey0cTUVoBTSP1WSUZHAvI7Ficic0Og/640?from=appmsg "")  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/cv7xkU9cPaX1dqtBQs6CcuBcVruKFIXQKHnK0iaQY1lRENrqAp2dD2piaqJcyPic3WYTicIjCXDNDCZvicxfvqEUSFQ/640?from=appmsg "")  
  
  
