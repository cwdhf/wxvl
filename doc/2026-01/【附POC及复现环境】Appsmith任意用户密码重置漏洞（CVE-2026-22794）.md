#  【附POC及复现环境】Appsmith任意用户密码重置漏洞（CVE-2026-22794）  
原创 a1batr0ss
                    a1batr0ss  天翁安全   2026-01-16 09:03  
  
**免责声明：**  
本公众号所发布的全部内容，包括但不限于技术文章、POC脚本、漏洞利用工具及相关测试环境，均仅限于合法的网络安全学习、研究和教学用途。所有人在使用上述内容时，应严格遵守中华人民共和国相关法律法规以及道德伦理要求。未经明确的官方书面授权，严禁将公众号内的任何内容用于未经授权的渗透测试、漏洞利用或攻击行为。 所有人仅可在自己合法拥有或管理的系统环境中进行本地漏洞复现与安全测试，或用于具有明确授权的合法渗透测试项目。所有人不得以任何形式利用公众号内提供的内容从事非法、侵权或其他不当活动。 如因违反上述规定或不当使用本公众号提供的任何内容，造成的一切法律责任、经济损失、纠纷及其他任何形式的不利后果，均由相关成员自行承担，与本公众号无任何关联。  
## 不错过最新的漏洞POC  
  
为保证您可以在第一时间接收到本公众号分享的**漏洞复现及POC**  
信息，建议您在公众号“天翁安全”主页界面将“天翁安全”设为**星标**  
。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydoqMAI2YFeLE61zeV8iaTicsIicxkyfufNyyQ7yls4XiciaRyMrpI4XQwM7w/640?wx_fmt=png&from=appmsg "")  
## 漏洞介绍  
  
CVE‑2026‑22794 是一个影响开源低代码平台 Appsmith 的严重安全漏洞，在 1.93 之前的版本中服务器会直接信任来自 HTTP 请求头里的 Origin  
 值作为生成密码重置和邮箱验证链接的基础 URL，而没有进行任何验证或过滤，这样攻击者只要能控制 Origin  
 头就能让 Appsmith 生成指向其恶意域名的链接并通过邮件发送给用户，一旦用户点击这些链接，包含在链接中的认证令牌可能会泄露给攻击者，从而导致用户账户被完全接管，该漏洞的危害非常高，CVSS 评分为 9.6（Critical），已在 Appsmith 1.93 版本中修复。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3yd88ybJ23Ut4OG1IWicAtjEiaYOMqsOibUpfCwhzfNSdPychWR6GVuXGFQg/640?wx_fmt=other&from=appmsg "")  
## 漏洞影响版本  
<table><thead><tr style="box-sizing: border-box;"><th style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;font-style: normal;font-weight: bold;text-align: left;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">产品版本</span></section></th><th style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;font-style: normal;font-weight: bold;text-align: left;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">版本</span></section></th></tr></thead><tbody><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">Appsmith</span></section></td><td style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">&lt; 1.93</span></section></td></tr></tbody></table>## 环境部署  
  
在“CVE‑2026‑22794漏洞复现环境” 中运行一条命令即可部署环境。  
> “CVE‑2026‑22794漏洞复现环境” 详见文末  
  
```
docker compose up -d
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydr1mfw86VociceaibgG0DbLtg6ibBx2ItuX2ZLLhaAibwPAOZKp1XChgSaQ/640?wx_fmt=png&from=appmsg "")  
  
部署成功后访问 http://【your-ip】:8088/  
即可看到如下界面，正常安装个人版即可。  
> 注意：这里的Email填自己真实可用的邮箱，后续复现会用到  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydtKXSLCb4icu21g9knujHFIHoRic6bzrwpGOY6CXFJOjXiclgUJRwH6KIw/640?wx_fmt=png&from=appmsg "")  
  
由于复现过程会用到邮件功能，记得设置下smtp服务器  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydY41V1XlP7uLImcfxfZGDngeiacoiaO7cfBb58vRugDgDooBgicQMWicDicA/640?wx_fmt=png&from=appmsg "")  
## 漏洞复现  
  
首先在本地开启一个http服务  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3yd4tusG5bXPnmWbetAekv6D9PJqwgcHibcJ7AvZe9yYqU66m2e09U7Knw/640?wx_fmt=png&from=appmsg "")  
  
在burpsuite发送如下数据包，成功向受害者邮箱发送重置密码邮件  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydZibgRpicV0UKMCH6nKPxNnVDFvMNRJibeAFsgBRteLwzsgfYMZ10Kquiag/640?wx_fmt=png&from=appmsg "")  
  
受害者点击重置链接  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydTibfmQh2ticRM21r8JmURljq0x96Apc01eFPT14Eia7YiaUc2aC2ca4YyA/640?wx_fmt=png&from=appmsg "")  
  
我们本地的http服务收到密码重置链接  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydQ3ic0zmicQicX2gBE7B6Ouy0a3UiardrrUJtMdjJ7eFtE30CCUPCwR7pSw/640?wx_fmt=png&from=appmsg "")  
  
访问链接，修改密码  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydyib8aS0nawoxibXjLb5XgZ5OwemibDXo9lMoZks56UEguszxqE6ahCPMw/640?wx_fmt=png&from=appmsg "")  
  
利用修改过的密码成功登录后台  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydiachS4cicwgbEOJkWiaXwwkd5GUgQfsAlvU8N2WjoLHPvSSOLRvFe2FOw/640?wx_fmt=png&from=appmsg "")  
  
这里还有个问题就是当受害者点击密码重置链接时，会直接显示404，引起怀疑  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydNUtBRickjkXTGkiba5xkJpMibUvmHbuicBYuojGeLRBRuQpvEFcxH18IOw/640?wx_fmt=png&from=appmsg "")  
  
这里可以写一个重定向服务器，功能是当受害者点击密码重置链接时  
回重定向到Appsmith到首页。  
  
受害者可能觉得链接过期跳转首页，减少其怀疑。  
> 重定向服务器 详见文末 “redirect_server.py”  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3yda5T1nHAKaZ0tpZTZhmaKE4VEerwAQqwriaKgvZJ62R3iatvOx6JImWQQ/640?wx_fmt=png&from=appmsg "")  
## 漏洞分析  
  
该漏洞的核心在于 /forgotPassword  
接口中，从请求头中获取 Origin  
并且不做任何校验就使用了 Origin  
作为 baseUrl  
。攻击者可通过  
伪造请求头，将 Origin  
 设置为攻击者控制的恶意域名，从而导致系统生成的密码重置链接指向攻击者服务器。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydfscPOUuE0SNTWbUwKgpB4LzXibJHPTR7Mq6PicvjRutjzKriaWtIjM25g/640?wx_fmt=png&from=appmsg "")  
## 漏洞修复  
  
官方已发布新版本，将Appsmith升级到1.93及以上版本即可  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3yd4JJOgP8oPvPwPaPZNTxVnHB5yGfbLO0sPCgiaTSsIx5FDxtm3zMRQSw/640?wx_fmt=png&from=appmsg "")  
## 知识星球  
  
**“POC-CVE-2026-22794.txt”、“redirect_server.py”、“CVE-2026-22794漏洞复现环境”、“AppSmith任意用户密码重置漏洞复现”**  
现已全部发布至知识星球，大家可在知识星球内获取，自行学习复现。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydPrs4UFWdxx0XCibh9e7NiaibpzlmparjW32zSk9H9iaLZ4sqlJ7j2w9u5g/640?wx_fmt=png&from=appmsg "")  
> 星球加入方式见文章底部二维码，欢迎加入交流和学习  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S481GpvCbAZEQ2OxzGnZ3ydsibOagUCdGJfFtGtalPHs0eIaA41YVCyMp77SgiaflQFLzPBX0UPCFfw/640?wx_fmt=png&from=appmsg "")  
  
  
