#  CVE-2026-21440 AdonisJS框架的关键路径遍历漏洞  
星夜AI安全
                    星夜AI安全  星夜AI安全   2026-01-22 00:14  
  
📌各位可以将公众号设为星标⭐  
  
📌这样就不会错过每期的推荐内容啦~  
  
📌这对我真的很重要！  
  
![image](https://mmbiz.qpic.cn/mmbiz_png/SffY5ZO3R2lAVT6CicZmYO3GGZre7KEwxiaouHrUbg3rQ0UUVhEI7eDxct12pq4ITqI98fcU1rsJXlHib3VF1n4ew/640?wx_fmt=png&from=appmsg "image")  
  
📌1. 本平台分享的安全知识和工具信息源于公开资料及专业交流，仅供个人学习提升安全意识、了解防护手段，禁止用于任何违法活动，否则使用者自行承担法律后果。  
  
📌2. 所分享内容及工具虽具普遍性，但因场景、版本、系统等因素，无法保证完全适用，使用者要自行承担知识运用不当、工具使用故障带来的损失。  
  
📌3. 使用者在学习操作过程中务必遵守法规道德，面对有风险环节需谨慎预估后果、做好防护，若未谨慎操作引发信息泄露、设备损坏等不良后果，责任自负。  
### AdonisJS 多部分文件上传中的安全漏洞  
  
AdonisJS 在处理多部分文件上传时，错误地对用户提交的文件名给予了信任。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB0RiciacPB71jPp1iasVCRsTlPiaA1CnjlPnpSB0ACY9Pb0GXZlruLwG9iag6TnxLPK0yl8ZnhUlTAsnRw/640?wx_fmt=png&from=appmsg "")  
  
当开发者调用以下方法时：  
- MultipartFile.move()  
  
若缺乏严格的过滤机制，攻击者可能提交类似这样的文件名：  
- ../../../../app/config/startup.js  
  
通过这种方式，攻击者能够绕过预定的上传目录，将文件写入服务器上的任意位置。  
  
潜在的攻击后果包括：  
- 📂 在服务器进程拥有权限的任何位置写入任意文件  
  
- 🧨 覆盖应用程序文件或配置文件  
  
- 🖥️ 实现远程代码执行（RCE）  
  
- 🌐 此漏洞可在无需身份验证的情况下被远程利用  
  
这使得该漏洞对于公开的文件上传端点来说尤其危险。  
### 受影响版本  
- @adonisjs/bodyparser**≤ 10.1.1**  
  
- 11.x  
 分支中 **11.0.0-next.6 之前**  
 的预发布版本  
  
### 修复方案  
  
➡️ **请尽快升级**  
 到已修复此问题的版本。  
### 临时缓解措施  
  
如果暂时无法进行版本升级，可考虑以下措施：  
- 🧼 对文件名进行清理（拒绝包含 ../  
、绝对路径或空字节的文件名）  
  
- 🧩 使用 MultipartFile.move()  
 方法的安全选项  
  
- 🔒 为上传端点添加身份验证要求  
  
- 📁 限制文件系统的写入权限  
  
- 🧱 使用 Web 应用防火墙（WAF）来检测路径遍历的尝试  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB0RiciacPB71jPp1iasVCRsTlPQSDiay9YIMgxmj1wIzD2ibFic8m53IHamxw9yyCqWRnYVU7Bkjql7w8kg/640?wx_fmt=png&from=appmsg "")  
  
关注微信公众号后台回复**入群**  
 即可加入星夜AI安全交流群  
  
## 圈子介绍  
  
现任职于某头部网络安全企业攻防研究部，核心红队成员。2021-2023年间累计参与40+场国家级、行业级攻防实战演练，精通漏洞挖掘、红蓝对抗策略制定、恶意代码分析、内网横向渗透及应急响应等技术领域。在多次大型演练中，主导突破多个高防护目标网络，曾获“最佳攻击手”“突出贡献个人”等荣誉。  
  
已产出的安全工具及成果包括：  
- 多款主流杀软通杀工具（兼容卡巴斯基、诺顿、瑞星、360等终端防护）  
  
- 内网穿透套件（适配多层路由、隔离网络环境的隐蔽流量转发）  
  
- 权限维持工具集（含注册表、系统服务、进程隐藏等多维持久化方案）  
  
- 哥斯拉/冰蝎定制化马生成器（绕过主流终端防护与EDR动态检测）  
  
- 浏览器凭证窃取工具（支持Chrome/Edge/Firefox等主流浏览器数据提取）  
  
- 二开fscan内网扫描工具（增强指纹精度、弱口令爆破与结果标准化输出）  
  
- 多款免杀Webshell集合（覆盖PHP/JSP/ASPX，过主流WAF与终端防护）  
  
- 免杀360专属加载器（支持Shellcode内存执行，绕过360全系防护检测）  
  
后续将不断更新到内部圈子中 欢迎加入圈子 ![image](https://mmbiz.qpic.cn/mmbiz_jpg/SffY5ZO3R2krPdiaNgcSCqIWicvYpFwAA7FE1OiakOmrjja9AwwXl1WnW18bKaykVfzXKCz7PVBmiaLI5JRZYncJMQ/640?wx_fmt=jpeg&from=appmsg&watermark=1&wxfrom=5&wx_lazy=1&tp=webp#imgIndex=6 "image")  
  
  
