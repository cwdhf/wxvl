#  CVE-2026-21440 AdonisJS框架的关键路径遍历漏洞  
 TtTeam   2026-01-21 00:48  
  
AdonisJS 在多部分文件上传过程中错误地信任用户提供的文件名。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB0RiciacPB71jPp1iasVCRsTlPiaA1CnjlPnpSB0ACY9Pb0GXZlruLwG9iag6TnxLPK0yl8ZnhUlTAsnRw/640?wx_fmt=png&from=appmsg "")  
  
当开发人员调用时：  
  
```
MultipartFile.move()
```  
  
  
如果没有严格的过滤措施，攻击者可以提交如下文件名：  
```
../../../../app/config/startup.js
```  
  
这样一来，它们就可以绕过预定的上传目录，将文件写入服务器上的任意位置。  
  
攻击者可能：  
  
📂在服务器进程拥有权限的任何位置写入任意文件  
  
🧨覆盖应用程序文件或配置文件  
  
🖥️实现远程代码执行（RCE）  
  
🌐无需身份验证即可远程利用此漏洞  
  
这使得该漏洞对公共文件上传端点尤其危险。  
###  易受攻击  
- @adonisjs/bodyparser  
 **≤ 10.1.1**  
  
- 11.x11.0.0-next.6 之前的预发布版本  
### 🔐 立即修复  
  
➡️尽快**升级**到已修复的版本。****  
### 🧯 临时缓解措施  
  
如果目前还无法升级：  
- 🧼 清理文件名（拒绝../绝对路径、空字节）  
- 🧩 使用安全选项MultipartFile.move()  
- 🔒 上传端点需要身份验证  
- 📁 限制文件系统写入权限  
- 🧱 使用 WAF 检测路径遍历尝试  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB0RiciacPB71jPp1iasVCRsTlPQSDiay9YIMgxmj1wIzD2ibFic8m53IHamxw9yyCqWRnYVU7Bkjql7w8kg/640?wx_fmt=png&from=appmsg "")  
  
  
  
