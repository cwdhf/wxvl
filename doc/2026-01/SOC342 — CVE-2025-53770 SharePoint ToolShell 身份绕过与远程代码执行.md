#  SOC342 â€” CVE-2025-53770 SharePoint ToolShell èº«ä»½ç»•è¿‡ä¸è¿œç¨‹ä»£ç æ‰§è¡Œ  
haidragon
                    haidragon  å®‰å…¨ç‹—çš„è‡ªæˆ‘ä¿®å…»   2026-01-16 02:10  
  
# å®˜ç½‘ï¼šhttp://securitytech.cc/  
  
****  
**å‘Šè­¦åç§°ï¼š**  
Â SOC342 â€” CVE-2025-53770 SharePoint ToolShell Auth Bypass and RCE  
**ä¸¥é‡çº§åˆ«ï¼š**  
Â Criticalï¼ˆä¸¥é‡ï¼‰  
**äº‹ä»¶ IDï¼š**  
Â 320  
**äº‹ä»¶æ—¶é—´ï¼š**  
Â 2025-07-22 13:07  
**åˆ†ç±»ï¼š**  
Â Web æ”»å‡» / è¿œç¨‹ä»£ç æ‰§è¡Œ  
## ğŸ“‹ Play Book  
  
æŒ‰ Enter æˆ–ç‚¹å‡»æŸ¥çœ‹å¤§å›¾  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHibqD7a7lCOd8sR5cRQh4IWzFQakTnfx8zbLpd5mx4Cp0cGZWDzVFCibQ/640?wx_fmt=png&from=appmsg "")  
## 1ï¸âƒ£ å‘Šè­¦æ¦‚è§ˆï¼ˆAlert Overviewï¼‰  
  
åœ¨Â **SharePoint01**  
Â ä¸Šè§¦å‘äº†ä¸€æ¡ä¸¥é‡ Web æ”»å‡»å‘Šè­¦ï¼ŒåŸå› æ˜¯æ£€æµ‹åˆ°ä¸€ä¸ª**æœªè®¤è¯çš„ POST è¯·æ±‚**  
è®¿é—® SharePoint ç«¯ç‚¹Â ToolPane.aspx  
ã€‚  
  
è¯¥ç«¯ç‚¹å­˜åœ¨Â **CVE-2025-53770ï¼ˆToolShellï¼‰**  
Â æ¼æ´ï¼Œè¿™æ˜¯ä¸€ä¸ªé›¶æ—¥æ¼æ´ï¼Œå¯è®©æ”»å‡»è€…**ç»•è¿‡è®¤è¯å¹¶åœ¨æœ¬åœ° SharePoint æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç **  
ã€‚  
  
è¯¥è¯·æ±‚æ¥è‡ª**å¤–éƒ¨ IP åœ°å€**  
ï¼Œä¸”è¢«å®‰å…¨è®¾å¤‡æ”¾è¡Œï¼Œå¤§å¤§å¢åŠ äº†è¢«æˆåŠŸåˆ©ç”¨å’Œç³»ç»Ÿæ²¦é™·çš„é£é™©ã€‚  
  
æŒ‰ Enter æˆ–ç‚¹å‡»æŸ¥çœ‹å¤§å›¾  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHHnACbPTfibny9EY5uMHibia3X5HibnfH1icFXPPNT02GTsJM2BGFGA5Jplg/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpH0wxsgCtMmiaLgaibcFBk1B5mKgQ1qicX38DkYykxnudsQ75IM8sRwbwFA/640?wx_fmt=png&from=appmsg "")  
## ğŸš¨ å‘Šè­¦è§¦å‘åŸå› ï¼ˆWhy This Alert Was Triggeredï¼‰  
  
SOC342 è§„åˆ™ç”¨äºæ£€æµ‹Â **ToolShell**  
Â å¯¹ SharePointÂ ToolPane.aspx  
Â çš„åˆ©ç”¨è¡Œä¸ºã€‚  
  
è§¦å‘åŸå› åŒ…æ‹¬ï¼š  
- ç›´æ¥è®¿é—®**é«˜æƒé™ SharePoint Layout ç«¯ç‚¹**  
  
- æœªè®¤è¯æƒ…å†µä¸‹ä½¿ç”¨Â **POST**  
  
- **è¯·æ±‚ä½“è¿‡å¤§ï¼ˆ7699 å­—èŠ‚ï¼‰**  
ï¼Œä¸ç¬¦åˆæ­£å¸¸è¡Œä¸º  
  
- ä¼ªé€  Refererï¼š/SignOut.aspx  
  
- æµé‡ç‰¹å¾åŒ¹é…å·²çŸ¥ ToolShell æ”»å‡»æŠ€æœ¯  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHxOOfb1h0yP0bYutiac929jBPUkuPIZpqTkibMwN9qC7ibDVBDL8Bhc3DQ/640?wx_fmt=png&from=appmsg "")  
  
è¿™äº›è¿¹è±¡å¼ºçƒˆè¡¨æ˜è¿™æ˜¯ä¸€æ¬¡**çœŸå®åˆ©ç”¨è¡Œä¸º**  
ï¼Œè€Œä¸æ˜¯æ­£å¸¸è®¿é—®ã€‚  
## ğŸŒ IP ä¿¡èª‰æ£€æŸ¥ï¼ˆIP Reputation Checkï¼‰  
### æº IPï¼š107.191.58.76  
- å¤–éƒ¨å…¬ç½‘ IP  
  
- éå†…éƒ¨åŸºç¡€è®¾æ–½  
  
- ç”¨ä½œæ”»å‡»è½½è·æ‰˜ç®¡æœåŠ¡å™¨  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHMTNyHqkjO4Cg7743WH6U48OiaX22j4q9ETaD4pc5a7zqKCWglNjdW1Q/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHLhkeTRVAIW11z9Cib7v1V2liaaC4VfXHjvnx0VHglibxSdzNAkT7uNkeA/640?wx_fmt=png&from=appmsg "")  
### ç›®æ ‡ IPï¼š172.16.20.17  
- å†…éƒ¨ SharePoint æœåŠ¡å™¨  
  
- å¯¹å¤– HTTPS(443) æœåŠ¡  
  
æ²¡æœ‰ä»»ä½•åˆç†ä¸šåŠ¡ç†ç”±å…è®¸è¯¥è¿æ¥ã€‚  
## ğŸ“… è®¡åˆ’æ´»åŠ¨éªŒè¯ï¼ˆPlanned Activity Verificationï¼‰  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHicmZr5Jialt1kvyq25HEKkicev8Abu94h6Xkofv9rYQCKkfDezOibWH1VA/640?wx_fmt=png&from=appmsg "")  
- å½“æ—¶æ²¡æœ‰æ‰¹å‡†çš„æ¸—é€æµ‹è¯•  
  
- æ²¡æœ‰ç»´æŠ¤çª—å£  
  
- IP ä¸å±äºå®‰å…¨å‚å•†  
  
- è¡Œä¸ºä¸åƒæ­£å¸¸ç®¡ç†æ“ä½œ  
  
ğŸ‘‰ ç»“è®ºï¼š**è¿™æ˜¯ä¸€æ¬¡æœªæˆæƒæ”»å‡»ã€‚**  
## âš” æ”»å‡»ç±»å‹åˆ†ç±»ï¼ˆAttack Type Classificationï¼‰  
- æ”»å‡»ç±»å‹ï¼šWeb åº”ç”¨æ”»å‡»  
  
- åˆ©ç”¨æ–¹å¼ï¼šèº«ä»½ç»•è¿‡ â†’ RCE  
  
- å‘é‡ï¼šæœªè®¤è¯ POST  
  
- ç›®æ ‡ç»„ä»¶ï¼šToolPane.aspx  
  
- ç›®çš„ï¼šåˆå§‹è®¿é—®ã€æ‰§è¡Œä»£ç ã€å»ºç«‹æŒä¹…åŒ–  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHuxBUp0wDIt0cAqkOLkbHnAkMfnHoDguvMmOian67vUNrXxp2wgZ9nuw/640?wx_fmt=png&from=appmsg "")  
  
è¿™ç±»æ”»å‡»å…è®¸ï¼š  
- æ‰§è¡Œç³»ç»Ÿå‘½ä»¤  
  
- æŠ•æ”¾ WebShell  
  
- çªƒå– SharePoint åŠ å¯†å¯†é’¥  
  
## ğŸ‘¤ ç”¨æˆ·ä¸è¡Œä¸ºå®¡æŸ¥ï¼ˆUser and Activity Reviewï¼‰  
- éå†…éƒ¨ç”¨æˆ·  
  
- æ— åˆæ³•ä¼šè¯  
  
- ä¸å±äºç®¡ç†æ“ä½œ  
  
- æ— ç»´æŠ¤è®¡åˆ’  
  
ğŸ‘‰ ç¡®è®¤ä¸ºæ”»å‡»æµé‡ã€‚  
## ğŸ–¥ ç³»ç»Ÿåˆ†æï¼ˆSystem Analysisï¼‰  
  
å‘ç°ç³»ç»Ÿæ‰§è¡Œäº†å¯ç–‘å‘½ä»¤ï¼Œåº”ç«‹å³éš”ç¦»ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHGV93XyY8llvYJSQTSC9mts6m8TIJVAJH9vo6C5ib0Blyct8dn2FhE4w/640?wx_fmt=png&from=appmsg "")  
## ğŸ” å‘½ä»¤åˆ†æï¼ˆCommand Analysisï¼‰  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHU0z3AB3zGWlibN7qdAzB4UOf4h1Cicq9AHibcpkhicHILcAIG7sk8RACuw/640?wx_fmt=png&from=appmsg "")  
  
å‘ç° Base64 PowerShellï¼š  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHZRdZlhVlFIu5F4b1aRpCJQ8rVr2A0tcYQYL7ibaE12xEiasAibErcexmw/640?wx_fmt=png&from=appmsg "")  
  
è¯¥å‘½ä»¤ï¼š  
- éšè—çª—å£  
  
- ç¦ç”¨ profile  
  
- æ‰§è¡Œç¼–ç  payload  
  
è§£ç åï¼š  
- åŠ è½½ System.Web  
  
- è¯»å– SharePoint MachineKey  
  
- è·å– ValidationKey / DecryptionKey  
  
ğŸ‘‰ æ‹¿åˆ° MachineKey å¯ä¼ªé€  ViewStateï¼Œé•¿æœŸæ§åˆ¶ç³»ç»Ÿã€‚  
```
"C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe"Â /out:C:\Windows\Temp\payload.exe C:\Windows\Temp\payload.cs
```  
  
è¯¥å‘½ä»¤åœ¨å—å®³æœºä¸Šç¼–è¯‘æ”»å‡»è€… C# ç¨‹åºï¼Œç»•è¿‡æ€è½¯å¹¶ç”Ÿæˆä¸“ç”¨æœ¨é©¬ã€‚  
  
ğŸ‘‰ è¯´æ˜æ”»å‡»è€…å·²å®Œå…¨æ‰§è¡Œä»£ç ã€‚  
```
cmd.exe /c echo <form runat=\"server\"> ... > ...\spinstall0.aspx
```  
  
è¯¥å‘½ä»¤ï¼š  
- åœ¨Â _layouts  
Â ä¸‹å†™å…¥æ¶æ„ ASPX  
  
- ä»å¤–éƒ¨ä¸‹è½½ payload.exe  
  
- å»ºç«‹ WebShell æŒä¹…åŒ–  
  
ğŸ‘‰ æ”»å‡»è€…è·å¾—é•¿æœŸè®¿é—®èƒ½åŠ›ã€‚  
```
powershell.exe -CommandÂ "[System.Web.Configuration.MachineKeySection]::GetApplicationConfig()"
```  
  
ç›´æ¥è¯»å–ï¼š  
- ValidationKey  
  
- DecryptionKey  
  
- ç®—æ³•é…ç½®  
  
ğŸ‘‰ å¯ä¼ªé€ è®¤è¯æ•°æ®ã€‚  
## ğŸ§­ MITRE ATT&CK æ˜ å°„  
### Initial Access  
- T1190 â€” åˆ©ç”¨å…¬ç½‘åº”ç”¨  
  
### Execution  
- T1059.001 â€” PowerShell  
  
### Persistence  
- T1505.003 â€” WebShell  
  
### Credential Access  
- T1552.004 â€” åº”ç”¨é…ç½®  
  
### Defense Evasion  
- T1027 â€” Base64 æ··æ·†  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHKj58PtCCZV9LyibuQiavjsKHAk3ia7ILv0HBib9ia0jhpq7QUfWYgiaPKKaA/640?wx_fmt=png&from=appmsg "")  
## ğŸ“Š å½±å“è¯„ä¼°ï¼ˆImpactï¼‰  
- èº«ä»½ç»•è¿‡ âœ…  
  
- RCE âœ…  
  
- WebShell âœ…  
  
- æœåŠ¡å™¨æ²¦é™· âœ…  
  
- ä¸šåŠ¡å½±å“ï¼šé«˜  
  
ğŸ‘‰ SharePoint å¿…é¡»è§†ä¸º**å·²å¤±é™·**  
ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHliaag0bFhOWVCzChSo4RlAzSt86oLT7ybShWzrnaMpoM7GQw5FMwNhA/640?wx_fmt=png&from=appmsg "")  
## ğŸ§¾ å–è¯è¦ç´ ï¼ˆArtifactsï¼‰  
### æ–‡ä»¶  
- spinstall0.aspx  
  
- payload.exe  
  
- payload.cs  
  
### è¿›ç¨‹  
- powershell.exe  
  
- csc.exe  
  
- cmd.exe  
  
- w3wp.exe  
  
### ç½‘ç»œ  
- 107.191.58.76  
  
- http://107.191.58.76/payload.exe  
  
### åº”ç”¨  
- MachineKey  
  
- ToolPane.aspx  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHtC5XnMLev632IMeC2CvBzRUG33QCVAK0hRm4poUygwibparia24T8eDQ/640?wx_fmt=png&from=appmsg "")  
## âœ… æœ€ç»ˆè£å®šï¼ˆFinal Verdictï¼‰  
  
**True Positive â€” æ¶æ„æ”»å‡»ç¡®è®¤**  
  
è¯¥å‘Šè­¦ç¡®è®¤æ˜¯Â **CVE-2025-53770 ToolShell**  
Â è¢«æˆåŠŸåˆ©ç”¨ï¼Œé€ æˆï¼š  
  
âœ… èº«ä»½ç»•è¿‡  
  
âœ… è¿œç¨‹ä»£ç æ‰§è¡Œ  
  
âœ… SharePoint æœåŠ¡å™¨å®Œå…¨æ²¦é™·  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHeQqyvpLXGy2NItNrBkLpHg0UvwJRZjYbGJzbUTrYCqQJg4Ul1weme5g5wCMaAxk56hUbESoUIOg/640?wx_fmt=png&from=appmsg "")  
  
****- å…¬ä¼—å·:å®‰å…¨ç‹—çš„è‡ªæˆ‘ä¿®å…»  
  
- vx:2207344074  
  
- http://  
gitee.com/haidragon  
  
- http://  
github.com/haidragon  
  
- bilibili:haidragonx  
  
##   
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_jpg/vBZcZNVQERGbHa05YTPGtAh0bsc9uicnYlTLHq6quxc5zcULCC9v7LVO9e1sIBI1QvrbezQdwTY9jMH66Z5eAvg/640?wxfrom=5&wx_fmt=jpg&watermark=1&wx_lazy=1&tp=webp#imgIndex=34 "")  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHYgfyicoHWcBVxH85UOBNaPZeRlpCaIfwnM0IM4vnVugkAyDFJlhe1Rkalbz0a282U9iaVU12iaEiahw/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&randomid=z84f6pb5&tp=webp#imgIndex=5 "")  
  
****- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHYgfyicoHWcBVxH85UOBNaPMJPjIWnCTP3EjrhOXhJsryIkR34mCwqetPF7aRmbhnxBbiaicS0rwu6w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&randomid=omk5zkfc&tp=webp#imgIndex=5 "")  
  
