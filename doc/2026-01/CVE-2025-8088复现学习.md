#  CVE-2025-8088复现学习  
原创 MicroPest
                        MicroPest  MicroPest   2026-01-25 10:21  
  
**CVE-2025-8088****(CVSS 8.4)** 是一个新的高风险路径遍历漏洞 [CWE-35  
] 在 WinRAR 7.12 及以下版本和相关组件包括 UnRAR.dll 中存在漏洞。该漏洞允许未经授权的攻击者将恶意文件复制到敏感目录，包括 Windows 启动文件夹，从而可以执行这些文件。  
  
这又是一个关于winrar漏洞的CVE，我记得在前面7月份复现学习了一个《[CVE-2025-6218 Poc复现及1Day研究](https://mp.weixin.qq.com/s?__biz=MjM5NDcxMDQzNA==&mid=2247489743&idx=1&sn=48f097e5b2792e8b696abd83ed3b00a0&scene=21#wechat_redirect)  
》，也是winrar的，针对的版本是7.11，而这个8088针对的是7.12。半年时间连续发现2个遍历漏洞，winrar也是备受黑客的青睐。  
  
一、检测winrar版本  
  
先上一段ps1的代码，  
  
# Detects exposure to CVE-2025-8088 based on WinRAR.  
  
# Vulnerable: WinRAR < 7.13   (Patched: 7.13+)   
  
Set-StrictMode -Version Latest  
  
$ErrorActionPreference = 'Stop'  
  
function info { param([string]$m) Write-Host "[i] $m" }  
  
function good { param([string]$m) Write-Host "[+] $m" -ForegroundColor Green }  
  
function bad  { param([string]$m) Write-Host "[-] $m" -ForegroundColor Red }  
  
$fixedVersion = [version]'7.13.0'  
  
# Common install locations  
  
$candidates = @(  
  
  "$env:ProgramFiles\WinRAR\WinRAR.exe",  
  
  "${env:ProgramFiles(x86)}\WinRAR\WinRAR.exe"  
  
) | Where-Object { $_ -and (Test-Path $_) }  
  
if (-not $candidates) {  
  
  $cmd = Get-Command 'WinRAR.exe' -ErrorAction SilentlyContinue  
  
  if ($cmd) { $candidates = @($cmd.Source) }  
  
}  
  
if (-not $candidates) {  
  
  info "WinRAR not found. Nothing to check."  
  
  return  
  
}  
  
$entries = foreach ($p in $candidates) {  
  
  $v = (Get-Command $p).FileVersionInfo.ProductVersion  
  
  [pscustomobject]@{ Path = $p; Version = $v; V = [version]$v }  
  
}  
  
$winrar = $entries | Sort-Object V -Descending | Select-Object -First 1  
  
info ("WinRAR path: " + $winrar.Path)  
  
info ("WinRAR version: " + $winrar.Version)  
  
if ($winrar.V -lt $fixedVersion) {  
  
  bad  "CVE-2025-8088 IS exploitable (WinRAR < 7.13)."  
  
} else {  
  
  good "CVE-2025-8088 is NOT exploitable (WinRAR >= 7.13)."  
  
}  
  
检测结果如图：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/2hnvgPYNzpILc4w1gatufzUlFKQ6uohrLh853TVwFI53XaBPuLBibZze8tR27ElxZn6lsuT2VDPicibuHp72DnWIQ/640?wx_fmt=png&from=appmsg "")  
  
说明我们的版本是7.12，以及winrar所在的路径位置；或者查看winrar版本，  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/2hnvgPYNzpILc4w1gatufzUlFKQ6uohrD2n26FsQtias5jPv3ic29AHznzZXYA63p7lwEz8pRKicPpHV3e42fKBOQ/640?wx_fmt=png&from=appmsg "")  
  
二、复现过程  
  
1、Exploit video:  
  
  
2、PoC-Exploit：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/2hnvgPYNzpILc4w1gatufzUlFKQ6uohrR7fFTHCzECHpibhVTf1nnLq80Aia4SzcKSeGpaICYAJcib1KQT8b3icaicA/640?wx_fmt=gif&from=appmsg "")  
  
3、poc下载  
  
https://github.com/sxyrxyy/CVE-2025-8088-WinRAR-Proof-of-Concept-PoC-Exploit-?tab=readme-ov-file  
  
4、举例  
  
（1）构建命令，  
python poc.py --decoy clib.txt --payload run_decode.bat --drop "C:\Users\Administrator\Desktop\CVE-2025-8088-WinRAR-PoC-Exploit" --rar "C:\Program Files\WinRAR\rar.exe"  
  
（2）参数含义：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/2hnvgPYNzpILc4w1gatufzUlFKQ6uohrmo1oumR7Pl10Z3QqxcoRLIySPsiczC2wYiaIPM79iavca2mcficJ1YLk0A/640?wx_fmt=png&from=appmsg "")  
## 该命令的实际效果  
  
此命令将创建一个恶意RAR文件，其攻击流程如下：  
1. **读取文件**  
：  
  
1. 诱饵：clib.txt  
（需存在于当前目录）  
  
1. 载荷：run_decode.bat  
（需存在于当前目录）  
  
1. **NTFS流附加**  
：  
  
1. 将run_decode.bat  
作为**交替数据流(ADS)**  
附加到clib.txt  
上  
  
1. 流名称初始化为128字节的占位符（如XXXXXXXX...  
）  
  
1. **生成基础RAR**  
：  
  
1. 调用WinRAR生成包含clib.txt  
及其ADS流的普通RAR5文件  
  
1. **二进制补丁**  
：  
  
1. 在RAR头部搜索占位符字符串  
  
1. **替换为路径遍历字符串**  
：..\..\..\...（16层）\Desktop\CVE-2025-8088...\run_decode.bat  
  
1. **CRC32修复**  
：  
  
1. 重新计算所有RAR块头的CRC32校验和，确保文件格式合法  
  
1. **输出文件**  
：  
  
1. 默认生成：cve-2025-8088-sxy-poc.rar  
  
1. 中间文件：cve-2025-8088-sxy-poc.base.rar  
（生成后自动删除）  
  
## 攻击后果  
  
当受害者使用**存在漏洞的WinRAR版本**  
解压时：  
- 表面上看：只解压出clib.txt  
  
- 实际上：run_decode.bat  
会被释放到：  
C:\Users\Administrator\Desktop\CVE-2025-8088-WinRAR-PoC-Exploit\run_decode.bat  
（3）生成攻击rar  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/2hnvgPYNzpILc4w1gatufzUlFKQ6uohrxQbYZWDvpwZLChicoCfIu3vtzejcdFb2lAxUhl4rHHphGiappEHhXJNw/640?wx_fmt=png&from=appmsg "")  
  
通过7z l -sns来  
检查生成的rar，  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/2hnvgPYNzpILc4w1gatufzUlFKQ6uohr4KzNvlqZLGvNEqHxXYVlKr1Z708COQj2LDBBicgC0mkc4EzzT1hDvGA/640?wx_fmt=png&from=appmsg "")  
  
这里的载荷文件是run_decode.bat；  
  
或者 NtfsStreamEditor 来查看，  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/2hnvgPYNzpILc4w1gatufzUlFKQ6uohrUGHCzTlia2qEk5Phm6AJG6oVHmn1UzIpu2F6IibLYiaw1fHra21YKwRQA/640?wx_fmt=png&from=appmsg "")  
  
直接出来了ADS中包含的启动载荷run_decode.bat的内容。  
  
（4）互联网中公布的利用  
  
我们再来看一个更为明显的载荷，hta启动  
  
![图像](https://mmbiz.qpic.cn/sz_mmbiz_jpg/2hnvgPYNzpILc4w1gatufzUlFKQ6uohrrfDeJ6TfDHnWpU47mgkxXPC9dIEJBNghsRR1cSdqlNicS0iaPsiagx5kA/640?wx_fmt=jpeg&from=appmsg "")  
![]( "")  
  
顺便借用个攻击链过程图，  
  
![图像](https://mmbiz.qpic.cn/sz_mmbiz_jpg/2hnvgPYNzpILc4w1gatufzUlFKQ6uohr6jd4PYyeua1NEJUqmdZcL0yGqyLOgf6ibnbHjf03aV0RRKQo2H8UoDQ/640?wx_fmt=jpeg&from=appmsg "")  
![]( "")  
  
可以看到通过“恶意邮件：附件-->CVE-2025-8088-->释放恶意HTA载荷文件-->连接下载服务器-->下载后续载荷文件-->连接C2服务器”。  
  
5、winrar解压缩的表现特征  
  
这里借用网上的恶意文件。用winrar解压，  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/2hnvgPYNzpILc4w1gatufzUlFKQ6uohrABEOMiaH9WtBkJ2ibmjTCLrsickqPUYqKIX8Afn7ySKUEp1PRGSWr0Cyg/640?wx_fmt=png&from=appmsg "")  
  
这时，报错。将这段内容复制出来，粘贴到文本中，再看下，  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/2hnvgPYNzpILc4w1gatufzUlFKQ6uohrZmQ8eOHe4qFQz3Q0vq90hXzGUic0JWGsnSLME62uFSAxRgpGX1TRP4A/640?wx_fmt=png&from=appmsg "")  
  
完整的就是不一样了，出现了“  
Bang_Luong_Thang_11_2025.csv:..\..\..\..\..\..\..\..\Users\sosona\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\Update.exe  
”  
  
  
6、改造poc.py  
  
以下是修改 poc.py 的代码建议，它会在生成 RAR 文件后，为其附加一个模拟的 Zone.Identifier ADS 流。  
  
修改说明：  
  
（1）. 新增 attach_motw 函数，用于创建 Zone.Identifier 流。  
  
（2）. 在 main 函数最后调用该函数，为输出的 RAR 文件添加 ADS。  
  
def  
  
attach_motw  
(  
path  
: Path):  
  
      
"""Attach Zone.Identifier to mimic a downloaded file (ZoneId=3)."""  
  
    motw   
=  
 textwrap.dedent(  
"""  
\  
  
        [ZoneTransfer]  
  
        ZoneId=3  
  
        HostUrl=about:internet  
  
        """  
)  
  
      
try  
:  
  
          
with  
  
open  
(  
f  
"  
{  
path  
}  
:Zone.Identifier"  
,   
"w"  
)   
as  
 f:  
  
            f.write(motw)  
  
          
print  
(  
f  
"[+] Attached Zone.Identifier (Mark of the Web) to   
{  
path  
}  
"  
)  
  
      
except  
  
Exception  
  
as  
 e:  
  
          
print  
(  
f  
"[-] Failed to attach MOTW:   
{  
e  
}  
"  
)  
  
  
应用上述修改后，再次运行 PoC 脚本生成的 RAR 文件将会在文件系统层面拥有一个 Zone.Identifier ADS 流，这有助于模拟真实的攻击场景（即通过网络下载的恶意文件）。  
  
  
如果想验证修改后的效果，可以在运行脚本后使用 PowerShell 命令 Get-Item -Path cve-2025-8088-sxy-poc.rar -Stream * 查看是否成功添加了 ADS 流。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/2hnvgPYNzpILc4w1gatufzUlFKQ6uohr4TcVibp0VdOfFmQQ0thibpibAPHLXWhlvhQC21EywkwIU1HSLCoDAoJwA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/2hnvgPYNzpILc4w1gatufzUlFKQ6uohr7qXWobHwreYUg76j4Eic9J8Ifypct7hCKorDfmyv98bjDP6HxM9Y30g/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/2hnvgPYNzpILc4w1gatufzUlFKQ6uohrQnEu5eQyt8YMXiaEWsfK0Ax881IA8shaxsvk4UiabaMia0vre275IqTkA/640?wx_fmt=png&from=appmsg "")  
  
  
三、总结  
  
1、CVE-2025-8088针对是7.13以下版本的winrar，危害性很大，各位网友赶快升级到最新版本7.13；  
  
2  
、通过上面的“检测与复现”，了解该漏洞的构造、传播过程以及  
ADS 将恶意二进制文件隐藏起来，使其无法被随意检查和一些传统的安全工具发现，从而延迟了检测。同时，我们分享了两种  
检测ADS流的方法，并改造poc.py使其更加具备生成的文件  
Zone.Identifier ADS 流  
；  
  
3、我们本文为漏洞复现，内容非常详细，网上还未看到相关文章，复现分析是为了更好地防范攻击，  
一定不要用于危害活动，否则  
跟本人无关。  
  
  
