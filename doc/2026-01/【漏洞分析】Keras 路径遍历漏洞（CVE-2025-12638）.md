#  【漏洞分析】Keras 路径遍历漏洞（CVE-2025-12638）  
原创 whoami0002
                        whoami0002  SecurityPaper   2026-01-20 01:58  
  
⚠️   
免责声明：本公众号所涉任何技术、工具及信息均严禁用于非法用途。任何个人或组织因违规使用而产生的一切法律后果及连带责任均由其自行承担，本公众号及作者概不负责  
  
  
文章首发于先知社区：  
https://xz.aliyun.com/news/91112  
### 前言  
  
Keras 3 是一个多后端深度学习框架，支持 JAX、TensorFlow、PyTorch 和 OpenVINO（仅用于推理）。它可以轻松构建和训练用于计算机视觉、自然语言处理、音频处理、时间序列预测、推荐系统等领域的模型。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/iazag5vDeG2eCCjGRtym2ibfQUY96WPvcHKLibJf5mbFT8n2IvSU8liaqHjvdnLguBc8IIia6RWXxAqfqA1jcVRRAow/640?wx_fmt=png&from=appmsg "")  
  
### 漏洞概述  
  
Keras 3.11.3 版本在提取 tar 归档文件时，其 keras.utils.get_file() 函数存在路径遍历漏洞。该漏洞的产生是由于该函数使用了 Python 的 tarfile.extractall() 方法，但缺少安全关键参数 filter='data'。尽管 Keras 尝试使用 filter_safe_paths() 过滤不安全路径，但此过滤操作发生在提取之前，而提取过程中会触发一个 PATH_MAX 符号链接解析漏洞。该漏洞会导致符号链接解析因路径长度限制而失败，从而绕过安全机制，允许将文件写入预期提取目录之外。这可能导致缓存目录之外的任意文件写入，进而造成系统安全漏洞或恶意代码执行。该漏洞会影响使用 get_file() 处理 tar 归档文件的 Keras 安装，但不会影响使用适当过滤器参数保护此提取方法的版本。  
### 漏洞分析/复现  
#### 漏洞分析  
  
keras.utils.getfile调用了extract_archive  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/iazag5vDeG2eCCjGRtym2ibfQUY96WPvcHpq2KNKsmB50XIK1GnSXsa5YtdibdaLGiaLyLgicAnJ61mIk8iaZicxQewlg/640?wx_fmt=png&from=appmsg "")  
  
使用python tarfile.extractall() 方法，但是没有配置filter="data" 参数  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/iazag5vDeG2eCCjGRtym2ibfQUY96WPvcHo65zsFY61ZJxibicSAXLajNqHwLau6rsibgjTqib2BpgYKPFRVtlydaEMQ/640?wx_fmt=png&from=appmsg "")  
  
虽然使用了filter_safe_paths进行过滤  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/iazag5vDeG2eCCjGRtym2ibfQUY96WPvcHTegj9Hf2luJcgA5AowibBX0YJgJGyFLxQuvc9Vo6HTVcJXibPzBZFAGA/640?wx_fmt=png&from=appmsg "")  
  
PATH_MAX 符号链接解析错误发生在路径过滤之前，于是可以绕过检查  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/iazag5vDeG2eCCjGRtym2ibfQUY96WPvcHo65zsFY61ZJxibicSAXLajNqHwLau6rsibgjTqib2BpgYKPFRVtlydaEMQ/640?wx_fmt=png&from=appmsg "")  
#### 漏洞复现  
  
使用pip安装相关依赖  
```
```  
  
搭建一个测试场景，平台允许用户上传测试数据集，通过处理数据集时触发漏洞  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/iazag5vDeG2eCCjGRtym2ibfQUY96WPvcHWEYaJOHZ7ngicTz6w8e7IG3AOgzSouC9BQAqGyOPuwqM7cF0A1Fjo2A/640?wx_fmt=png&from=appmsg "")  
```
```  
```
```  
  
创建恶意文件  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/iazag5vDeG2eCCjGRtym2ibfQUY96WPvcHY5uj5C6TmJiaziblvnGdRdcxiaPZRdyUcNCr2O78aFicicQ5XPQY6wdzWOQ/640?wx_fmt=png&from=appmsg "")  
  
上传恶意文件  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/iazag5vDeG2eCCjGRtym2ibfQUY96WPvcHE8UfiahSLC19BickcibKCbcibYic4cgxv5TD4Gl0SQ9oHg6TV0qicRExQZhw/640?wx_fmt=png&from=appmsg "")  
  
当点击处理数据集时会调用getfile来处理，从而触发漏洞，成功写入文件  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/iazag5vDeG2eCCjGRtym2ibfQUY96WPvcHoJaG6prpfhITuiaj1I1icibWL7MTQgoUpbNVib2kpHLjBBkxJrsf58xEwg/640?wx_fmt=png&from=appmsg "")  
### 引用  
  
https://huntr.com/bounties/f94f5beb-54d8-4e6a-8bac-86d9aee103f4  
#### 想深入学习安全技术？  
  
欢迎加入我们的  
**安全技术知识星球**  
！  
  
在这里，你可以：  
- 🔥   
**第一时间**  
获取最新的安全漏洞和攻击技术分析  
  
- 📚   
**系统学习**  
从基础到高级的安全攻防知识  
  
- 💡   
**实战案例**  
分享真实的渗透测试和漏洞挖掘经验  
  
- 🤝   
**技术交流**  
与安全大牛和同行深度讨论  
  
- 🎯   
**工具分享**  
获取各种安全工具的详细使用教程  
  
- 📖   
**独家资料**  
包括漏洞报告、技术文档、学习路线图  
  
**限时优惠**  
：前 100 名加入的伙伴，享受特别价格！  
  
安全技术日新月异，只有持续学习才能跟上节奏。加入我们，一起在安全路上成长！🚀  
####   
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/iazag5vDeG2eaxibeBNfPejSVIBK5HheVWVVbt63jOoa2qt4rP1yeWqL0fm2f26zNQTR0mDaKoDgjYyelLJPweIw/640?wx_fmt=jpeg "")  
  
[【已复现】jsPDF 本地文件包含/路径遍历 (CVE-2025-68428)](https://mp.weixin.qq.com/s?__biz=MzkwMDA5OTc0Mg==&mid=2247484240&idx=1&sn=4e68a176481fe4826c59368bd1af1e00&scene=21#wechat_redirect)  
  
  
[【已复现】MongoDB 未授权内存泄露漏洞（CVE-2025-14847）](https://mp.weixin.qq.com/s?__biz=MzkwMDA5OTc0Mg==&mid=2247484007&idx=1&sn=a4c572b1bf5d2bcd3c3f5e04a1ed6662&scene=21#wechat_redirect)  
  
  
[【已复现】CVE-2025-68613 n8n 表达式注入导致远程代码执行（RCE CVSS 10.0）](https://mp.weixin.qq.com/s?__biz=MzkwMDA5OTc0Mg==&mid=2247483810&idx=1&sn=29cb5155260cf55fd515d5e281230f61&scene=21#wechat_redirect)  
  
  
