#  CVE-2026-23745：node-tar 任意文件覆盖  
 Ots安全   2026-01-19 13:03  
  
**威胁简报**  
  
  
**恶意软件**  
  
  
**漏洞攻击**  
  
描述  
  
CVE-2026-23745的 PoC ，这是一个高危路径遍历漏洞node-tar（<7.5.2）。  
  
该库未能对硬链接和符号链接的绝对路径进行清理linkpath。这使得恶意 tar 归档文件能够绕过提取根目录，并覆盖主机系统上的任意文件，即使preservePaths: false已设置相关选项也无济于事。  
  
漏洞  
  
位于[此处] src/unpack.ts。该库使用path.resolve()未经清理的用户输入：  
  
```
// The bug: path.resolve ignores 'cwd'if the second argumentis absoluteconst target = path.resolve(this.cwd, String(entry.linkpath))
```  
  
  
/etc/passwd如果攻击者在 tar 标头中提供绝对路径（例如， ），node-tar则会将其解析为系统根目录而不是提取目录。  
  
PoC 使用情况  
  
其中包含的程序poc.js会生成恶意存档并尝试覆盖本地secret.txt文件。  
1. 安装存在漏洞的版本： npm install tar@7.5.2  
  
1. 运行漏洞利用生成器： node poc.js  
  
输出：  
  
```
[+] VULN CONFIRMED: Hardlink overwrite successful    Target file content changed to: OVERWRITTEN
```  
  
  
使固定  
  
已在v7.5.3 版本中修复。此次更新增加了stripAbsolutePath()在解析链接目标之前对其进行清理的功能。  
  
项目地址：  
  
https://github.com/Jvr2022/CVE-2026-23745  
  
**END**  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/rWGOWg48taeEibeR4EXw1Aic5BuQf8t0OkNSGAqXd7vakH3pichGXYNxQxP5rGU7OKZOH4zTtaLwl8SDYCt25NTibQ/640?wx_fmt=jpeg&from=appmsg "")  
  
  
公众号内容都来自国外平台-所有文章可通过点击阅读原文到达原文地址或参考地址  
  
排版 编辑 | Ots 小安   
  
采集 翻译 | Ots Ai牛马  
  
公众号 |   
AnQuan7 (Ots安全)  
  
