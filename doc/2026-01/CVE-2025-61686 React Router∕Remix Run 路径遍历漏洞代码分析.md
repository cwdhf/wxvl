#  CVE-2025-61686 React Router/Remix Run 路径遍历漏洞代码分析  
原创 capperflag
                        capperflag  capperflag安全团队   2026-01-20 08:48  
  
![](https://mmbiz.qpic.cn/mmbiz_png/CNsYcrt4sCWgOytUafs4njkHtWnE4ia1hMvMWBEn2Nt1TWRxPXGRvPTneLMSp7nxMIn5QTicQKiciagjo7FyZibSNYg/640?wx_fmt=png "")  
  
CVE-2025-61686 React Router/Remix Run 路径遍历漏洞代码分析  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/MVPvEL7Qg0EU3iaMKhDTbLMb5ibvRbwye0OUssaUczAgxHJnqDCibia2tLibftuuQ5VdmzjciaeGKof8OE1dkiaebvf5g/640?wx_fmt=png "")  
  
  
  
**01**  
  
漏洞详细  
  
  
源于 @react-router/node 包的 sessions/fileStorage.ts 文件中 createFileSessionStorage 函数的设计缺陷，createFileSessionStorage 将 Session ID 作为文件名，在指定目录（./sessions）读写会话文件 ，未对 Session ID 做任何路径校验，并且在禁用cookie签名时，客户端可以任意篡改session ID值，导致目录遍历  
  
  
根源  >  getFile()  
  
![](https://mmbiz.qpic.cn/mmbiz_png/saJ0wiaicsTmDzeXC7Jf2PyuIyTmrJE3BmAvPXym9B5zWFs1kq6n57xqWxwnNY3R0mQrtc8DTtmzCVsAeKv2ka6Q/640?wx_fmt=png "")  
  
在新版本中加入了校验防止了目录遍历  
  
![](https://mmbiz.qpic.cn/mmbiz_png/saJ0wiaicsTmDzeXC7Jf2PyuIyTmrJE3BmbwEaJjycamKSMaxKhdjX4lsLAB1TUkziaxjsqdaU8QCOljRkV2hD6YA/640?wx_fmt=png "")  
  
**02**  
  
触发漏洞流程  
  
  
    伪造session->getSession()->cookie.parse解析出恶意ID->readData/createData/updateData…->getfile()->path.join解析../->readFile/writeFile（触发漏洞）  
  
  
服务端中禁用签名  
  
![](https://mmbiz.qpic.cn/mmbiz_png/saJ0wiaicsTmDzeXC7Jf2PyuIyTmrJE3BmGEaMKsDCDx2oC5K5aDiaiaPy5OvfA6BhUvYyVt0E8lNHR5q1sTKJXdEg/640?wx_fmt=png "")  
  
调用getSession  
  
![](https://mmbiz.qpic.cn/mmbiz_png/saJ0wiaicsTmDzeXC7Jf2PyuIyTmrJE3Bm6muwF9eMm0VdaiclWuVlLdVEAswlCxzicoYoQNuAxib4BUwwSKYC1aEOg/640?wx_fmt=png "")  
  
    在createFileSessionStorage中，调用getSession触发readData函数  
  
![](https://mmbiz.qpic.cn/mmbiz_png/saJ0wiaicsTmDzeXC7Jf2PyuIyTmrJE3BmO0QPrqV2BOMF2EFyWeGQ28lDwED0Bm5IVVP7RmuqyYYTARFfV6WpQw/640?wx_fmt=png "")  
  
调用不做校验的getFile，传入../../危险字符，通过内部的readFile函数导致文件读取  
  
![](https://mmbiz.qpic.cn/mmbiz_png/saJ0wiaicsTmDzeXC7Jf2PyuIyTmrJE3BmsIXe8lclVISCDJZ0NNT37ibpkMsuCKibvIzM1o0KIsMr66KmcZnicxrNA/640?wx_fmt=png "")  
  
readFile()调用不做校验的getFile，传入../../危险字符，通过内部的readFile函数导致文件读取  
  
**03**  
  
影响版本  
  
  
@react-router/node 7.0.0 至 7.9.3   
  
@remix-run/node < 2.17.2   
  
@remix-run/deno < 2.17.2  
  
**04**  
  
影响范围  
  
  
    所有使用 createFileSessionStorage 且满足以下条件的 Node.js 服务：  
  
1. 禁用 Cookie 签名（secrets: []）；  
  
1. 未对 Session ID 做路径校验；  
  
1. 服务进程有目标目录的读写权限。  
  
  
  
**05**  
  
复现环境&参考链接  
  
  
https://github.com/FlowerWitch/CVE-2025-61686_docker  
  
https://nvd.nist.gov/vuln/detail/CVE-2025-61686  
  
**06**  
  
漏洞修复  
  
  
更新至新版本  
  
  
  
闲聊群，欢迎加入  
  
![](https://mmbiz.qpic.cn/mmbiz_png/saJ0wiaicsTmDzeXC7Jf2PyuIyTmrJE3Bm6W7R9mXoqiaCjdtKKT69ROge03pDdMSp7W4zOaQicN6NHCt4M0EEugpQ/640?wx_fmt=png&from=appmsg "")  
  
  
