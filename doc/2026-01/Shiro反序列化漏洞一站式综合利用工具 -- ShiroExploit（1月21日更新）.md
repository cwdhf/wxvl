#  Shiro反序列化漏洞一站式综合利用工具 -- ShiroExploit（1月21日更新）  
FightingLzn9
                    FightingLzn9  Web安全工具库   2026-01-22 02:05  
  
===================================  
  
**免责声明**  
  
请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，作者不为此承担任何责任。工具来自网络，  
安全性自测  
，  
大家都要把工具当做病毒对待，在虚拟机运行。  
如有侵权请联系删除。个人微信：  
ivu123ivu  
  
  
**0x01 工具介绍**  
  
ShiroExploit，是一款Shiro反序列化漏洞一站式综合利用工具。基本概述如下：  
```
1、区分ShiroAttack2，采用分块传输内存马，每块大小不超过4000。
2、可打JDK高版本的shiro，确保有key、有gadget就能rce。
3、依托JavaChains动态生成gadget，实现多条利用链，如CB、CC、Fastjson、Jackson。
4、通过魔改MemshellParty的内存马模板，使其回显马通信加密，去除一些典型的特征。
5、借助JMG的注入器，加以魔改，实现无侵入性，同一个容器可同时兼容多种类型的内存马。
6、对内存马和注入器类名进行随机化和Lambda化处理，规避内存马主动扫描设备的检测。
7、可以更改目标配置，如改Key、改TomcatHeaderMaxSize。
8、采用URLDNS链和反序列化炸弹的方式来探测指定类实现利用链的探测。
9、缺点是流量相对大一些。
```  
  
  
**0x02 安装与使用**  
  
JDK18场景下实现命令执行和打入多种内存马。  
  
![image](https://mmbiz.qpic.cn/sz_mmbiz_png/8H1dCzib3Uibvialj47jf8Arym3DLmjmgs9ByiaeiaTHwHhEZH2Jxe54jpv7SHlU6uTVZc4UiaNibgFoiblh9uXCSZqqrQ/640?wx_fmt=png&from=appmsg "")  
  
  
跑key。  
  
![image](https://mmbiz.qpic.cn/sz_mmbiz_png/8H1dCzib3Uibvialj47jf8Arym3DLmjmgs9EWyiaUZMZDR01uFecdLLUDXKzA91ypFNNnSgRucETXH3HF1IWGSHqsA/640?wx_fmt=png&from=appmsg "")  
  
  
探测利用链。  
  
![image](https://mmbiz.qpic.cn/sz_mmbiz_png/8H1dCzib3Uibvialj47jf8Arym3DLmjmgs9VEXvubkNCMcp19WUicQlvMYBjPOXRsicbaYTcA1hUnWpkL2W6eJkcVgg/640?wx_fmt=png&from=appmsg "")  
  
  
命令执行。  
  
![image](https://mmbiz.qpic.cn/sz_mmbiz_png/8H1dCzib3Uibvialj47jf8Arym3DLmjmgs92iauE56zkBbGFxoS2ib4wsy6TQTLRwYzUDueV3sDhmg4T4DzWNrNuIew/640?wx_fmt=png&from=appmsg "")  
  
  
打入Godzilla内存马（支持Behinder内存马）。  
  
![image](https://mmbiz.qpic.cn/sz_mmbiz_png/8H1dCzib3Uibvialj47jf8Arym3DLmjmgs9apTV3tyRH2NwAMibeLRfnX43dpzQlgKZExQxa3GKhshzkZL7V6OhibQg/640?wx_fmt=png&from=appmsg "")  
  
  
打入SUO5V2内存马。  
  
![image](https://mmbiz.qpic.cn/sz_mmbiz_png/8H1dCzib3Uibvialj47jf8Arym3DLmjmgs9gtG9EBj48cRqjmNsTZDEsHh7Hum19YP8pR6GricOyMbZe4ic87GkAIZQ/640?wx_fmt=png&from=appmsg "")  
  
  
支持Tomcat10及以上的内存马。  
  
![image](https://mmbiz.qpic.cn/sz_mmbiz_png/8H1dCzib3Uibvialj47jf8Arym3DLmjmgs9IcqXrL35cpibysS8aF0vt62xCQIf9Rnq71qhgrTPZlRaqCElQ0udG8g/640?wx_fmt=png&from=appmsg "")  
  
  
**0x03 项目链接下载**  
  
1、点击阅读原文，从原项目地址下载。  
  
2、网盘下载链接：https://pan.quark.cn/s/b7bac1c2ee9e  
<table><tbody><tr><td data-colwidth="287"><section><span leaf=""><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="100034245" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/8H1dCzib3Uibvialj47jf8Arym3DLmjmgs9CV6XCa2ZRoHYBoL5wnQBS2nl6LotEtnYsibQlXkDpRR94u94RSEnaSA/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" type="inline"/></span></section></td><td data-colwidth="287"><section><span leaf=""><img class="rich_pages wxw-img" data-aistatus="1" data-imgfileid="100033627" data-ratio="1.2469635627530364" data-s="300,640" data-src="https://mmbiz.qpic.cn/sz_mmbiz_jpg/8H1dCzib3UibsC4yYFwgTnJrN0q57DearHJhaWSE6XQllpkUviaibg5MqTYgdUQYDNt8ysfV2v6o4jsN34pmq3DAOg/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1235" type="inline"/></span></section></td></tr></tbody></table>  
  
  
  
  
