#  JWT漏洞原理、攻击、防御全解析  
原创 01iver Sec
                        01iver Sec  01iver的安全小圈   2026-01-20 09:00  
  
你试过挖掘 JSON Web Token（JWT）漏洞吗？  
  
分享 5 个测试思路👇  
1. 将算法（alg）改为"none"  
，移除签名部分，但保留末尾的英文句点  
  
1. 执行命令jwt_tool <JWT> --crack -d <wordlist>  
爆破弱密钥  
  
1. 将算法从RS256  
改为HS256  
，再使用服务端公钥进行签名  
  
1. 操纵密钥 ID（kid）参数：尝试路径遍历攻击，例如构造"kid": "../../dev/null"  
  
1. 在不同环境（测试环境 vs 生产环境）之间复用 JWT。这些环境可能使用相同密钥，攻击者可借此接管生产环境账户💥  
  
### 逐条技术详解  
  
JWT 的结构为 **Header.Payload.Signature**  
（三段式，用英文句点分隔），其核心安全依赖于**签名验证**  
和**算法配置**  
，以下 5 种思路均是利用 JWT 的配置缺陷或设计逻辑漏洞进行攻击。  
1. **1.算法改为none+ 保留末尾句点**  
  
1. **原理**  
：JWT 支持none  
算法（无签名模式），本意是用于调试，但部分服务端未禁用该算法，且验证逻辑存在缺陷 —— 只检查 JWT 的结构格式，不验证签名有效性。  
  
1. **操作关键**  
：移除Signature  
段后，必须保留末尾的句点，使 JWT 结构维持Header.Payload.  
的格式。若缺少句点，服务端会判定 JWT 格式非法，攻击失败。  
  
1. **危害**  
：攻击者可随意篡改Payload  
中的核心信息（如用户 ID、权限等级），且无需签名即可通过验证，直接越权访问。  
  
1. **2.jwt_tool爆破弱密钥**  
  
1. jwt_tool  
：一款开源的 JWT 安全测试工具，支持爆破、篡改、算法切换等操作  
  
1. <JWT>  
：待测试的 JWT 字符串  
  
1. --crack  
：指定爆破模式  
  
1. -d <wordlist>  
：指定字典文件路径  
  
1. **适用场景**  
：JWT 采用**对称加密算法**  
（如HS256  
）时，签名和验证使用**同一个密钥**  
。若密钥强度不足（如弱口令、默认密钥），可通过字典爆破获取。  
  
1. **命令解析**  
：  
  
1. **危害**  
：获取密钥后，攻击者可伪造任意内容的 JWT，完全控制目标账户或权限。  
  
1. **3.RS256 转 HS256 算法混淆攻击**  
  
1. RS256  
：非对称加密算法，**私钥签名，公钥验证**  
，私钥由服务端严格保管  
  
1. HS256  
：对称加密算法，**同一密钥签名 + 验证**  
  
1. **算法区别**  
1. **攻击原理**  
：部分服务端未限制可使用的算法，攻击者可修改Header  
中的alg  
字段为HS256  
，并使用服务端的**公钥**  
作为对称密钥对 JWT 进行签名。  
  
1. **验证逻辑缺陷**  
：服务端若未校验算法一致性，会默认使用配置的公钥去验证HS256  
签名，而公钥是公开可获取的，最终导致签名验证通过。  
  
1. **危害**  
：无需获取私钥即可伪造 JWT，突破非对称加密的安全防护。  
  
1. **4.kid参数路径遍历攻击**  
  
1. /dev/null  
是系统空设备文件，内容为空  
  
1. 服务端解析该参数时，会向上遍历目录并尝试读取/dev/null  
作为密钥  
  
1. 若服务端验证逻辑存在缺陷，会将空内容作为密钥，攻击者可使用空密钥签名 JWT 以通过验证。  
  
1. **kid参数作用**  
：kid  
（Key ID）是 JWT Header  
中的可选字段，用于标识服务端应使用哪一个密钥验证签名（适用于服务端配置多套密钥的场景）。  
  
1. **攻击原理**  
：若服务端未对kid  
参数做输入校验，攻击者可构造路径遍历 Payload，诱导服务端加载非预期的 “密钥文件”。  
  
1. **案例解析**  
：构造"kid": "../../dev/null"  
（类 Unix 系统环境）  
  
1. **拓展场景**  
：还可尝试构造kid=../../etc/passwd  
等路径，尝试读取系统敏感文件。  
  
1. **5.跨环境 JWT 复用攻击**  
  
1. **攻击前提**  
：企业的**测试环境（staging）**  
 和**生产环境（prod）**  
 共用同一套 JWT 密钥（开发人员为了方便，常复用密钥）。  
  
1. **攻击流程**  
：攻击者在测试环境注册账户并获取 JWT，或篡改测试环境 JWT 提升权限，再将该 JWT 直接用于生产环境的接口请求。  
  
1. **危害**  
：生产环境的服务端会用相同密钥验证 JWT 有效性，攻击者可直接接管生产环境的高权限账户（如管理员账户），造成核心业务数据泄露或系统被控制。  
  
