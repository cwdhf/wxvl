#  你想拥有一个自己开发的漏洞靶场吗？  
原创 信息安全笔记
                    信息安全笔记  信息安全笔记   2026-01-16 05:08  
  
大家好，今天来演示一下  
**《仿真电商平台漏洞靶场》**  
，也就是之前  
**《仿真电商平台漏洞靶场实战开发课程》**  
的成果演示。废话不多说，直接开干。  
#### 漏洞1: 身份认证拒绝服务攻击  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFPO1SyFQZuqK6tF9ibHQ0lU4BLFJ4wEZlqahBorG7pDlvB1XjFro7BQQ/640?wx_fmt=png&from=appmsg "")  
  
在用户登录时，连续密码错误5次，被限制5分钟登录。  
  
该漏洞产生的原因，本质上是安全控制措施自身设计的不合理，攻击者可以编写利用脚本，批量使平台真正的用户无法登录。想象一下，平台如果有几十万、上百万的用户，并且当下多以手机号作为账号名，即便攻击者不知道平台具体有哪些账号，比如18100000001，但攻击者可以遍历13、15、18开头的11位手机号并进行无差别自动化攻击。  
  
**漏洞危害等级：**  
严重  
#### 漏洞2: HOST头注入-账号接管  
  
给用户邮箱发送密码重置链接是很常见的一种很常见的找回密码方式。这里，我的账户是  
hackerzhou@qq.com  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFIeepaNtXibEu60ibQZlIfzE2cWJaEv1JXvIKic94vUwiamVVQXWfrdH4PQ/640?wx_fmt=png&from=appmsg "")  
  
这里，先在找回密码页面填写注册的邮箱，并点击发送邮件。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFp29o7picrZ3NwzlVNhoDwLFw3Qn7eeDbnp08GlvUL3PnX5tHib1xk8GQ/640?wx_fmt=png&from=appmsg "")  
  
  
访问我们的收件箱，可以看到密码重置的URL,关键部分是URL中的token  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdF5kwicPBgv0UkyNpYDqV1mSmECwsEkyHicTeibiay3Uu03j7vTyaR9YicngQ/640?wx_fmt=png&from=appmsg "")  
  
这里，我的业务地址是  
http://192.168.101.204:8000  
 ，用户按这个逻辑正常走，复制这个URL是可以将自己的密码重置的。  
  
访问该URL,进入密码重置页面，输入新的密码，即可密码重置成功。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFsjGRRHhOj1bQxPUBqCufAcYYp6eO71hRicqfaLktzictg2zqgQQUjndA/640?wx_fmt=png&from=appmsg "")  
  
  
但如果系统的部署架构导致【WEB缓存投毒、HTTP Request smuggling请求走私】，那么【web缓存投毒+HOST注入】就可以造成极大的杀伤（任意账号接管）。由于环境的原因，我这里无法搭建web缓存投毒环境，直接演示【找回密码的HOST注入】接管测试账号。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFCKKkcE7J4mtibibcMIfUEibibnUO1hDBSCuoiaeRozYZRF17kSXjMGibxiavA/640?wx_fmt=png&from=appmsg "")  
  
这里，用burpsuite抓包，将真实的192.168.101.204:8000 改为恶意的evil.com，并发送请求  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFbq10eZZECdGWwr9OVXvrGq7RQLZMsAWL2ibTM5GvDjHNn1ytGh0CnAw/640?wx_fmt=png&from=appmsg "")  
  
此时，用户访问  
http://evil.com/auth/user/reset-password/93bf10d3-3418-4fa9-b8a7-33f6af8fde27  
  
攻击者evil.com服务器获取到密码重置token。然后攻击者拿着93bf10d3-3418-4fa9-b8a7-33f6af8fde27去正常的业务系统进行密码重置  
  
http://192.168.101.204:8000/auth/user/reset-password/93bf10d3-3418-4fa9-b8a7-33f6af8fde27  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFOqCSWqNJpX83tANc0eGWZrWo92fOmkajFPd4N3ZSUE8Hicm9v1m6adQ/640?wx_fmt=png&from=appmsg "")  
  
这样，攻击者拿着  
hackerzhou@qq.com  
的密码重置令牌，可以成功修改密码，获得  
hackerzhou@qq.com  
的账号权限。  
  
**漏洞危害：**  
 严重  
#### 漏洞3: 管理后台登录接口密码加密密钥泄漏  
  
有很多的业务系统的设计，会在前端加密用户密码，并在后端解密，有些可能是哈希、有些可能是HMAC、有些可能是AES、有些可能是RSA.  
  
这个漏洞是23年微软官网的一个漏洞。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFqQnvLtgKJwVwpXnG8UkuIZfYhm5esoUF0eqD1d409SNkbeMXooD2mw/640?wx_fmt=png&from=appmsg "")  
  
该漏洞的前提是，没有做任何  
**防暴力猜解措施**  
。  
  
输入admin/admin后，在burpsuite中查看数据包  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFHWh0rFWZxrI5pW3IMmykMmeYiar3qiaDWcaUUyQXuM05cGF1vt4libicGQ/640?wx_fmt=png&from=appmsg "")  
  
发现password经过加密，无法直接暴力破解。但在JS代码中找到了AES密钥  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFNtRHYbj9YVGvnKLPJ4ib7l60rp306wHQFwJdKibtlUUJ9JRhibcic3rjxg/640?wx_fmt=png&from=appmsg "")  
  
暴力破解的代码也很简单，将passwrod.txt中密码加密后发送POST请求  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFmGBLJuDm5Xy5wAUqxXz543fRxp9tV2QP0Xu25tib9KGfU0FysNe2tUg/640?wx_fmt=png&from=appmsg "")  
  
运行结果如下  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFT6ibTOdc3qzpPibr3iaONvib9tCuX44YZLePXy1LYBAiaFPQEW0UnbS1cfw/640?wx_fmt=png&from=appmsg "")  
  
**漏洞危害：**  
严重  
#### 漏洞4:SSRF-内网探测  
  
商品导入通过dialog表单实现，流程分为两步：1. 文件上传成功后返回文件URL）；2. 系统请求该URL读取文件内容并批量写入数据库。第二步的URL参数可被外部控制，形成SSRF漏洞  
  
登录管理员后台，进行商品批量导入  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFAYut8OFlRTH7TRNIZ09Dwkuv0MKCrK6uRUWBjnUh2OeuwcmjvgYEsg/640?wx_fmt=png&from=appmsg "")  
  
不需要关心上传的是什么文件，以及xlsx格式对不对，只要上传成功，就会将url自动渲染到下方的“文件URL"表单中。点击确认导入  
  
去burpsuite查看请求数据包  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFNrUrQic2XCoRvCep2Oia56SRkwdjrXP39zrCLT7BGNBCZaqicdEL423Kw/640?wx_fmt=png&from=appmsg "")  
  
将url改为file:///etc/passwd， 发送数据包，可以看到已经通过SSRF漏洞读取到了/etc/passwd  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFK44QG9Dr8pk1XVOzvb9RFKp36KnWNph1Sr4bl0KsaLT0QicB2V98Lzw/640?wx_fmt=png&from=appmsg "")  
  
**漏洞危害：**  
严重  
#### 漏洞5:条件竞争-一个充值码可以兑换多次  
  
先去管理后台生成充值码，生成一张50元面值的充值券。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdF5BnjBuZam1pIhKbUlHrojVwQ9uDx9lqmwBKqfO0aSqUEjwias890cmA/640?wx_fmt=png&from=appmsg "")  
  
拿着这个券去前端用户侧进行余额充值。首先当前用户余额为0  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFEtfKzoZaaMb8OX9piaibegUKLJbzvJ5jTyHoHmK9YAAY7iaav6qkByWibw/640?wx_fmt=png&from=appmsg "")  
  
接下来用上面的券进行充值  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFCRNI59MYxVN8MqG8qg9pmVb4LTE79rnfd1CWoUnbIq9Cn6efUjjrOQ/640?wx_fmt=png&from=appmsg "")  
  
再次使用该券兑换，提示“已被兑换”  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFvDp1TwNtFibr02L2vibQsbASQMpdicnbh34hz6vRLZdgUepFDnnpVLNVQ/640?wx_fmt=png&from=appmsg "")  
  
现在我已经使用了2张50元的券兑换，余额变成了100  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFNLxqlwicoE6eQaQVLLx2icScp10W0x2ur1g3ApyDRIQgbosDyFbAUM7g/640?wx_fmt=png&from=appmsg "")  
  
下面，用一张新的50元的券，通过burpsuite intruder并发请求。 使用默认的10并发即可。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFxHsjjYkRgVQQuPGhuLXjwYRTkbDAlCrv0h6HTK0XvMRsQQawSTibHCA/640?wx_fmt=png&from=appmsg "")  
  
可以看到，兑换充值券的接口成功了4次。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFZERsacnUwxiaU8eYOeGZq1GnibicaXiaic1wvYoHnMb4RPibyOfADtdr8gWg/640?wx_fmt=png&from=appmsg "")  
  
更直观的来刷新余额  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFhACROFxiaHKF62e7OiafYax0Qah4sJ9mdEoZVcfDtaq1VbdMaUcj8bhQ/640?wx_fmt=png&from=appmsg "")  
  
  
金额已经由原来的100变成300，更好对应一个50元的兑换码被兑换了4次(+200)  
  
**漏洞危害：**  
严重  
  
  
这里先演示5个漏洞场景，有需要【课程+源代码】的人可以联系我。  
  
本人强项：企业安全体系建设（规划+技术落地）、软件架构设计与研发（独立研发经验：安全运营中心系统、职场相亲平台）、应用安全SDL/devsecops. 有其他商务合作机会也可以加下面的微信。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpib1LAE6NM0JFMXK01VGwdFhmOkplLvzjyY3ricIvIibqjgKXuaj9KfpbJMntDFnCsFVdXFUO096vdA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UXial9Jib2qcpvsfaeoElMj5XQNUhTiah2vibUgrfE3zc7EFUKNNrOOIsEOmg5jSU17s0FGT9kkLYdiaruZQIy5lr5g/640?wx_fmt=png&from=appmsg "")  
  
  
