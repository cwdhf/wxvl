#  漏洞复现 | React Router 未授权路径遍历(CVE-2025-61686)导致任意文件操作漏洞  
原创 俺不是鸡哥
                    俺不是鸡哥  渗透结束-非常安全   2026-01-19 03:00  
  
# 前言  
  
这里简单记录一下React Router 未授权路径遍历漏洞 (CVE-2025-61686)复现过程，如有写的不正确的地方欢迎各位师傅指正。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DO4U5eg9tGpfEa8Bv7gMrSTjzgEcmcLFNJ2t5etW0CFkUCsbSrauHww/640?wx_fmt=png&from=appmsg "")  
# 参考  
  
提交人：brophdawg11  
  
CVE编号：CVE-2025-61686  
  
漏洞危害：严重  
  
项目star量：56.1k  
  
项目地址：  
  
https://github.com/remix-run/react-router  
  
参考地址：  
  
https://github.com/remix-run/react-router/security/advisories/GHSA-9583-h5hc-x8cw  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DpV96ABcjaiaCXQic7iaaiapYqpLy78pOKEy2ciciczlzH8ic2HtYtRyoIYqhg/640?wx_fmt=png "")  
# 流程  
  
位置：  
  
packages/react-router-node/sessions/fileStorage.ts  
  
问题出现在createFileSessionStorage核心工具函数，该函数的作用是创建一个基于本地文件系统来持久化存储用户Session会话数据的管理器  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0D2DWmNJNp4UBn8ElsKhR0Qfgl8LMTJSmw0fH2xJA3uH63Q3icR0fHfJA/640?wx_fmt=png "")  
  
通过查看发现createData、readData、updateData和deleteData内部方法都调用了getFile函数，并在对比新旧代码处，可以看到历史版本中getFile函数无任何校验和拦截处理，在新版本中限制必须是16位的字符  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DxIYDGpRXU6Y0BKmtoNib2LOZxnDeeejxJJNsYxR587T2nNqfKJTo6vw/640?wx_fmt=png "")  
  
那么就攻击者可以通过传入../来控制要新增、删除、查看和覆盖文件，如下所示为删除方法的内容  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DicJ1icZib7szz1mMSDsVwpdibxEwjdicztic2rcyTftibgUAo9PgcqVJeL6GQ/640?wx_fmt=png "")  
# 跟进上层  
  
位置：  
  
packages/react-router/lib/server-runtime/sessions.ts  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DzzwjxkBfaEP3c1L5Tru0W8NydP29k4PmxC4sKv01KBMHedCMFCAf9A/640?wx_fmt=png "")  
  
里面有getSession、commitSession和destroySession方法，分别用于读取、提交和删除会话所用  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0D4KT6PD16OjcbJtQebKVJH5uNjefPY19UhJkT37mmqTjmUBUqicABCQg/640?wx_fmt=png "")  
  
跟进commitSession方法调用的cookie.serialize()  
  
位置：  
  
packages/react-router/lib/server-runtime/cookies.ts  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DkeXtpdicEBczYbnqicu5tDUDWpXbiat2u896bnxuW2c4pVuOVyvialRTug/640?wx_fmt=png "")  
  
查看内容后继续跟到encodeCookieValue方法，这里会判断开发者是否设置secrets密钥  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DFScBUKvMrBtYoCkE4rckwFkJwjmcvuedhbdE2lsbfNxwQ4Vic437ZUw/640?wx_fmt=png "")  
  
如有设置则会调用sign方法加密  
  
位置：  
  
packages/react-router/lib/server-runtime/crypto.ts  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0Dxn7L0qJM8V44wwz7rw12QV6L1Df4Z9fvk8oB5baY4CGyYsQHFic1iakA/640?wx_fmt=png "")  
  
如果开启加密，则不能通过getSession方法的校验，从而篡改session值，漏洞也就不可被利用了。  
  
解密流程：  
  
getSession --- cookie.parse --- decodeCookieValue --- decodeCookieValue --- unsign  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DnVbF4DGcHyPRJYibEaW3hN9RWLSjOMNHUad93HwERibAn2sRhshd5pFw/640?wx_fmt=png "")  
  
该漏洞还是有限制的，主要还是看开发宝宝怎么写，感觉可以做成ctf题用来学习也不错。  
# 复现  
  
初始化项目目录  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DCYXm7hqveFqsciaP1aAwdbOiaDwicYFbX4aRvcCl0uBfE1NbwUumrrIOg/640?wx_fmt=png "")  
  
安装有漏洞的@react-router/node依赖，会收到官方风险提示有7个漏洞  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DHqtn9FeswKnusZpQgwviceJkE0IvK5iafkiam8K0bUx5u7GWkeibbm4Unw/640?wx_fmt=png "")  
  
查看漏洞详细内容，这里无视风险继续安装  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DtibPr9dw33Zre9sqXU7s7WicJZYYxECfkocTqUWT6lcUYvVZnQ6DIQiaA/640?wx_fmt=jpeg "")  
  
继续安装其他所需依赖  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DhskUtyulyKbDIpI5EGsddFb21XpWicA2jkYPIHibDS8VfSxPuabiaCwJA/640?wx_fmt=png "")  
  
安装完毕后编写项目文件，利用ai简单写3个存在漏洞的接口，首先是写入文件接口传入两个值，通过cookie传入的值到存在漏洞的commitSession函数中来控制文件写入的位置，而body传入内容则是session对象set方法设置文件中的内容  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DoDfLSfhiaPA94oHxvsMbuyzib5qxHA3wzjhBYdVSHh79gVD0eSLoxfkg/640?wx_fmt=png "")  
  
读取文件接口则是cookie传入参数可控，文件内容由session对象的get方法获取，最后给打印出来  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0Dxgdnv9fpd3IUmxb6w2HicfbfFwEr7L5AqUMTUIGxp8Howy1AVEKH21A/640?wx_fmt=png "")  
  
删除文件接口也是cookie传入参数可控，进入存在漏洞的destroySession函数导致文件被删除  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DWUOxJb1n388bRevqZYmDCoAjSibIV6wlzDUibtrU3ssRqa4nY39dB5XA/640?wx_fmt=png "")  
  
启动服务，测试一下  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0D95rzwNVmqWjuJibdMx4RDSS0RbCcJpibmXGibkNcWxC5fMBMUjw06VlIg/640?wx_fmt=png "")  
  
请求写入的接口，当写入的文件存在时则会覆盖  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DZHSHgrTDlyCCL2ice9Kt82k8MSqC5DhG16blWUMX8liaRr2LLZR0y8gA/640?wx_fmt=png "")  
  
请求删除的接口  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DoWydnOibgwwqeH6aNf9AaZz5HgicnX11YE5dXaXBo2wT7SYNZMyCFH8Q/640?wx_fmt=png "")  
  
请求读取的接口  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DFibeWj1ibq1KEhPGCF8LwTnGnbm6BxLp7dpsfIuKdnbEyYwS1mzibVsiaQ/640?wx_fmt=png "")  
  
查看写入和删除的效果  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DvHzXJnHRs7CWodTibe6BTNVQ2GhYu85ibQ0PpM0z0VDVhu5Qdvmodk0A/640?wx_fmt=png "")  
# 最后  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/4NeJHnZMG8rjeoP9nKUdejz2icwz0sU0DBAlQQiar40qwMFH45Vdy0Rr132RhoozrhqQOxjwGIpZFE41xj4IKsmQ/640?wx_fmt=png&from=appmsg "")  
  
