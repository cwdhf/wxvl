#  WordPress后台存储型XSS 全网首发POC及复现环境（CVE-2025-12067）  
原创 a1batr0ss
                    a1batr0ss  天翁安全   2026-01-29 09:01  
  
**免责声明：**  
本公众号所发布的全部内容，包括但不限于技术文章、POC脚本、漏洞利用工具及相关测试环境，均仅限于合法的网络安全学习、研究和教学用途。所有人在使用上述内容时，应严格遵守中华人民共和国相关法律法规以及道德伦理要求。未经明确的官方书面授权，严禁将公众号内的任何内容用于未经授权的渗透测试、漏洞利用或攻击行为。 所有人仅可在自己合法拥有或管理的系统环境中进行本地漏洞复现与安全测试，或用于具有明确授权的合法渗透测试项目。所有人不得以任何形式利用公众号内提供的内容从事非法、侵权或其他不当活动。 如因违反上述规定或不当使用本公众号提供的任何内容，造成的一切法律责任、经济损失、纠纷及其他任何形式的不利后果，均由相关成员自行承担，与本公众号无任何关联。  
## 不错过最新的漏洞POC  
  
为保证您可以在第一时间接收到本公众号分享的**漏洞复现及POC**  
信息，建议您在公众号“天翁安全”主页界面将“天翁安全”设为**星标**  
。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2Tmlkt47JPBmxCb2qT1zIp24pswaQseDJrlTyZbfNln1IL7dXGG0fPA5Q/640?wx_fmt=png&from=appmsg "")  
## 专题介绍  
  
本文为【WordPress专题】的衍生文章，不直接合并入【WordPress专题】，但可配合专题进行学习研究。  
  
【WordPress专题】详细介绍对WordPress框架中**公开Or未公开**  
漏洞的**漏洞挖掘**  
、**代码审计分析**  
及**POC构造**  
。以小见大，通过个性的漏洞总结WordPress中漏洞的共性，实现对WordPress漏洞的全面掌握。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmfyLhEpW7VmkMwRRY4hSqzounicarVmaOHWiaA1vMlib0C1N0HRIP6ozxw/640?wx_fmt=png&from=appmsg "")  
  
感兴趣的师傅们可以查看前八篇文章进行共同学习  
- [【WordPress专题01】前台管理员账户创建漏洞（CVE-2025-4334）漏洞分析及POC](https://mp.weixin.qq.com/s?__biz=MzkwMzUyMjk2MQ==&mid=2247484874&idx=1&sn=201d4be14b19110dd810479005c241ea&scene=21#wechat_redirect)  
  
  
- [【WordPress专题02】CVE-2025-2563漏洞分析及POC](https://mp.weixin.qq.com/s?__biz=MzkwMzUyMjk2MQ==&mid=2247484958&idx=1&sn=9cef3027500d25c935256d0e196b70eb&scene=21#wechat_redirect)  
  
  
- [【WordPress专题03】遇到不按规范编写的插件如何进行代码审计？](https://mp.weixin.qq.com/s?__biz=MzkwMzUyMjk2MQ==&mid=2247485055&idx=1&sn=b7ea163ea3178b48f716d6e55941700e&scene=21#wechat_redirect)  
  
  
- [【WordPress专题04】通过漏洞介绍构造CVE-2025-11457的POC](https://mp.weixin.qq.com/s?__biz=MzkwMzUyMjk2MQ==&mid=2247485111&idx=1&sn=73c6db35dd7cfb5b2bc6d51a02497de0&scene=21#wechat_redirect)  
  
  
- [【WordPress专题05】CVE-2025-11499前台文件上传漏洞 全网首发POC及漏洞分析](https://mp.weixin.qq.com/s?__biz=MzkwMzUyMjk2MQ==&mid=2247485207&idx=1&sn=d3a4f5828ccfbb2f68c39c6ce69f7bcf&scene=21#wechat_redirect)  
  
  
- [【WordPress专题06】CVE-2025-13342 选项修改导致的管理员用户注册漏洞POC及漏洞分析](https://mp.weixin.qq.com/s?__biz=MzkwMzUyMjk2MQ==&mid=2247485312&idx=1&sn=0425719767b7010a004d6ea750a6495b&scene=21#wechat_redirect)  
  
  
- [【WordPress专题07】一文搞懂 如何对WordPress进行漏洞探测](https://mp.weixin.qq.com/s?__biz=MzkwMzUyMjk2MQ==&mid=2247485439&idx=1&sn=004f54e713c580101baad71ce543cbb9&scene=21#wechat_redirect)  
  
  
- [【WordPress专题08】全网首发POC及漏洞分析 CVE-2025-15403权限提升漏洞](https://mp.weixin.qq.com/s?__biz=MzkwMzUyMjk2MQ==&mid=2247485513&idx=1&sn=518be0036194ca8ea9183effdc224d5e&scene=21#wechat_redirect)  
  
  
## 漏洞介绍  
  
CVE-2025-12067 是一个影响 WordPress 的安全漏洞，存在于 ACF 和 SCF 插件的 Table Field Add-on 中，该漏洞属于存储型跨站脚本（XSS）。由于插件在表格单元格内容的输入校验和输出转义方面处理不当，导致在 1.3.30 及以下版本中，具有作者及以上权限的已认证用户可以注入任意恶意脚本，这些脚本会在其他用户访问被影响页面时执行，从而可能造成会话劫持、权限提升或敏感信息泄露等安全风险。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmygraEtYiaHBko9d6jnj8IevMicDxNgIx8S0CkMEtb9FTtxy3D2W9haZw/640?wx_fmt=png&from=appmsg "")  
## 漏洞影响版本  
<table><thead><tr style="box-sizing: border-box;"><th style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;font-style: normal;font-weight: bold;text-align: left;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">产品版本</span></section></th><th style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;font-style: normal;font-weight: bold;text-align: left;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">版本</span></section></th></tr></thead><tbody><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">advanced-custom-fields-table-field</span></section></td><td style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">&lt;= 1.3.30</span></section></td></tr></tbody></table>## 环境部署  
  
该漏洞所涉及的插件是“Table Field Add-on for ACF and SCF”，这个插件相当于是ACF的一个扩展，但活跃安装数也有5万+。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmQjibNKwM66rkyKdejOCYrojI4B6B4ocZopSrDeHwnv0KC89ib4uwcGSw/640?wx_fmt=png&from=appmsg "")  
  
其实我觉得这个漏洞最难的点在于搭建能够利用的环境，第一次接触ACF这个插件花了不少时间去熟悉。正好趁着这个机会详细介绍一下“**Advanced Custom Fields**  
”（简称ACF）这个插件（2百万+的活跃安装）。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmBgnSX3grdF6OuiaGOorsoaOUFJJDLXExGqblbmyibe15VMRy66JTRNUw/640?wx_fmt=png&from=appmsg "")  
> Advanced Custom Fields（简称 ACF）是 WordPress 中非常流行的一款自定义字段管理插件，它通过直观的界面让开发者和内容编辑人员可以轻松为文章、页面或自定义内容类型**添加结构化的额外字段**  
，如文本、图片、选择器、关系数据等，从而摆脱仅依赖默认编辑器的限制。ACF 能将复杂的数据输入过程简化为可视化配置，并通过简洁的 API 在主题或插件中灵活调用这些字段数据，大幅提升内容建模能力、开发效率和网站的可维护性，因而被广泛应用于企业官网、内容型站点和高度定制化的 WordPress 项目中。  
  
  
从这段介绍来看，这个插件最大的功能在于**添加结构化的额外字段**  
。话不多说，我们用一个简单的事例来开始对这个插件的学习。  
  
首先记得激活这两个插件  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmGaiadocXofJQBXuK8N83AP92KPDOAbeicm6MV53OpBFDxeAiabQEylfxw/640?wx_fmt=png&from=appmsg "")  
  
我们在ACF中添加一个新的字段组。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmfLBaSSocHkqRFLSJzYibCpZOEOJZm9ek8y6tpPomEhXM9klibd7QZb6A/640?wx_fmt=png&from=appmsg "")  
  
我们将字段组的名称设置为“身份信息”，第一个字段标签设置为“姓名”，字段名称为“name”（这个是一会**代码引用**  
用到的参数，设置为英文），字段类型为文本。设置完成后点击右上角的“保存设置”。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmvUaHrQ9xic2Ivpj6iadkYWicENWCKH1mWTLx0VhKbAHtibGZoy0ic22BtgQ/640?wx_fmt=png&from=appmsg "")  
  
第二个字段字段标签设置为“其他资料”，字段名称为“info”，字段类型为Table。设置完成后点击右上角的“保存设置”。（这个是等会漏洞利用会用到的参数）  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmBGpfCXshCZqw5V5zZ3vSy5CRDY1qFI1KsR0fQiaKI0IbFwlyrfsXjhQ/640?wx_fmt=png&from=appmsg "")  
  
最下面还要设置一下规则组，也就是哪些内容会应用你设置的这些字段。这里“文章类型”等于“文章”，代表所有文章都会应用。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmxThWR994xkC7ZY0LeaBJHllA8uFVkyMr65Xx1RRL57HzianLYwsYfRw/640?wx_fmt=png&from=appmsg "")  
  
此时如果我们新建一篇文章，文章底部会有我们刚才添加的字段组  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmaWwibS3Zlf3KXMd0oeibCHjjXTic8qGJbaJt5v1CrcicYuFHkeEic5vE83w/640?wx_fmt=png&from=appmsg "")  
  
但就算此时我们在字段组中填上具体的值并将文章发布，我们的文章页面中也不会显示相关的内容。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmXNT5eibcevf75uvlrozAJB2TYW4kNZN4QBr91b8HkCRSZjib029ahwBQ/640?wx_fmt=png&from=appmsg "")  
  
此时我们需要到“主题文件编辑器”中编辑 single.php  
> 在 WordPress 中，主题编辑器里的 single.php  
 是**用于控制单篇文章（单条内容）详情页显示方式的模板文件**  
，当用户点击一篇文章进入正文页时，WordPress 会优先使用 single.php  
 来渲染该页面的结构和内容。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2Tmvju631WE3sUyqOCab8wJP6wbibSeUm1BVyQdhVxqCUhh9DruMm1WokA/640?wx_fmt=png&from=appmsg "")  
  
我们在合适的位置添加如下代码（其中 name  
和 info  
是刚才创建两个参数的名称）  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2Tm5FEicPIl4E8BOoP2Lfm0l1vMRTkichjUavicozaFnicOovicn4GiaD9xaib3w/640?wx_fmt=png&from=appmsg "")  
  
此时我们再去访问 http://127.0.0.1/acf/  
发现已经能看到我们设置的姓名信息和其他资料表格了。  
  
至此，我们已经大致学会了ACF插件的使用流程（搭配Elementor的付费版应该会更简单点，有钱的佬可以尝试），同时漏洞环境也搭建完毕。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2Tmj2roReoqHoahZQxJVBd9MNMKAIHzVJXYvTyVjnY5MNicoDfvFgJAqMA/640?wx_fmt=png&from=appmsg "")  
## 漏洞复现  
  
我们选择一位Author及以上权限的用户，这里选择zuozhe  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2Tmb1NwYcwbVt3lqQ4Rv2SpVVbV2x6gFIENSeKY8mOBXSUL7hBkMmw9Tg/640?wx_fmt=png&from=appmsg "")  
  
登录后我们新建一篇文章  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmJgwveLxh3w4P3w24fF8lH5qg6g0E6deRl7lzN1Zk0M1LichvicbD0Viag/640?wx_fmt=png&from=appmsg "")  
  
在“其他资料”表格中任意一栏中输入XSS的Payload，输入完成后点击发布。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmB9VmwdEtOaicx5GA6YuTu7bQxSAID2iatGDibzs78Fb967BZ5LnVC088A/640?wx_fmt=png&from=appmsg "")  
  
此时任意身份的用户访问 http://127.0.0.1/cve-2025-12067-xss测试/  
界面的用户都会触发这个存储型XSS  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmbDsyN42n4HexfxKts4kMYepWlzibvoUkNXd4nQ7WvlM6uDB8cxXOPuA/640?wx_fmt=png&from=appmsg "")  
## 漏洞修复  
  
插件官方已发布补丁，将advanced-custom-fields-table-field插件升级到1.3.31及以上版本即可  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmpciakW5YkSRaWwmFqvsJuXH7ZHdicMia3NayJ6A33B0yMjkD0KLJYoF1Q/640?wx_fmt=png&from=appmsg "")  
## 知识星球  
  
**“CVE-2025-12067复现POC、CVE-2025-12067 详细漏洞复现、CVE-2025-12067复现环境“**  
现已全部发布至知识星球，大家可在知识星球内获取，自行搭建环境、学习复现、代码审计。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmHsBoFtiaZjtad5alqAxpDSusKQVGuVOXwlSIxyoTLmURxGrAIg5glGA/640?wx_fmt=png&from=appmsg "")  
> 星球加入方式见文章底部二维码，欢迎加入交流和学习  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S5x07jHVSt38SyyvAwIV2TmUJFzCzKb2LiakRNKduBaickY3qSkcUQWhNV2d171zXbnbaPHyB5hoEibw/640?wx_fmt=png&from=appmsg "")  
  
  
