#  【漏洞通告】n8n 远程代码执行漏洞(CVE-2026-21858)  
深瞳漏洞实验室  深信服千里目安全技术中心   2026-01-09 07:59  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5xrLSa12s41kXYPClGZeRmDskXEpP1r1POXz2R2rKWPEUvKRyJeDTpEUJOBvicJNtWt3xUlkLkYLaA/640?wx_fmt=gif&from=appmsg "")  
  
**漏洞名称：**  
  
n8n远程代码执行漏洞(CVE-2026-21858)  
  
**组件名称：**  
  
n8n  
  
**影响范围：**  
  
n8n< 1.121.0  
  
**漏洞类型：**  
  
代码执行  
  
**利用条件：**  
  
1、用户认证：无需用户认证  
  
2、前置条件：默认配置  
  
3、触发方式：远程  
  
**综合评价：**  
  
<综合评定利用难度>：容易，无需授权即可执行任意代码。  
  
<综合评定威胁等级>：高危，可实现远程代码执行。  
  
**官方解决方案：**  
  
已发布  
  
  
  
  
**漏洞分析**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5xrLSa12s41kXYPClGZeRmDibaxkOtJxV2bNW6aonzxDdyyEzzUzgeV6vQs7icMkgroI2oiaFmNGetEQ/640?wx_fmt=gif&from=appmsg "")  
  
组件介绍  
  
n8n是一款‌开源的工作流自动化平台‌，它通过可视化拖拽节点的方式连接各种应用程序、服务和 API，帮助用户构建复杂的自动化流程而无需编写大量代码。其名称中的“n”代表“无数”，寓意其能够连接无数工具实现灵活集成。  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5xrLSa12s41kXYPClGZeRmDibaxkOtJxV2bNW6aonzxDdyyEzzUzgeV6vQs7icMkgroI2oiaFmNGetEQ/640?wx_fmt=gif&from=appmsg "")  
  
**漏洞简介**  
  
  
2026年1月9日，深瞳漏洞实验室监测到一则n8n组件存在代码执行漏洞的信息，漏洞编号：CVE-2026-21858，漏洞威胁等级：高危。  
  
n8n工作流自动化平台‌存在远程代码执行漏洞，源于处理 HTTP 请求时的“Content-Type 混淆”逻辑错误，表单 Webhook 节点的prepareFormReturnItem函数未验证请求类型便盲目信任req.body.files内容，使得未经身份验证的**攻击者可通过构造特定 JSON 请求实现任意文件读取，进而窃取数据库和配置文件中的凭据与加密密钥、伪造管理员会话 Cookie 登录系统，****最终通过创建含“执行命令”节点的工作流执行任意命令控制服务器。**  
  
  
  
  
**影响范围**  
  
目前受影响的n8n版本：  
  
n8n< 1.121.0  
  
  
  
**解决方案**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5xrLSa12s41kXYPClGZeRmDibaxkOtJxV2bNW6aonzxDdyyEzzUzgeV6vQs7icMkgroI2oiaFmNGetEQ/640?wx_fmt=gif&from=appmsg "")  
  
**官方修复建议**  
  
  
官方已发布最新版本修复该漏洞，建议受影响用户将n8n更新到最新版本。  
  
下载链接：https://github.com/n8n-io/n8n/releases  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5xrLSa12s41kXYPClGZeRmDibaxkOtJxV2bNW6aonzxDdyyEzzUzgeV6vQs7icMkgroI2oiaFmNGetEQ/640?wx_fmt=gif&from=appmsg "")  
  
**临时修复建议**  
  
- 关闭未使用的功能模块，减少潜在攻击入口。  
  
- 遵循最小权限原则，严控各类敏感操作权限范围。  
  
- 非必要不暴露服务到公网，限制访问源为可信范围。  
  
- 定期更新系统及各类组件至安全版本，及时修补已知隐患。  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/w8NHw6tcQ5xrLSa12s41kXYPClGZeRmDibaxkOtJxV2bNW6aonzxDdyyEzzUzgeV6vQs7icMkgroI2oiaFmNGetEQ/640?wx_fmt=gif&from=appmsg "")  
  
**深信服解决方案**  
  
  
**1、漏洞主动检测**  
  
支持对n8n远程代码执行漏洞(CVE-2026-21858)的主动检测，可批量快速检出业务场景中是否存在**漏洞风险**  
，相关产品如下：  
  
**【深信服云镜YJ】**  
预计2026年01月12日发布检测方案，规则ID:SF-2026-00431。  
  
**【深信服漏洞评估工具TSS】**  
预计2026年03月30日发布检测方案，规则ID:SF-2026-01001。  
  
**【深信服安全托管服务MSS】**  
预计2026年03月30日发布检测方案（需要具备TSS组件能力），规则ID:SF-2026-01001。  
  
**【深信服可拓展检测响应平台XDR】**  
预计2026年01月12日发布检测方案（需要具备云镜组件能力），规则ID:SF-2026-00431。  
  
  
**2、漏洞安全监测**  
  
支持对n8n远程代码执行漏洞(CVE-2026-21858)的监测，可依据流量收集实时监控业务场景中的受影响资产情况，快速检查受影响范围，相关产品及服务如下：  
  
**【深信服安全感知管理平台SIP】**  
预计2026年01月12日发布监测方案，规则ID:11228001。  
  
**【深信服安全托管服务MSS】**  
预计2026年01月12日发布监测方案（需要具备SIP组件能力），规则ID:11228001。  
  
**【深信服可拓展检测响应平台XDR】**  
预计2026年01月12日发布监测方案，规则ID:11228001。  
  
**【深信服流量检测GPT】**  
流量检测GPT基于攻击理解、代码理解能力，不依赖规则即可检测该攻击威胁。  
  
  
**3、漏洞安全防护**  
  
支持对n8n远程代码执行漏洞(CVE-2026-21858)的防御，可阻断攻击者针对该事件的入侵行为，相关产品及服务如下：  
  
**【深信服下一代防火墙AF】**  
预计2026年01月12日发布防护方案，规则ID:11228001。  
  
**【深信服Web应用防火墙WAF】**  
预计2026年01月12日发布防护方案，规则ID:11228001。  
  
**【深信服安全托管服务MSS】**  
预计2026年01月12日发布防护方案（需要具备AF组件能力），规则ID:11228001。  
  
**【深信服可拓展检测响应平台XDR】**  
预计2026年01月12日发布防护方案（需要具备AF组件能力），规则ID:11228001。  
  
  
  
参考链接  
  
  
https://github.com/n8n-io/n8n/security/advisories/GHSA-v4pr-fm98-w9pg  
  
  
  
时间轴  
  
  
  
**2026/01/09**  
  
深瞳漏洞实验室监测到n8n远程代码执行漏洞信息。  
  
  
  
**2026/01/09**  
  
深瞳漏洞实验室发布漏洞通告。  
  
  
点击**阅读原文**  
，及时关注并登录深信服**智安全平台**  
，可轻松查询漏洞相关解决方案。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/w8NHw6tcQ5xrLSa12s41kXYPClGZeRmDorAeMbZwSv6Jg3IRrQC4j9Zh6brAOtxuq43Tx5pDcL0qibTcjlJuNrg/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/w8NHw6tcQ5zvcIHbwGGYKbqDVYsVKzNNia1jYtHf49C7133AlDXAgex2W4lFvpia56tjQQDkiauNBrl08YbxqG01A/640?wx_fmt=jpeg&from=appmsg "")  
  
  
