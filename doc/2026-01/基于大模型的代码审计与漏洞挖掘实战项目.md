#  基于大模型的代码审计与漏洞挖掘实战项目  
原创 si1ence90
                    si1ence90  道一安全   2026-01-28 03:22  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWjKYvoSviaiaDUIGf1pH9H1bpSJRC3lIk08f5m6yibtkLDhFQwmCXicNMLFniaRrN0Xqvth9XWMQkn5bGQ/640?wx_fmt=gif "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgJHGxRSfVlI02pBf15B0slPyoWRWfSP0mM3LqDQKhOhVwfvVKma68JRwQ7E2Oysib3Nsw5ny7uaSw/640?wx_fmt=gif "")  
  
**免责声明**  
  
道一安全（本公众号）的技术文章仅供参考，此文所提供的信息只为网络安全人员对自己所负责的网站、服务器等（包括但不限于）进行检测或维护参考，未经授权请勿利用文章中的技术资料对任何计算机系统进行入侵操作。利用此文所提供的信息而造成的直接或间接后果和损失，均由使用者本人负责。本文所提供的工具仅用于学习，禁止用于其他！！！  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgJHGxRSfVlI02pBf15B0slPyoWRWfSP0mM3LqDQKhOhVwfvVKma68JRwQ7E2Oysib3Nsw5ny7uaSw/640?wx_fmt=gif "")  
  
**项目简介**  
  
本文转载于：  
https://github.com/si1ence90/LLM_VulnSeeker?tab=readme-ov-file  
  
  
  
本项目记录了一次利用大型语言模型（LLM）进行代码审计和漏洞利用 Payload 调试的实战经验。核心目标是探索 LLM 在网络安全领域的赋能潜力，特别是在漏洞筛选和复杂 Payload 绕过验证环节中的交互式表现。  
  
  
![项目概览](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKgPBfgKE31zkNW8KxrK4u4jvJug5XicV6YvU1XicY2icmCLNfMgE36Scgg/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgJHGxRSfVlI02pBf15B0slPyoWRWfSP0mM3LqDQKhOhVwfvVKma68JRwQ7E2Oysib3Nsw5ny7uaSw/640?wx_fmt=gif "")  
  
**核心特点**  
- 🔍 **智能漏洞识别**  
：利用 LLM 进行多轮代码审计，识别常见安全漏洞  
  
- 🎯 **精准漏洞筛选**  
：通过二次验证机制，提高漏洞识别的准确性  
  
- 🛠️ **Payload 生成**  
：自动生成针对性的漏洞利用 Payload  
  
- 🔄 **交互式调试**  
：支持多轮交互，逐步优化 Payload 绕过验证  
  
- 📊 **漏洞分类**  
：支持 SQL 注入、代码执行、XSS、文件上传等多种漏洞类型  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgJHGxRSfVlI02pBf15B0slPyoWRWfSP0mM3LqDQKhOhVwfvVKma68JRwQ7E2Oysib3Nsw5ny7uaSw/640?wx_fmt=gif "")  
  
**使用流程**  
  
第一轮：初始漏洞扫描  
  
**Prompt 示例：**  
```
你作为一个专业的网络安全测试员，请针对当前的项目进行分析，是否存在有典型的sql注入、代码执行、文件包含、任意代码执行，XSS，任意文件下载，逻辑漏洞，任意用户登录或者密码重置，任意文件上传等安全问题，请仔细分析，并针对性给出可利用的POC。
```  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKViaxQI5QkVfXb1hM5vceDsQ7pHVLJv3VU5IzI8REhiaBZnzdjZzicn92Q/640?wx_fmt=png&from=appmsg "")  
  
**结果分析：**  
- 模型分析完成后给出了 **20 个可能存在的漏洞**  
  
- 包含各种常见漏洞类型：SQL 注入、代码执行、XSS、密码重置、文件上传、认证绕过、SSRF、原型链污染、CSRF、目录遍历、信息泄露、拒绝服务等  
  
- 初步识别准确率较低，需要进一步验证  
  
![第一轮详细结果](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKcGjiau9tXaIDXPkFJKUlFxfLD1xfAuxL15ePIIJxibk2bW2YpdFATStQ/640?wx_fmt=png&from=appmsg "")  
  
### 第二轮：漏洞二次验证  
  
**Prompt 示例：**  
```
请将这些内容进行二次检查，确认是否是真实可能存在的，能够被利用的，并同时给出特定的url和利用方法，存在的漏洞名称。
```  
  
**验证结果：**  
漏洞类型状态说明SQL 注入漏洞✅ 确认存在已验证可被利用任意代码执行漏洞✅ 确认存在已验证可被利用任意文件下载漏洞❌ 需要重新验证需进一步确认XSS 漏洞✅ 确认存在已验证可被利用密码重置绕过漏洞✅ 确认存在已验证可被利用文件上传漏洞❌ 需要重新验证需进一步确认认证绕过漏洞❌ 需要重新验证需进一步确认信息泄露漏洞✅ 确认存在已验证可被利用SSRF 漏洞❌ 需要重新验证需进一步确认原型链污染漏洞❌ 需要重新验证需进一步确认  
![第二轮验证结果](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKzQuVQhA32IEuBXOdlb5AXtw1adUFAK78pLw8y3GX9SicjWFIFrTYKHQ/640?wx_fmt=png&from=appmsg "")  
 ![漏洞详情](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKgM0ku85CDFVRPVNHt5xd9CwgMuQebPpicaY81RH0vtBFyEPBqGhuTyg/640?wx_fmt=png&from=appmsg "")  
  
  
### 第三轮：深度利用验证  
#### 3.1 代码执行漏洞分析  
  
**Prompt 示例：**  
```
针对任意代码执行漏洞这个漏洞，请详细说明一下如何利用，是否可以执行系统命令。
```  
  
![代码执行漏洞分析](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKZwButSGPib1aPMAnARMb68HrN9TXdR6TZm9PBo3O0kSicZNhcLfkFvYQ/640?wx_fmt=png&from=appmsg "")  
  
**利用方法：**  
 模型提供了多种利用手法与攻击 Payload：  
  
![Payload 生成](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKniagSMw77iaEic3MBibn8mxADU4ZDtwI9uMpKegGR9fAja7ndz97Lfek6g/640?wx_fmt=png&from=appmsg "")  
#### 3.2 环境特定 Payload 生成  
  
**Prompt 示例：**  
```
已知当前测试的主机是一个 Windows 主机，"parseData" 这个参数如何构造 payload
```  
  
**生成结果：**  
- 模型共给出了 **8 种不同的利用方法与攻击 Payload**  
  
#### 3.3 错误处理与绕过  
#### 问题： 实际测试过程中出现报错  
  
![报错信息](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKwlbAXCqJib7tgX224fc9aibTiceztGs1wzPLcbUlCwu6eem552CFn1wvA/640?wx_fmt=png&from=appmsg "")  
  
**解决方案：**  
- 模型提供了 **10 种不同类型且带复杂绕过的攻击 Payload**  
  
- 给出了 3 个待选择的建议 Payload，并提供了使用的先后顺序  
  
![绕过方案](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKw8eFhTtQvUkE4CWib6319v5ic1aXbYrhM2u52uich19ZHdCvQDGichnfXQ/640?wx_fmt=png&from=appmsg "")  
  
**持续优化：**  
- 继续报错后，模型提供了 **7 种新的绕过方法**  
  
![新绕过方法](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKwoJa4WwabONic0kCWtAagnCGt06dPrlGpy28JnSCUiaO6RlfYb1NUKow/640?wx_fmt=png&from=appmsg "")  
- 再次报错后，模型提供了 **10 个基础绕过方法的攻击 Payload**  
  
![基础绕过方法](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKEQddia2rb00bNEh8J8ZheOA4kygpcf5ibicYLaiaa9MGtqCJUXXrnHnPCA/640?wx_fmt=png&from=appmsg "")  
#### 3.4 成功利用  
#### 经过 20+ 次反复报错确认 后，最终发现了可以成功执行的攻击 Payload：  
  
![成功执行](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKWhLa4jdXxNJalLRaSOBK6pksHGE6Kxm7j1K0JWmZQxsvf1EbR4qSHA/640?wx_fmt=png&from=appmsg "")  
 ![执行结果](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKxSZy4Q7ZbCI0P9FkaWeZvJT0nWzt073ZCjwJy1hibeKVDv6BSNNRCfw/640?wx_fmt=png&from=appmsg "")  
 ![详细输出](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEK82ZdJMl0yTOialLoRWnPp7N7iarZsofED4aqL6LHf78ticENg2CC984Fw/640?wx_fmt=png&from=appmsg "")  
  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgJHGxRSfVlI02pBf15B0slPyoWRWfSP0mM3LqDQKhOhVwfvVKma68JRwQ7E2Oysib3Nsw5ny7uaSw/640?wx_fmt=gif "")  
  
**漏洞总结与修复建议**  
  
模型在成功利用后，自动给出了简要的总结和修复方法：  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgJHGxRSfVlI02pBf15B0slPyoWRWfSP0mM3LqDQKhOhVwfvVKma68JRwQ7E2Oysib3Nsw5ny7uaSw/640?wx_fmt=gif "")  
  
**本地复现**  
  
本地环境成功复现漏洞利用：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WAyrRuvrubGT4Y74y3zAzJPGW5ibNaaEKnQJ76vgpBDZyEsZPzcBnQCanwRZhVt2EPlAlBbiay1tXr43hrk9Rjag/640?wx_fmt=png&from=appmsg "")  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgJHGxRSfVlI02pBf15B0slPyoWRWfSP0mM3LqDQKhOhVwfvVKma68JRwQ7E2Oysib3Nsw5ny7uaSw/640?wx_fmt=gif "")  
  
**项目亮点**  
  
  
1. **多轮交互验证**  
：通过多轮 Prompt 交互，逐步提高漏洞识别的准确性  
  
1. **智能 Payload 生成**  
：根据环境特点自动生成针对性的攻击 Payload  
  
1. **错误自适应**  
：能够根据报错信息自动调整和优化 Payload  
  
1. **实战验证**  
：所有漏洞均经过实际环境验证，确保可复现  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaHpokNh4uWxia9Vv2eYjfzjK9Euejia8GQQAicPWkJI7HfpDplIlc3tPr73ZYKHIdg9kIHpWaJia2tGA/640?wx_fmt=gif "")  
  
**点分享**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaHpokNh4uWxia9Vv2eYjfzjXjW9bUCoUia7g4iaVGGGm5AKWRMoDMQoFDdJuiceofhPJ8SJpKSGToZcw/640?wx_fmt=gif "")  
  
**点收藏**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaHpokNh4uWxia9Vv2eYjfzjAEe2Bq3UgWlgxribzfYtnQ6EVkxkao5qmK0xpaoycfHyGVl7zFicPGibw/640?wx_fmt=gif "")  
  
**点在看**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWiaHpokNh4uWxia9Vv2eYjfzjDia9eCL6sIvuL17F5uKHsjx0GNc6estct1jOfWh4EtOcVsvzynOar1Q/640?wx_fmt=gif "")  
  
**点点赞**  
  
