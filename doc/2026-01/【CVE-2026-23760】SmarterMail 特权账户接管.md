#  【CVE-2026-23760】SmarterMail 特权账户接管  
原创 骨哥说事
                    骨哥说事  骨哥说事   2026-01-26 02:42  
  
<table><tbody><tr><td data-colwidth="557" width="557" valign="top" style="word-break: break-all;"><h1 data-selectable-paragraph="" style="white-space: normal;outline: 0px;max-width: 100%;font-family: -apple-system, system-ui, &#34;Helvetica Neue&#34;, &#34;PingFang SC&#34;, &#34;Hiragino Sans GB&#34;, &#34;Microsoft YaHei UI&#34;, &#34;Microsoft YaHei&#34;, Arial, sans-serif;letter-spacing: 0.544px;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;"><strong style="outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="outline: 0px;max-width: 100%;font-size: 18px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="color: rgb(255, 0, 0);"><strong><span style="font-size: 15px;"><span leaf="">声明：</span></span></strong></span><span style="font-size: 15px;"></span></span></strong><span style="outline: 0px;max-width: 100%;font-size: 18px;box-sizing: border-box !important;overflow-wrap: break-word !important;"><span style="font-size: 15px;"><span leaf="">文章中涉及的程序(方法)可能带有攻击性，仅供安全研究与教学之用，读者将其信息做其他用途，由用户承担全部法律及连带责任，文章作者不承担任何法律及连带责任。</span></span></span></h1></td></tr></tbody></table>#   
  
#   
  
****# 防走失：https://gugesay.com/archives/5218  
  
******不想错过任何消息？设置星标****↓ ↓ ↓**  
****  
#   
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/hZj512NN8jlbXyV4tJfwXpicwdZ2gTB6XtwoqRvbaCy3UgU1Upgn094oibelRBGyMs5GgicFKNkW1f62QPCwGwKxA/640?wx_fmt=png&from=appmsg "")  
  
## 摘要  
  
SmarterMail 是一款由 SmarterTools 提供的邮件和协作服务器，在企业内部通信中广泛使用。近日发现的 **CVE-2026-23760**  
 是一个**认证绕过漏洞**  
，存在于 SmarterMail 的密码重置 **API 接口**  
 中，强烈建议 SmarterMail 用户立即升级至 2026年1月15日发布的最新版本 Build 9511。  
  
需要注意的是，这与目前正在大规模利用的 CVE-2025-52691 是**分开的独立事件**  
。CVE-2025-52691 是 SmarterMail 中一个同样会导致远程代码执行的任意文件上传漏洞。  
## 威胁深入分析  
  
一旦漏洞被利用，威胁行为者就会利用被劫持的特权账户访问 SmarterMail 的“系统事件”功能，并在其中创建恶意的系统事件，以在受感染的主机上执行侦察命令。  
  
对被攻击主机的相关应用日志审查显示，攻击者为达成其目标，向 SmarterMail 应用程序发起了一系列 HTTP POST 请求。  
  
**表 1**  
（如下）展示了按观测顺序排列的请求，并附有相应说明，详细介绍了它们在攻击中的用途。  
<table><tbody><tr style="border: 0;border-top: 1px solid #ccc;background-color: white;"><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><strong style="font-weight: bold;color: black;"><span leaf="">请求</span></strong></p></td><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><strong style="font-weight: bold;color: black;"><span leaf="">目的</span></strong></p></td></tr><tr style="border: 0;border-top: 1px solid #ccc;background-color: #F8F8F8;"><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">POST /api/v1/auth/force-reset-password</span></p></td><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">利用账户接管漏洞获取特权用户账户的访问权限。</span></p></td></tr><tr style="border: 0;border-top: 1px solid #ccc;background-color: white;"><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">POST /api/v1/auth/authenticate-user </span></p><section><span leaf=""><br/></span></section></td><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">使用特权用户的凭据获取有效的访问令牌。</span></p></td></tr><tr style="border: 0;border-top: 1px solid #ccc;background-color: #F8F8F8;"><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">POST /api/v1/settings/sysadmin/event-hook </span></p><section><span leaf=""><br/></span></section></td><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">配置恶意系统事件。</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">推测该系统事件被配置为，当有新的域名添加到 SmarterMail 应用时，执行威胁行为者的侦察命令。</span></p></td></tr><tr style="border: 0;border-top: 1px solid #ccc;background-color: white;"><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">POST /api/v1/settings/sysadmin/domain-put </span></p><section><span leaf=""><br/></span></section></td><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">向 SmarterMail 添加新域名，从而触发上一步创建的系统事件。</span></p></td></tr><tr style="border: 0;border-top: 1px solid #ccc;background-color: #F8F8F8;"><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">POST /api/v1/settings/sysadmin/domain-delete/google.abc[.]com/true</span><span leaf=""> </span></p><section><span leaf=""><br/></span></section></td><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">作为痕迹清除活动的一部分，进行清理操作。（删除了新添加的域名）</span></p></td></tr><tr style="border: 0;border-top: 1px solid #ccc;background-color: white;"><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">POST /api/v1/settings/sysadmin/event-hook-delete</span></p></td><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">作为痕迹清除活动的一部分，进行清理操作。（删除了创建的恶意系统事件钩子）</span></p></td></tr></tbody></table>  
*表 1：观测到的 HTTP 请求摘要  
  
这些请求在多个客户环境中快速连续发出，表明这是大规模自动化扫描和利用。  
## 漏洞分析  
  
通过对比 1 月 8 日发布的版本 9504 和 1 月 15 日发布的版本 9511，可以清楚地看到导致漏洞的根本原因：在旧版本中，向 /api/v1/auth/force-reset-password  
 端点提交请求时，程序**未验证所提交的旧密码是否有效**  
。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/hZj512NN8jm2KyFRs3ZBaNAKupaStqRSa4MpIqZmSM1BxVic0O0QINTL8VA7NqatCD8nyHIVbHuSms0Nr3SIelw/640?wx_fmt=png&from=appmsg "")  
  
图 1：SmarterMail 二进制版本 9504 与 9511 的对比  
## 结论  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/hZj512NN8jm2KyFRs3ZBaNAKupaStqRSM19ztEyraNq3J9j7te9BkJiac5wOmYRTnvz44FVOWcsWObM6TZErseQ/640?wx_fmt=png&from=appmsg "")  
  
  
鉴于该漏洞的严重性、当前活跃的在野利用情况以及已观测到的 CVE-2025-52691 漏洞利用，企业应优先部署 SmarterMail 更新，并审查所有旧版本系统是否已出现被感染的迹象。  
## 入侵指标  
<table><tbody><tr style="border: 0;border-top: 1px solid #ccc;background-color: white;"><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><strong style="font-weight: bold;color: black;"><span leaf="">项目</span></strong></p></td><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><strong style="font-weight: bold;color: black;"><span leaf="">详情</span></strong></p></td></tr><tr style="border: 0;border-top: 1px solid #ccc;background-color: #F8F8F8;"><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]57</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]229</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">155.2.215[.]66</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]54</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]53</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]222</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]159</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]165</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">155.2.215[.]70</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]49</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">155.2.215[.]74</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]160</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">155.2.215[.]73</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]51</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">155.2.215[.]60</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]151</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]46</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">155.2.215[.]68</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]155</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]45</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">155.2.215[.]72</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">155.2.215[.]67</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]47</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]59</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]56</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]154</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">142.111.152[.]150</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">155.2.215[.]62</span></p></td><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">观测到发起攻击的源 IP 地址。</span></p></td></tr><tr style="border: 0;border-top: 1px solid #ccc;background-color: white;"><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">python-requests/2.32.4</span></p></td><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">观测到执行攻击时使用的用户代理。注意：这是 Python `requests` 模块 2.32.4 版本的默认用户代理。</span></p></td></tr><tr style="border: 0;border-top: 1px solid #ccc;background-color: #F8F8F8;"><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">C:\Program Files (x86)\SmarterTools\SmarterMail\Service\wwwroot\result.txt</span></p></td><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">包含侦察命令输出结果的文件。</span></p></td></tr><tr style="border: 0;border-top: 1px solid #ccc;background-color: white;"><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">/api/v1/auth/force-reset-password</span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">/api/v1/auth/authenticate-user </span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">/api/v1/settings/sysadmin/event-hook </span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">/api/v1/settings/sysadmin/domain-put </span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">/api/v1/settings/sysadmin/domain-delete/google.abc.com/true </span></p><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">/api/v1/settings/sysadmin/event-hook-delete</span></p></td><td style="border: 1px solid #ccc;padding: 5px 10px;text-align: left;font-size: 14px;min-width: 85px;"><p dir="ltr" style="padding-top: 8px;padding-bottom: 8px;margin: 0;line-height: 26px;color: black;font-size: 14px;"><span leaf="">在攻击中观测到向这些端点发起的 POST 请求。</span></p></td></tr></tbody></table>  
原文：https://www.huntress.com/blog/smartermail-account-takeover-leading-to-rce  
  
- END -  
  
**感谢阅读，如果觉得还不错的话，动动手指一键三连～**  
  
