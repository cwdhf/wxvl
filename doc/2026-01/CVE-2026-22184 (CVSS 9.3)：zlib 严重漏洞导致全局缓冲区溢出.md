#  CVE-2026-22184 (CVSS 9.3)：zlib 严重漏洞导致全局缓冲区溢出  
 安全圈的那点事儿   2026-01-12 11:15  
  
zlib（一种几乎被所有计算机硬件和操作系统使用的无损数据压缩引擎）中发现了一个严重漏洞。该漏洞编号为 CVE-2026-22184，是一个全局缓冲区溢出漏洞，其 CVSS 评分为 9.3，对依赖该库的 untgz 工具的系统构成重大威胁。  
  
该漏洞源于实用程序代码中内存管理的一个根本性错误。攻击者只需提供一个过长的归档名称，即可触发内存损坏级联反应，这可能导致系统崩溃，最坏情况下甚至会导致远程代码执行。  
  
问题的核心在于 TGZfname() 函数。根据披露的信息，该函数负责处理通过命令行传递的归档名称。然而，它犯了一个致命的错误：它“使用无限制的 strcpy() 调用，将攻击者提供的归档名称从 argv[] 复制到一个固定大小为 1024 字节的静态全局缓冲区中”。  
  
该代码在复制输入之前未能验证其长度。这意味着，如果攻击者提供的归档名称长度超过 1024 字节，数据就会溢出缓冲区边缘。  
  
报告解释说：“提供的归档名称长度超过 1024 字节会导致超出全局缓冲区末尾的越界写入，从而导致内存损坏。”  
  
这个漏洞之所以特别危险，是因为它极易被利用。该缺陷位于程序的最前端。“在任何归档解析或验证之前，攻击者就能执行到存在漏洞的代码，这意味着仅通过命令行输入即可轻松利用该缺陷。”  
  
攻击者无需精心构造复杂的恶意文件结构；他们只需使用“足够长的文件名参数”调用该实用程序即可。  
  
由于溢出影响的是全局静态数组而非栈分配数组，因此这种破坏可能非常隐蔽。“破坏可能会持续到函数作用域之外，并影响后续的程序行为”，从而导致未定义行为或程序崩溃。  
  
潜在的后果从拒绝服务 (DoS) 到潜在的代码执行不等，具体取决于特定环境的编译器、架构和内存布局。  
  
该漏洞影响 zlib 版本 1.3.1.2 及更早版本。强烈建议使用 untgz 工具的管理员和开发人员评估其面临的风险，并寻找已修补的版本来降低这一严重风险。  
  
![zlib 漏洞 CVE-2026-22184](https://mmbiz.qpic.cn/sz_mmbiz_png/pcgSUGCDdKLia5736RicxEr9l2NpK3QAb8NVENEia27AUx0g3Lu30C1tR526Md2Z4N4pibXs7EyvVPzoiarQpaq85Rw/640?wx_fmt=png&from=appmsg "")  
  
